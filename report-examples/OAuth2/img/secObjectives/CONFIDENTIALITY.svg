<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="2115pt" height="7292pt"
 viewBox="0.00 0.00 2115.07 7292.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 7288)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-7288 2111.07,-7288 2111.07,4 -4,4"/>
<!-- CONFIDENTIALITY -->
<g id="node1" class="node">
<title>CONFIDENTIALITY</title>
<ellipse fill="#bae9ff" stroke="#2bbcff" cx="292.04" cy="-3125" rx="292.07" ry="25.41"/>
<text text-anchor="start" x="232.04" y="-3128.4" font-family="Arial" font-weight="bold" font-size="12.00">CONFIDENTIALITY</text>
<text text-anchor="start" x="96.04" y="-3116.4" font-family="Arial" font-size="12.00">Ability to maintain fundamental confidentiality of the system data</text>
</g>
<!-- Client_Secrets_disclosure -->
<g id="node2" class="node">
<title>Client_Secrets_disclosure</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1191.07,-7027.5 696.07,-7027.5 696.07,-6946.5 1191.07,-6946.5 1191.07,-7027.5"/>
<text text-anchor="start" x="828.57" y="-7012.4" font-family="Arial" font-weight="bold" font-size="12.00">Client_Secrets_disclosure ATTACK</text>
<text text-anchor="start" x="1055.57" y="-7012.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="721.57" y="-6994.4" font-family="Arial" font-size="12.00">Obtain Secret From Source Code or Binary: This applies for all client types.</text>
<text text-anchor="start" x="706.57" y="-6981.4" font-family="Arial" font-size="12.00">For open source projects, secrets can be extracted directly from source code in</text>
<text text-anchor="start" x="717.07" y="-6968.4" font-family="Arial" font-size="12.00">their public repositories. &#160;Secrets can be extracted from application binaries</text>
<text text-anchor="start" x="727.57" y="-6955.4" font-family="Arial" font-size="12.00">just as easily when the published source is not available to the attack[...]</text>
</g>
<!-- Client_Secrets_disclosure&#45;&gt;CONFIDENTIALITY -->
<g id="edge6" class="edge">
<title>Client_Secrets_disclosure&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M899.44,-6946.47C823.86,-6872.44 669.15,-6706.78 602.07,-6532 348.13,-5870.32 299.08,-3481.19 293.6,-3160.65"/>
<polygon fill="black" stroke="black" points="297.1,-3160.48 293.43,-3150.54 290.1,-3160.59 297.1,-3160.48"/>
<text text-anchor="middle" x="632.57" y="-6646.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- Client_Secrets_disclosure_countermeasure0 -->
<g id="node3" class="node">
<title>Client_Secrets_disclosure_countermeasure0</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="1926.57,-7284 1495.57,-7284 1495.57,-7224 1926.57,-7224 1926.57,-7284"/>
<text text-anchor="start" x="1506.07" y="-7269.4" font-family="Arial" font-weight="bold" font-size="12.00"> Checks on client&#39;s security policy (5_2_3_1_CLIENT_CHECK1) </text>
<text text-anchor="start" x="1519.57" y="-7245.4" font-family="Arial" font-size="12.00"> Don&#39;t issue secrets to public clients or clients with inappropriate</text>
<text text-anchor="start" x="1666.57" y="-7233.4" font-family="Arial" font-size="12.00">security policy </text>
</g>
<!-- Client_Secrets_disclosure_countermeasure0&#45;&gt;Client_Secrets_disclosure -->
<g id="edge1" class="edge">
<title>Client_Secrets_disclosure_countermeasure0&#45;&gt;Client_Secrets_disclosure</title>
<path fill="none" stroke="black" d="M1495.46,-7250.51C1435.88,-7244.81 1371.96,-7234.17 1315.07,-7215 1194.2,-7174.27 1071.56,-7088.05 1002.09,-7034.09"/>
<polygon fill="black" stroke="black" points="1003.92,-7031.07 993.89,-7027.67 999.61,-7036.59 1003.92,-7031.07"/>
<text text-anchor="middle" x="1260.57" y="-7210.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- Client_Secrets_disclosure_countermeasure1 -->
<g id="node4" class="node">
<title>Client_Secrets_disclosure_countermeasure1</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="2005.07,-7206 1417.07,-7206 1417.07,-7110 2005.07,-7110 2005.07,-7206"/>
<text text-anchor="start" x="1427.07" y="-7191.4" font-family="Arial" font-weight="bold" font-size="12.00"> Require User Consent for Public Clients without Secret (5_2_3_2_USER_CONSENT1) </text>
<text text-anchor="start" x="1491.57" y="-7167.4" font-family="Arial" font-size="12.00"> Authorization servers should not allow automatic authorization for public</text>
<text text-anchor="start" x="1483.07" y="-7155.4" font-family="Arial" font-size="12.00">clients. &#160;The authorization server may issue an individual client id but should</text>
<text text-anchor="start" x="1497.07" y="-7143.4" font-family="Arial" font-size="12.00">require that all authorizations are approved by the end user. &#160;For clients</text>
<text text-anchor="start" x="1494.57" y="-7131.4" font-family="Arial" font-size="12.00">without secrets, this is a countermeasure against the following threat: &#160;&#160;&#45;</text>
<text text-anchor="start" x="1691.07" y="-7119.4" font-family="Arial" font-size="12.00">Im[...] </text>
</g>
<!-- Client_Secrets_disclosure_countermeasure1&#45;&gt;Client_Secrets_disclosure -->
<g id="edge2" class="edge">
<title>Client_Secrets_disclosure_countermeasure1&#45;&gt;Client_Secrets_disclosure</title>
<path fill="none" stroke="black" d="M1416.85,-7120.87C1382.4,-7114.98 1347.86,-7108.36 1315.07,-7101 1232.29,-7082.41 1141.19,-7054.48 1070.04,-7030.92"/>
<polygon fill="black" stroke="black" points="1070.73,-7027.46 1060.13,-7027.63 1068.52,-7034.11 1070.73,-7027.46"/>
<text text-anchor="middle" x="1260.57" y="-7099.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- Client_Secrets_disclosure_countermeasure2 -->
<g id="node5" class="node">
<title>Client_Secrets_disclosure_countermeasure2</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="2052.57,-7092 1369.57,-7092 1369.57,-6996 2052.57,-6996 2052.57,-7092"/>
<text text-anchor="start" x="1380.07" y="-7077.4" font-family="Arial" font-weight="bold" font-size="12.00"> Issue a &quot;client_id&quot; Only in Combination with &quot;redirect_uri&quot; (5_2_3_3_CLIENT_ID_TO_REDIRECT_URI) </text>
<text text-anchor="start" x="1527.57" y="-7053.4" font-family="Arial" font-size="12.00"> The authorization server may issue a &quot;client_id&quot; and bind the</text>
<text text-anchor="start" x="1541.57" y="-7041.4" font-family="Arial" font-size="12.00">&quot;client_id&quot; to a certain pre&#45;configured &quot;redirect_uri&quot;. &#160;Any</text>
<text text-anchor="start" x="1492.57" y="-7029.4" font-family="Arial" font-size="12.00">authorization request with another redirect URI is refused &#160;&#160;automatically.</text>
<text text-anchor="start" x="1474.57" y="-7017.4" font-family="Arial" font-size="12.00">Alternatively, the authorization server should not &#160;&#160;accept any dynamic redirect</text>
<text text-anchor="start" x="1633.07" y="-7005.4" font-family="Arial" font-size="12.00">URI for such a &quot;client_[...] </text>
</g>
<!-- Client_Secrets_disclosure_countermeasure2&#45;&gt;Client_Secrets_disclosure -->
<g id="edge3" class="edge">
<title>Client_Secrets_disclosure_countermeasure2&#45;&gt;Client_Secrets_disclosure</title>
<path fill="none" stroke="black" d="M1369.3,-7018.63C1312.86,-7014.42 1255.19,-7010.13 1201.27,-7006.11"/>
<polygon fill="black" stroke="black" points="1201.48,-7002.62 1191.25,-7005.37 1200.96,-7009.6 1201.48,-7002.62"/>
<text text-anchor="middle" x="1260.57" y="-7015.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- Client_Secrets_disclosure_countermeasure3 -->
<g id="node6" class="node">
<title>Client_Secrets_disclosure_countermeasure3</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="1989.57,-6978 1432.57,-6978 1432.57,-6882 1989.57,-6882 1989.57,-6978"/>
<text text-anchor="start" x="1443.07" y="-6963.4" font-family="Arial" font-weight="bold" font-size="12.00"> Issue Installation&#45;Specific Client Secrets (5_2_3_4_SPECIFIC_CLIENT_SECRETS) </text>
<text text-anchor="start" x="1472.07" y="-6939.4" font-family="Arial" font-size="12.00"> An authorization server may issue separate client identifiers and corresponding</text>
<text text-anchor="start" x="1501.57" y="-6927.4" font-family="Arial" font-size="12.00">secrets to the different installations of a particular client (i.e., software</text>
<text text-anchor="start" x="1502.57" y="-6915.4" font-family="Arial" font-size="12.00">package). &#160;The effect of such an approach would be to turn otherwise</text>
<text text-anchor="start" x="1547.57" y="-6903.4" font-family="Arial" font-size="12.00">&quot;public&quot; clients back into &quot;confidential&quot; clients. For web</text>
<text text-anchor="start" x="1640.57" y="-6891.4" font-family="Arial" font-size="12.00">applications, this co[...] </text>
</g>
<!-- Client_Secrets_disclosure_countermeasure3&#45;&gt;Client_Secrets_disclosure -->
<g id="edge4" class="edge">
<title>Client_Secrets_disclosure_countermeasure3&#45;&gt;Client_Secrets_disclosure</title>
<path fill="none" stroke="black" d="M1432.35,-6950.68C1356.97,-6956.29 1275.7,-6962.34 1201.52,-6967.87"/>
<polygon fill="black" stroke="black" points="1200.82,-6964.41 1191.11,-6968.64 1201.34,-6971.39 1200.82,-6964.41"/>
<text text-anchor="middle" x="1260.57" y="-6968.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- Client_Secrets_disclosure_countermeasure4 -->
<g id="node7" class="node">
<title>Client_Secrets_disclosure_countermeasure4</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1972.07,-6864 1450.07,-6864 1450.07,-6768 1972.07,-6768 1972.07,-6864"/>
<text text-anchor="start" x="1460.07" y="-6849.4" font-family="Arial" font-weight="bold" font-size="12.00"> Validate Pre&#45;Registered &quot;redirect_uri&quot; (5_2_3_5_VALIDATE_REDIRECT_URI) </text>
<text text-anchor="start" x="1516.57" y="-6825.4" font-family="Arial" font-size="12.00"> An authorization server should require all clients to register their</text>
<text text-anchor="start" x="1551.07" y="-6813.4" font-family="Arial" font-size="12.00">&quot;redirect_uri&quot;, and the &quot;redirect_uri&quot; should be the full</text>
<text text-anchor="start" x="1476.07" y="-6801.4" font-family="Arial" font-size="12.00">URI as defined in [RFC6749]. &#160;The way that this registration is performed is out</text>
<text text-anchor="start" x="1473.07" y="-6789.4" font-family="Arial" font-size="12.00">of scope of this document. &#160;As per the core spec, every actual redirect URI sent</text>
<text text-anchor="start" x="1642.07" y="-6777.4" font-family="Arial" font-size="12.00">with the respective[...] </text>
</g>
<!-- Client_Secrets_disclosure_countermeasure4&#45;&gt;Client_Secrets_disclosure -->
<g id="edge5" class="edge">
<title>Client_Secrets_disclosure_countermeasure4&#45;&gt;Client_Secrets_disclosure</title>
<path fill="none" stroke="black" d="M1450.06,-6847.66C1404.84,-6854.83 1358.42,-6863.26 1315.07,-6873 1232.29,-6891.59 1141.19,-6919.52 1070.04,-6943.08"/>
<polygon fill="black" stroke="black" points="1068.52,-6939.89 1060.13,-6946.37 1070.73,-6946.54 1068.52,-6939.89"/>
<text text-anchor="middle" x="1260.57" y="-6896.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- TOO_MUCH_GRANT -->
<g id="node8" class="node">
<title>TOO_MUCH_GRANT</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1206.07,-6619 681.07,-6619 681.07,-6551 1206.07,-6551 1206.07,-6619"/>
<text text-anchor="start" x="850.07" y="-6604.4" font-family="Arial" font-weight="bold" font-size="12.00">TOO_MUCH_GRANT ATTACK</text>
<text text-anchor="start" x="1034.07" y="-6604.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="691.57" y="-6586.4" font-family="Arial" font-size="12.00">When obtaining end&#45;user authorization, the end user may not understand the scope</text>
<text text-anchor="start" x="703.57" y="-6573.4" font-family="Arial" font-size="12.00">of the access being granted and to whom, or they may end up providing a client</text>
<text text-anchor="start" x="781.57" y="-6560.4" font-family="Arial" font-size="12.00">with access to resources that should not be permitted.</text>
</g>
<!-- TOO_MUCH_GRANT&#45;&gt;CONFIDENTIALITY -->
<g id="edge9" class="edge">
<title>TOO_MUCH_GRANT&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M735.28,-6550.89C684.41,-6532.67 635.14,-6504.76 602.07,-6462 388.89,-6186.33 304.06,-3503.91 294.05,-3161.01"/>
<polygon fill="black" stroke="black" points="297.55,-3160.78 293.76,-3150.89 290.55,-3160.99 297.55,-3160.78"/>
<text text-anchor="middle" x="632.57" y="-6516.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- TOO_MUCH_GRANT&#45;&gt;CONFIDENTIALITY -->
<g id="edge15" class="edge">
<title>TOO_MUCH_GRANT&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M833.91,-6550.99C781.62,-6529.81 721.62,-6497.73 681.07,-6452 613.25,-6375.52 624.86,-6335.65 602.07,-6236 318.32,-4995.22 295.1,-3417.11 293.2,-3160.87"/>
<polygon fill="black" stroke="black" points="296.7,-3160.62 293.13,-3150.65 289.7,-3160.67 296.7,-3160.62"/>
<text text-anchor="middle" x="632.57" y="-6433.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- TOO_MUCH_GRANT_countermeasure0 -->
<g id="node9" class="node">
<title>TOO_MUCH_GRANT_countermeasure0</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="2026.07,-6750 1396.07,-6750 1396.07,-6654 2026.07,-6654 2026.07,-6750"/>
<text text-anchor="start" x="1406.07" y="-6735.4" font-family="Arial" font-weight="bold" font-size="12.00"> AUTHORIZATION_SERVER policy discretional decision (AUTH_SERVER_RE_CHECK_GRANTS) </text>
<text text-anchor="start" x="1473.57" y="-6711.4" font-family="Arial" font-size="12.00"> Narrow the scope, based on the client. &#160;When obtaining end&#45;user authorization</text>
<text text-anchor="start" x="1487.57" y="-6699.4" font-family="Arial" font-size="12.00">and where the client requests scope, the authorization server may want to</text>
<text text-anchor="start" x="1492.07" y="-6687.4" font-family="Arial" font-size="12.00">consider whether to honor that scope based on the client identifier. &#160;That</text>
<text text-anchor="start" x="1473.07" y="-6675.4" font-family="Arial" font-size="12.00">decision is between the client and authorization server and is outside the scope</text>
<text text-anchor="start" x="1698.57" y="-6663.4" font-family="Arial" font-size="12.00">[...] </text>
</g>
<!-- TOO_MUCH_GRANT_countermeasure0&#45;&gt;TOO_MUCH_GRANT -->
<g id="edge7" class="edge">
<title>TOO_MUCH_GRANT_countermeasure0&#45;&gt;TOO_MUCH_GRANT</title>
<path fill="none" stroke="black" d="M1395.94,-6695.47C1338.46,-6691 1279.23,-6684.2 1224.07,-6674 1162.08,-6662.53 1094.68,-6641.34 1041.61,-6622.52"/>
<polygon fill="black" stroke="black" points="1042.46,-6619.11 1031.87,-6619.03 1040.1,-6625.7 1042.46,-6619.11"/>
<text text-anchor="middle" x="1260.57" y="-6687.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- TOO_MUCH_GRANT_countermeasure0&#45;&gt;TOO_MUCH_GRANT -->
<g id="edge13" class="edge">
<title>TOO_MUCH_GRANT_countermeasure0&#45;&gt;TOO_MUCH_GRANT</title>
<path fill="none" stroke="black" d="M1396.02,-6657.18C1368.63,-6653.12 1341.35,-6649.02 1315.07,-6645 1265.1,-6637.35 1211.39,-6628.83 1160.8,-6620.66"/>
<polygon fill="black" stroke="black" points="1161.16,-6617.17 1150.73,-6619.03 1160.04,-6624.08 1161.16,-6617.17"/>
<text text-anchor="middle" x="1260.57" y="-6644.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- TOO_MUCH_GRANT_countermeasure1 -->
<g id="node10" class="node">
<title>TOO_MUCH_GRANT_countermeasure1</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="1961.57,-6636 1460.57,-6636 1460.57,-6564 1961.57,-6564 1961.57,-6636"/>
<text text-anchor="start" x="1474.57" y="-6621.4" font-family="Arial" font-weight="bold" font-size="12.00"> Users educated to avoid phishing attacks (USER_AUTH_AWARENESS) </text>
<text text-anchor="start" x="1471.07" y="-6597.4" font-family="Arial" font-size="12.00"> Authorization servers should attempt to educate users about the risks posed by</text>
<text text-anchor="start" x="1474.07" y="-6585.4" font-family="Arial" font-size="12.00">phishing attacks and should provide mechanisms that make it easy for users to</text>
<text text-anchor="start" x="1552.07" y="-6573.4" font-family="Arial" font-size="12.00">confirm the authenticity of their sites. Section 5.1.2). </text>
</g>
<!-- TOO_MUCH_GRANT_countermeasure1&#45;&gt;TOO_MUCH_GRANT -->
<g id="edge8" class="edge">
<title>TOO_MUCH_GRANT_countermeasure1&#45;&gt;TOO_MUCH_GRANT</title>
<path fill="none" stroke="black" d="M1460.48,-6595.11C1382.44,-6593.58 1295.97,-6591.89 1216.48,-6590.33"/>
<polygon fill="black" stroke="black" points="1216.39,-6586.83 1206.33,-6590.13 1216.25,-6593.82 1216.39,-6586.83"/>
<text text-anchor="middle" x="1260.57" y="-6594.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- TOO_MUCH_GRANT_countermeasure1&#45;&gt;TOO_MUCH_GRANT -->
<g id="edge14" class="edge">
<title>TOO_MUCH_GRANT_countermeasure1&#45;&gt;TOO_MUCH_GRANT</title>
<path fill="none" stroke="black" d="M1460.47,-6576.99C1384.6,-6572.18 1300.96,-6569.08 1224.07,-6571 1221.61,-6571.06 1219.14,-6571.13 1216.66,-6571.19"/>
<polygon fill="black" stroke="black" points="1216.3,-6567.7 1206.4,-6571.49 1216.5,-6574.7 1216.3,-6567.7"/>
<text text-anchor="middle" x="1260.57" y="-6574.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- AuthServerPhishing1 -->
<g id="node11" class="node">
<title>AuthServerPhishing1</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1197.07,-6443 690.07,-6443 690.07,-6349 1197.07,-6349 1197.07,-6443"/>
<text text-anchor="start" x="843.07" y="-6428.4" font-family="Arial" font-weight="bold" font-size="12.00">AuthServerPhishing1 ATTACK</text>
<text text-anchor="start" x="1041.07" y="-6428.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="733.07" y="-6410.4" font-family="Arial" font-size="12.00">A hostile party could take advantage of this by intercepting the client&#39;s</text>
<text text-anchor="start" x="707.07" y="-6397.4" font-family="Arial" font-size="12.00">requests and returning misleading or otherwise incorrect responses. &#160;This could</text>
<text text-anchor="start" x="717.07" y="-6384.4" font-family="Arial" font-size="12.00">be achieved using DNS or Address Resolution Protocol (ARP) spoofing. &#160;Wide</text>
<text text-anchor="start" x="700.57" y="-6371.4" font-family="Arial" font-size="12.00">deployment of OAuth and similar protocols may cause users to become inured to</text>
<text text-anchor="start" x="931.57" y="-6358.4" font-family="Arial" font-size="12.00">t[...]</text>
</g>
<!-- AuthServerPhishing1&#45;&gt;CONFIDENTIALITY -->
<g id="edge12" class="edge">
<title>AuthServerPhishing1&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M827.55,-6348.99C777.05,-6323.58 720.44,-6287.88 681.07,-6242 619.38,-6170.09 624.83,-6135.97 602.07,-6044 315.78,-4886.94 294.66,-3407.48 293.15,-3160.64"/>
<polygon fill="black" stroke="black" points="296.65,-3160.44 293.09,-3150.46 289.65,-3160.48 296.65,-3160.44"/>
<text text-anchor="middle" x="632.57" y="-6220.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- AuthServerPhishing1_countermeasure0 -->
<g id="node12" class="node">
<title>AuthServerPhishing1_countermeasure0</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="1973.57,-6546 1448.57,-6546 1448.57,-6450 1973.57,-6450 1973.57,-6546"/>
<text text-anchor="start" x="1459.07" y="-6531.4" font-family="Arial" font-weight="bold" font-size="12.00"> TLS for the authorization server (5_1_2_AUTH_SERVER_AUTHENTICATION) </text>
<text text-anchor="start" x="1478.57" y="-6507.4" font-family="Arial" font-size="12.00"> Authorization servers should consider such attacks when developing services</text>
<text text-anchor="start" x="1477.07" y="-6495.4" font-family="Arial" font-size="12.00">based on OAuth and should require the use of transport&#45; layer security for any</text>
<text text-anchor="start" x="1494.57" y="-6483.4" font-family="Arial" font-size="12.00">requests where the authenticity of the authorization server or of request</text>
<text text-anchor="start" x="1493.57" y="-6471.4" font-family="Arial" font-size="12.00">responses is an issue (see Section 5.1.2). HTTPS server authentication or</text>
<text text-anchor="start" x="1687.07" y="-6459.4" font-family="Arial" font-size="12.00">simi[...] </text>
</g>
<!-- AuthServerPhishing1_countermeasure0&#45;&gt;AuthServerPhishing1 -->
<g id="edge10" class="edge">
<title>AuthServerPhishing1_countermeasure0&#45;&gt;AuthServerPhishing1</title>
<path fill="none" stroke="black" d="M1448.5,-6463.15C1370.53,-6452.76 1285.08,-6441.37 1207.05,-6430.98"/>
<polygon fill="black" stroke="black" points="1207.46,-6427.5 1197.08,-6429.65 1206.53,-6434.44 1207.46,-6427.5"/>
<text text-anchor="middle" x="1260.57" y="-6443.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- AuthServerPhishing1_countermeasure1 -->
<g id="node13" class="node">
<title>AuthServerPhishing1_countermeasure1</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="1972.57,-6432 1449.57,-6432 1449.57,-6360 1972.57,-6360 1972.57,-6432"/>
<text text-anchor="start" x="1460.07" y="-6417.4" font-family="Arial" font-weight="bold" font-size="12.00"> Users educated to avoid phishing attacks (USER_PHISHING_AWARENESS) </text>
<text text-anchor="start" x="1471.07" y="-6393.4" font-family="Arial" font-size="12.00"> Authorization servers should attempt to educate users about the risks posed by</text>
<text text-anchor="start" x="1474.07" y="-6381.4" font-family="Arial" font-size="12.00">phishing attacks and should provide mechanisms that make it easy for users to</text>
<text text-anchor="start" x="1552.07" y="-6369.4" font-family="Arial" font-size="12.00">confirm the authenticity of their sites. Section 5.1.2). </text>
</g>
<!-- AuthServerPhishing1_countermeasure1&#45;&gt;AuthServerPhishing1 -->
<g id="edge11" class="edge">
<title>AuthServerPhishing1_countermeasure1&#45;&gt;AuthServerPhishing1</title>
<path fill="none" stroke="black" d="M1449.3,-6396C1371.35,-6396 1285.85,-6396 1207.74,-6396"/>
<polygon fill="black" stroke="black" points="1207.27,-6392.5 1197.27,-6396 1207.27,-6399.5 1207.27,-6392.5"/>
<text text-anchor="middle" x="1260.57" y="-6399.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- PUBLIC_CLIENT_SPOOFING1 -->
<g id="node14" class="node">
<title>PUBLIC_CLIENT_SPOOFING1</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1191.07,-6232.5 696.07,-6232.5 696.07,-6151.5 1191.07,-6151.5 1191.07,-6232.5"/>
<text text-anchor="start" x="820.07" y="-6217.4" font-family="Arial" font-weight="bold" font-size="12.00">PUBLIC_CLIENT_SPOOFING1 ATTACK</text>
<text text-anchor="start" x="1064.07" y="-6217.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="706.57" y="-6199.4" font-family="Arial" font-size="12.00">Authorization servers may wish to automatically process authorization requests</text>
<text text-anchor="start" x="706.57" y="-6186.4" font-family="Arial" font-size="12.00">from clients that have been previously authorized by the user. When the user is</text>
<text text-anchor="start" x="727.57" y="-6173.4" font-family="Arial" font-size="12.00">redirected to the authorization server&#39;s end&#45; user authorization endpoint</text>
<text text-anchor="start" x="711.07" y="-6160.4" font-family="Arial" font-size="12.00">to grant access, the authorization server detects that the user has already[...]</text>
</g>
<!-- PUBLIC_CLIENT_SPOOFING1&#45;&gt;CONFIDENTIALITY -->
<g id="edge18" class="edge">
<title>PUBLIC_CLIENT_SPOOFING1&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M830.91,-6151.47C779.62,-6128.15 721.38,-6094.34 681.07,-6049 618.66,-5978.81 625.12,-5944.05 602.07,-5853 329.44,-4776.2 297.08,-3399.2 293.47,-3160.9"/>
<polygon fill="black" stroke="black" points="296.96,-3160.67 293.32,-3150.72 289.97,-3160.77 296.96,-3160.67"/>
<text text-anchor="middle" x="632.57" y="-6028.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- PUBLIC_CLIENT_SPOOFING1_countermeasure0 -->
<g id="node15" class="node">
<title>PUBLIC_CLIENT_SPOOFING1_countermeasure0</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="1944.07,-6342 1478.07,-6342 1478.07,-6246 1944.07,-6246 1944.07,-6342"/>
<text text-anchor="start" x="1497.57" y="-6327.4" font-family="Arial" font-weight="bold" font-size="12.00"> Pre&#45;registered redirect URI (PRE_REGISTERED_REDIRECT_URI) </text>
<text text-anchor="start" x="1498.07" y="-6303.4" font-family="Arial" font-size="12.00"> Require clients to register any full redirect URIs (Section 5.2.3.5). Don’t</text>
<text text-anchor="start" x="1502.07" y="-6291.4" font-family="Arial" font-size="12.00">redirect to a redirect URI if the client identifier or redirect URI can’t be</text>
<text text-anchor="start" x="1494.57" y="-6279.4" font-family="Arial" font-size="12.00">verified (Section 5.2.3.5). Authorization servers should not automatically</text>
<text text-anchor="start" x="1488.07" y="-6267.4" font-family="Arial" font-size="12.00">process repeat authorizations to public clients unless the client is validated</text>
<text text-anchor="start" x="1695.07" y="-6255.4" font-family="Arial" font-size="12.00">u[...] </text>
</g>
<!-- PUBLIC_CLIENT_SPOOFING1_countermeasure0&#45;&gt;PUBLIC_CLIENT_SPOOFING1 -->
<g id="edge16" class="edge">
<title>PUBLIC_CLIENT_SPOOFING1_countermeasure0&#45;&gt;PUBLIC_CLIENT_SPOOFING1</title>
<path fill="none" stroke="black" d="M1478.06,-6263.09C1390.69,-6251.44 1290.85,-6238.14 1201.36,-6226.22"/>
<polygon fill="black" stroke="black" points="1201.71,-6222.73 1191.34,-6224.88 1200.79,-6229.67 1201.71,-6222.73"/>
<text text-anchor="middle" x="1260.57" y="-6239.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- PUBLIC_CLIENT_SPOOFING1_countermeasure1 -->
<g id="node16" class="node">
<title>PUBLIC_CLIENT_SPOOFING1_countermeasure1</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="2102.57,-6228 1319.57,-6228 1319.57,-6156 2102.57,-6156 2102.57,-6228"/>
<text text-anchor="start" x="1330.07" y="-6213.4" font-family="Arial" font-weight="bold" font-size="12.00"> Limiting the scope of access tokens obtained through automated approvals (REDUCED_ACCESS_TOKEN_SCOPE) </text>
<text text-anchor="start" x="1499.07" y="-6189.4" font-family="Arial" font-size="12.00"> Authorization servers can mitigate the risks associated with automatic</text>
<text text-anchor="start" x="1475.57" y="-6177.4" font-family="Arial" font-size="12.00">processing by limiting the scope of access tokens obtained through automated</text>
<text text-anchor="start" x="1627.57" y="-6165.4" font-family="Arial" font-size="12.00">approvals (Section 5.1.5.1). </text>
</g>
<!-- PUBLIC_CLIENT_SPOOFING1_countermeasure1&#45;&gt;PUBLIC_CLIENT_SPOOFING1 -->
<g id="edge17" class="edge">
<title>PUBLIC_CLIENT_SPOOFING1_countermeasure1&#45;&gt;PUBLIC_CLIENT_SPOOFING1</title>
<path fill="none" stroke="black" d="M1319.47,-6192C1279.38,-6192 1239.39,-6192 1201.29,-6192"/>
<polygon fill="black" stroke="black" points="1201.12,-6188.5 1191.12,-6192 1201.12,-6195.5 1201.12,-6188.5"/>
<text text-anchor="middle" x="1260.57" y="-6195.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_3_1_EAVESDROPPING_ACCESS_TOKENS1 -->
<g id="node17" class="node">
<title>4_3_1_EAVESDROPPING_ACCESS_TOKENS1</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1164.07,-6039.5 723.07,-6039.5 723.07,-5984.5 1164.07,-5984.5 1164.07,-6039.5"/>
<text text-anchor="start" x="772.07" y="-6024.4" font-family="Arial" font-weight="bold" font-size="12.00">4_3_1_EAVESDROPPING_ACCESS_TOKENS1 ATTACK</text>
<text text-anchor="start" x="1112.07" y="-6024.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="733.57" y="-6006.4" font-family="Arial" font-size="12.00">Attackers may attempt to eavesdrop access tokens in transit from the</text>
<text text-anchor="start" x="844.07" y="-5993.4" font-family="Arial" font-size="12.00">authorization server to the client.</text>
</g>
<!-- 4_3_1_EAVESDROPPING_ACCESS_TOKENS1&#45;&gt;CONFIDENTIALITY -->
<g id="edge21" class="edge">
<title>4_3_1_EAVESDROPPING_ACCESS_TOKENS1&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M859.39,-5984.45C801.34,-5961.12 726.43,-5922.07 681.07,-5864 600.16,-5760.41 627.91,-5707.88 602.07,-5579 406.51,-4603.45 311.79,-3383.51 295.57,-3160.75"/>
<polygon fill="black" stroke="black" points="299.05,-3160.34 294.84,-3150.61 292.07,-3160.84 299.05,-3160.34"/>
<text text-anchor="middle" x="632.57" y="-5837.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_3_1_EAVESDROPPING_ACCESS_TOKENS1_countermeasure0 -->
<g id="node18" class="node">
<title>4_3_1_EAVESDROPPING_ACCESS_TOKENS1_countermeasure0</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="2016.57,-6138 1405.57,-6138 1405.57,-6066 2016.57,-6066 2016.57,-6138"/>
<text text-anchor="start" x="1416.07" y="-6123.4" font-family="Arial" font-weight="bold" font-size="12.00"> Secure transport layer to CLient to AUTH_SERVER by TLS (CLIENT_AUTH_SERVER_TLS) </text>
<text text-anchor="start" x="1477.57" y="-6099.4" font-family="Arial" font-size="12.00"> As per the core OAuth spec, the authorization servers must ensure that these</text>
<text text-anchor="start" x="1472.07" y="-6087.4" font-family="Arial" font-size="12.00">transmissions are protected using transport&#45;layer mechanisms such as TLS (see</text>
<text text-anchor="start" x="1666.07" y="-6075.4" font-family="Arial" font-size="12.00">Section 5.1.1). </text>
</g>
<!-- 4_3_1_EAVESDROPPING_ACCESS_TOKENS1_countermeasure0&#45;&gt;4_3_1_EAVESDROPPING_ACCESS_TOKENS1 -->
<g id="edge19" class="edge">
<title>4_3_1_EAVESDROPPING_ACCESS_TOKENS1_countermeasure0&#45;&gt;4_3_1_EAVESDROPPING_ACCESS_TOKENS1</title>
<path fill="none" stroke="black" d="M1405.44,-6067.52C1374.91,-6064 1344.37,-6060.45 1315.07,-6057 1269.66,-6051.66 1221.12,-6045.84 1174.65,-6040.21"/>
<polygon fill="black" stroke="black" points="1174.8,-6036.71 1164.45,-6038.98 1173.96,-6043.66 1174.8,-6036.71"/>
<text text-anchor="middle" x="1260.57" y="-6057.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_3_1_EAVESDROPPING_ACCESS_TOKENS1_countermeasure1 -->
<g id="node19" class="node">
<title>4_3_1_EAVESDROPPING_ACCESS_TOKENS1_countermeasure1</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="2102.57,-6048 1319.57,-6048 1319.57,-5976 2102.57,-5976 2102.57,-6048"/>
<text text-anchor="start" x="1330.07" y="-6033.4" font-family="Arial" font-weight="bold" font-size="12.00"> Limiting the scope of access tokens obtained through automated approvals (REDUCED_ACCESS_TOKEN_SCOPE) </text>
<text text-anchor="start" x="1499.07" y="-6009.4" font-family="Arial" font-size="12.00"> Authorization servers can mitigate the risks associated with automatic</text>
<text text-anchor="start" x="1475.57" y="-5997.4" font-family="Arial" font-size="12.00">processing by limiting the scope of access tokens obtained through automated</text>
<text text-anchor="start" x="1627.57" y="-5985.4" font-family="Arial" font-size="12.00">approvals (Section 5.1.5.1). </text>
</g>
<!-- 4_3_1_EAVESDROPPING_ACCESS_TOKENS1_countermeasure1&#45;&gt;4_3_1_EAVESDROPPING_ACCESS_TOKENS1 -->
<g id="edge20" class="edge">
<title>4_3_1_EAVESDROPPING_ACCESS_TOKENS1_countermeasure1&#45;&gt;4_3_1_EAVESDROPPING_ACCESS_TOKENS1</title>
<path fill="none" stroke="black" d="M1319.47,-6012C1269.76,-6012 1220.23,-6012 1174.23,-6012"/>
<polygon fill="black" stroke="black" points="1174.17,-6008.5 1164.17,-6012 1174.17,-6015.5 1174.17,-6008.5"/>
<text text-anchor="middle" x="1260.57" y="-6015.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_3_2_AS_DB_TOKEN_DISCLOSURE -->
<g id="node20" class="node">
<title>4_3_2_AS_DB_TOKEN_DISCLOSURE</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1201.57,-5854.5 685.57,-5854.5 685.57,-5773.5 1201.57,-5773.5 1201.57,-5854.5"/>
<text text-anchor="start" x="798.57" y="-5839.4" font-family="Arial" font-weight="bold" font-size="12.00">4_3_2_AS_DB_TOKEN_DISCLOSURE ATTACK</text>
<text text-anchor="start" x="1084.57" y="-5839.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="695.57" y="-5821.4" font-family="Arial" font-size="12.00">An attacker may obtain access tokens from the authorization server’s database by</text>
<text text-anchor="start" x="706.57" y="-5808.4" font-family="Arial" font-size="12.00">gaining access to the database or launching a SQL injection attack. &#160;This threat</text>
<text text-anchor="start" x="716.57" y="-5795.4" font-family="Arial" font-size="12.00">is applicable if the authorization server stores access tokens as handles in a</text>
<text text-anchor="start" x="913.57" y="-5782.4" font-family="Arial" font-size="12.00">database.</text>
</g>
<!-- 4_3_2_AS_DB_TOKEN_DISCLOSURE&#45;&gt;CONFIDENTIALITY -->
<g id="edge25" class="edge">
<title>4_3_2_AS_DB_TOKEN_DISCLOSURE&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M875.83,-5773.38C816.65,-5734.13 731.94,-5669.46 681.07,-5593 616.29,-5495.63 627.79,-5456.09 602.07,-5342 405.1,-4468.19 312.3,-3370.66 295.76,-3160.62"/>
<polygon fill="black" stroke="black" points="299.24,-3160.17 294.97,-3150.47 292.26,-3160.72 299.24,-3160.17"/>
<text text-anchor="middle" x="632.57" y="-5563.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_3_2_AS_DB_TOKEN_DISCLOSURE_countermeasure0 -->
<g id="node21" class="node">
<title>4_3_2_AS_DB_TOKEN_DISCLOSURE_countermeasure0</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="2009.07,-5958 1413.07,-5958 1413.07,-5910 2009.07,-5910 2009.07,-5958"/>
<text text-anchor="start" x="1423.07" y="-5943.4" font-family="Arial" font-weight="bold" font-size="12.00"> Store access token hashes only (Section 5.1.4.1.3). (5_1_4_1_3_HASHED_TOKEN_DB) </text>
<text text-anchor="start" x="1554.57" y="-5919.4" font-family="Arial" font-size="12.00"> Store access token hashes only (Section 5.1.4.1.3). </text>
</g>
<!-- 4_3_2_AS_DB_TOKEN_DISCLOSURE_countermeasure0&#45;&gt;4_3_2_AS_DB_TOKEN_DISCLOSURE -->
<g id="edge22" class="edge">
<title>4_3_2_AS_DB_TOKEN_DISCLOSURE_countermeasure0&#45;&gt;4_3_2_AS_DB_TOKEN_DISCLOSURE</title>
<path fill="none" stroke="black" d="M1412.93,-5913.92C1379.83,-5910.28 1346.68,-5906 1315.07,-5901 1245.39,-5889.97 1169.39,-5873.01 1104.46,-5856.98"/>
<polygon fill="black" stroke="black" points="1105.09,-5853.53 1094.55,-5854.52 1103.41,-5860.33 1105.09,-5853.53"/>
<text text-anchor="middle" x="1260.57" y="-5900.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_3_2_AS_DB_TOKEN_DISCLOSURE_countermeasure1 -->
<g id="node22" class="node">
<title>4_3_2_AS_DB_TOKEN_DISCLOSURE_countermeasure1</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1951.07,-5892 1471.07,-5892 1471.07,-5832 1951.07,-5832 1951.07,-5892"/>
<text text-anchor="start" x="1492.57" y="-5877.4" font-family="Arial" font-weight="bold" font-size="12.00"> Enforce Standard System Security Means (5_1_4_1_1_SYS_SEC) </text>
<text text-anchor="start" x="1481.07" y="-5853.4" font-family="Arial" font-size="12.00"> A server system may be locked down so that no attacker may get access to</text>
<text text-anchor="start" x="1580.07" y="-5841.4" font-family="Arial" font-size="12.00">sensitive configuration files and databases. </text>
</g>
<!-- 4_3_2_AS_DB_TOKEN_DISCLOSURE_countermeasure1&#45;&gt;4_3_2_AS_DB_TOKEN_DISCLOSURE -->
<g id="edge23" class="edge">
<title>4_3_2_AS_DB_TOKEN_DISCLOSURE_countermeasure1&#45;&gt;4_3_2_AS_DB_TOKEN_DISCLOSURE</title>
<path fill="none" stroke="black" d="M1471.01,-5847.01C1388.72,-5841.85 1296.07,-5836.04 1211.7,-5830.75"/>
<polygon fill="black" stroke="black" points="1211.91,-5827.26 1201.71,-5830.12 1211.48,-5834.24 1211.91,-5827.26"/>
<text text-anchor="middle" x="1260.57" y="-5838.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_3_2_AS_DB_TOKEN_DISCLOSURE_countermeasure2 -->
<g id="node23" class="node">
<title>4_3_2_AS_DB_TOKEN_DISCLOSURE_countermeasure2</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1967.07,-5814 1455.07,-5814 1455.07,-5718 1967.07,-5718 1967.07,-5814"/>
<text text-anchor="start" x="1465.07" y="-5799.4" font-family="Arial" font-weight="bold" font-size="12.00"> Enforce Standard SQL Injection Countermeasures (5_1_4_1_2_SQL_SEC) </text>
<text text-anchor="start" x="1473.57" y="-5775.4" font-family="Arial" font-size="12.00"> If a client identifier or other authentication component is queried or compared</text>
<text text-anchor="start" x="1471.07" y="-5763.4" font-family="Arial" font-size="12.00">against a SQL database, it may become possible for an injection attack to occur</text>
<text text-anchor="start" x="1482.57" y="-5751.4" font-family="Arial" font-size="12.00">if parameters received are not validated before submission to the database.</text>
<text text-anchor="start" x="1489.57" y="-5739.4" font-family="Arial" font-size="12.00">&lt;br/&gt;o Ensure that server code is using the minimum database privileges</text>
<text text-anchor="start" x="1698.57" y="-5727.4" font-family="Arial" font-size="12.00">[...] </text>
</g>
<!-- 4_3_2_AS_DB_TOKEN_DISCLOSURE_countermeasure2&#45;&gt;4_3_2_AS_DB_TOKEN_DISCLOSURE -->
<g id="edge24" class="edge">
<title>4_3_2_AS_DB_TOKEN_DISCLOSURE_countermeasure2&#45;&gt;4_3_2_AS_DB_TOKEN_DISCLOSURE</title>
<path fill="none" stroke="black" d="M1454.9,-5782C1376.82,-5786.9 1290.73,-5792.29 1211.86,-5797.24"/>
<polygon fill="black" stroke="black" points="1211.54,-5793.75 1201.78,-5797.87 1211.98,-5800.74 1211.54,-5793.75"/>
<text text-anchor="middle" x="1260.57" y="-5798.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_3_3_CLIENT_CREDENTIALS_DISCLOSURE -->
<g id="node24" class="node">
<title>4_3_3_CLIENT_CREDENTIALS_DISCLOSURE</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1193.07,-5584 694.07,-5584 694.07,-5516 1193.07,-5516 1193.07,-5584"/>
<text text-anchor="start" x="773.57" y="-5569.4" font-family="Arial" font-weight="bold" font-size="12.00">4_3_3_CLIENT_CREDENTIALS_DISCLOSURE ATTACK</text>
<text text-anchor="start" x="1110.57" y="-5569.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="712.57" y="-5551.4" font-family="Arial" font-size="12.00">An attacker could attempt to eavesdrop the transmission of client credentials</text>
<text text-anchor="start" x="704.57" y="-5538.4" font-family="Arial" font-size="12.00">between the client and server during the client authentication process or during</text>
<text text-anchor="start" x="877.57" y="-5525.4" font-family="Arial" font-size="12.00">OAuth token requests.</text>
</g>
<!-- 4_3_3_CLIENT_CREDENTIALS_DISCLOSURE&#45;&gt;CONFIDENTIALITY -->
<g id="edge28" class="edge">
<title>4_3_3_CLIENT_CREDENTIALS_DISCLOSURE&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M873.57,-5515.87C813.5,-5482.55 728.77,-5426.23 681.07,-5353 596.86,-5223.74 632.09,-5166.32 602.07,-5015 454.44,-4270.82 324.46,-3351.67 297.96,-3160.73"/>
<polygon fill="black" stroke="black" points="301.41,-3160.11 296.57,-3150.69 294.47,-3161.07 301.41,-3160.11"/>
<text text-anchor="middle" x="632.57" y="-5326.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_3_3_CLIENT_CREDENTIALS_DISCLOSURE_countermeasure0 -->
<g id="node25" class="node">
<title>4_3_3_CLIENT_CREDENTIALS_DISCLOSURE_countermeasure0</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="1980.57,-5700 1441.57,-5700 1441.57,-5604 1980.57,-5604 1980.57,-5700"/>
<text text-anchor="start" x="1452.07" y="-5685.4" font-family="Arial" font-weight="bold" font-size="12.00"> Ensure Confidentiality of Requests (TLS) (5_1_1_CONFIDENTIAL_REQUESTS) </text>
<text text-anchor="start" x="1493.57" y="-5661.4" font-family="Arial" font-size="12.00"> This is applicable to all requests sent from the client to the authorization</text>
<text text-anchor="start" x="1476.57" y="-5649.4" font-family="Arial" font-size="12.00">server or resource server. While OAuth provides a mechanism for verifying the</text>
<text text-anchor="start" x="1497.07" y="-5637.4" font-family="Arial" font-size="12.00">integrity of requests, it provides no guarantee of request confidentiality.</text>
<text text-anchor="start" x="1485.07" y="-5625.4" font-family="Arial" font-size="12.00">Unless further precautions are taken, eavesdroppers will have full access to</text>
<text text-anchor="start" x="1699.07" y="-5613.4" font-family="Arial" font-size="12.00">[...] </text>
</g>
<!-- 4_3_3_CLIENT_CREDENTIALS_DISCLOSURE_countermeasure0&#45;&gt;4_3_3_CLIENT_CREDENTIALS_DISCLOSURE -->
<g id="edge26" class="edge">
<title>4_3_3_CLIENT_CREDENTIALS_DISCLOSURE_countermeasure0&#45;&gt;4_3_3_CLIENT_CREDENTIALS_DISCLOSURE</title>
<path fill="none" stroke="black" d="M1441.53,-5616.22C1364.31,-5605.93 1280.27,-5594.73 1203.63,-5584.52"/>
<polygon fill="black" stroke="black" points="1203.73,-5581 1193.36,-5583.15 1202.81,-5587.94 1203.73,-5581"/>
<text text-anchor="middle" x="1260.57" y="-5597.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_3_3_CLIENT_CREDENTIALS_DISCLOSURE_countermeasure1 -->
<g id="node26" class="node">
<title>4_3_3_CLIENT_CREDENTIALS_DISCLOSURE_countermeasure1</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1984.07,-5586 1438.07,-5586 1438.07,-5514 1984.07,-5514 1984.07,-5586"/>
<text text-anchor="start" x="1448.07" y="-5571.4" font-family="Arial" font-weight="bold" font-size="12.00"> Do not send plaintext credentials (CONFIDENTIAL_CREDENTIALS_REQUESTS) </text>
<text text-anchor="start" x="1494.57" y="-5547.4" font-family="Arial" font-size="12.00"> Use alternative authentication means that do not require the sending of</text>
<text text-anchor="start" x="1481.07" y="-5535.4" font-family="Arial" font-size="12.00">plaintext credentials over the wire (e.g., Hash&#45;based Message Authentication</text>
<text text-anchor="start" x="1689.57" y="-5523.4" font-family="Arial" font-size="12.00">Code). </text>
</g>
<!-- 4_3_3_CLIENT_CREDENTIALS_DISCLOSURE_countermeasure1&#45;&gt;4_3_3_CLIENT_CREDENTIALS_DISCLOSURE -->
<g id="edge27" class="edge">
<title>4_3_3_CLIENT_CREDENTIALS_DISCLOSURE_countermeasure1&#45;&gt;4_3_3_CLIENT_CREDENTIALS_DISCLOSURE</title>
<path fill="none" stroke="black" d="M1438.03,-5550C1361.63,-5550 1278.8,-5550 1203.21,-5550"/>
<polygon fill="black" stroke="black" points="1203.08,-5546.5 1193.08,-5550 1203.08,-5553.5 1203.08,-5546.5"/>
<text text-anchor="middle" x="1260.57" y="-5553.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_3_4_CLIENT_CREDENTIALS_DISCLOSURE -->
<g id="node27" class="node">
<title>4_3_4_CLIENT_CREDENTIALS_DISCLOSURE</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1197.07,-5344 690.07,-5344 690.07,-5276 1197.07,-5276 1197.07,-5344"/>
<text text-anchor="start" x="773.57" y="-5329.4" font-family="Arial" font-weight="bold" font-size="12.00">4_3_4_CLIENT_CREDENTIALS_DISCLOSURE ATTACK</text>
<text text-anchor="start" x="1110.57" y="-5329.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="736.07" y="-5311.4" font-family="Arial" font-size="12.00">An attacker may obtain valid &quot;client_id&quot;/secret combinations from the</text>
<text text-anchor="start" x="700.57" y="-5298.4" font-family="Arial" font-size="12.00">authorization server’s database by gaining access to the database or launching a</text>
<text text-anchor="start" x="882.07" y="-5285.4" font-family="Arial" font-size="12.00">SQL injection attack.</text>
</g>
<!-- 4_3_4_CLIENT_CREDENTIALS_DISCLOSURE&#45;&gt;CONFIDENTIALITY -->
<g id="edge32" class="edge">
<title>4_3_4_CLIENT_CREDENTIALS_DISCLOSURE&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M895.28,-5275.87C835.45,-5230 733.86,-5142.61 681.07,-5043 316.33,-4354.73 293.67,-3360.8 292.91,-3160.82"/>
<polygon fill="black" stroke="black" points="296.41,-3160.59 292.89,-3150.6 289.41,-3160.61 296.41,-3160.59"/>
<text text-anchor="middle" x="632.57" y="-4999.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_3_4_CLIENT_CREDENTIALS_DISCLOSURE_countermeasure0 -->
<g id="node28" class="node">
<title>4_3_4_CLIENT_CREDENTIALS_DISCLOSURE_countermeasure0</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1967.07,-5496 1455.07,-5496 1455.07,-5400 1967.07,-5400 1967.07,-5496"/>
<text text-anchor="start" x="1465.07" y="-5481.4" font-family="Arial" font-weight="bold" font-size="12.00"> Enforce Standard SQL Injection Countermeasures (5_1_4_1_2_SQL_SEC) </text>
<text text-anchor="start" x="1473.57" y="-5457.4" font-family="Arial" font-size="12.00"> If a client identifier or other authentication component is queried or compared</text>
<text text-anchor="start" x="1471.07" y="-5445.4" font-family="Arial" font-size="12.00">against a SQL database, it may become possible for an injection attack to occur</text>
<text text-anchor="start" x="1482.57" y="-5433.4" font-family="Arial" font-size="12.00">if parameters received are not validated before submission to the database.</text>
<text text-anchor="start" x="1489.57" y="-5421.4" font-family="Arial" font-size="12.00">&lt;br/&gt;o Ensure that server code is using the minimum database privileges</text>
<text text-anchor="start" x="1698.57" y="-5409.4" font-family="Arial" font-size="12.00">[...] </text>
</g>
<!-- 4_3_4_CLIENT_CREDENTIALS_DISCLOSURE_countermeasure0&#45;&gt;4_3_4_CLIENT_CREDENTIALS_DISCLOSURE -->
<g id="edge29" class="edge">
<title>4_3_4_CLIENT_CREDENTIALS_DISCLOSURE_countermeasure0&#45;&gt;4_3_4_CLIENT_CREDENTIALS_DISCLOSURE</title>
<path fill="none" stroke="black" d="M1454.92,-5413.93C1408.3,-5406.92 1360.15,-5399.17 1315.07,-5391 1243.74,-5378.07 1165.24,-5361.28 1098.92,-5346.34"/>
<polygon fill="black" stroke="black" points="1099.33,-5342.85 1088.81,-5344.06 1097.79,-5349.68 1099.33,-5342.85"/>
<text text-anchor="middle" x="1260.57" y="-5390.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_3_4_CLIENT_CREDENTIALS_DISCLOSURE_countermeasure1 -->
<g id="node29" class="node">
<title>4_3_4_CLIENT_CREDENTIALS_DISCLOSURE_countermeasure1</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1951.07,-5382 1471.07,-5382 1471.07,-5322 1951.07,-5322 1951.07,-5382"/>
<text text-anchor="start" x="1492.57" y="-5367.4" font-family="Arial" font-weight="bold" font-size="12.00"> Enforce Standard System Security Means (5_1_4_1_1_SYS_SEC) </text>
<text text-anchor="start" x="1481.07" y="-5343.4" font-family="Arial" font-size="12.00"> A server system may be locked down so that no attacker may get access to</text>
<text text-anchor="start" x="1580.07" y="-5331.4" font-family="Arial" font-size="12.00">sensitive configuration files and databases. </text>
</g>
<!-- 4_3_4_CLIENT_CREDENTIALS_DISCLOSURE_countermeasure1&#45;&gt;4_3_4_CLIENT_CREDENTIALS_DISCLOSURE -->
<g id="edge30" class="edge">
<title>4_3_4_CLIENT_CREDENTIALS_DISCLOSURE_countermeasure1&#45;&gt;4_3_4_CLIENT_CREDENTIALS_DISCLOSURE</title>
<path fill="none" stroke="black" d="M1471.01,-5338.88C1387.35,-5334.29 1292.98,-5329.12 1207.49,-5324.43"/>
<polygon fill="black" stroke="black" points="1207.55,-5320.92 1197.37,-5323.87 1207.17,-5327.91 1207.55,-5320.92"/>
<text text-anchor="middle" x="1260.57" y="-5331.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_3_4_CLIENT_CREDENTIALS_DISCLOSURE_countermeasure2 -->
<g id="node30" class="node">
<title>4_3_4_CLIENT_CREDENTIALS_DISCLOSURE_countermeasure2</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="2006.57,-5304 1415.57,-5304 1415.57,-5232 2006.57,-5232 2006.57,-5304"/>
<text text-anchor="start" x="1426.07" y="-5289.4" font-family="Arial" font-weight="bold" font-size="12.00"> Enforce Credential Storage Protection Best Practices (5_1_4_1_CRED_PROTECTION) </text>
<text text-anchor="start" x="1474.07" y="-5265.4" font-family="Arial" font-size="12.00"> Administrators should undertake industry best practices to protect the storage</text>
<text text-anchor="start" x="1476.07" y="-5253.4" font-family="Arial" font-size="12.00">of credentials (for example, see [OWASP]). Such practices may include but are</text>
<text text-anchor="start" x="1588.57" y="-5241.4" font-family="Arial" font-size="12.00">not limited to the following sub&#45;sections. </text>
</g>
<!-- 4_3_4_CLIENT_CREDENTIALS_DISCLOSURE_countermeasure2&#45;&gt;4_3_4_CLIENT_CREDENTIALS_DISCLOSURE -->
<g id="edge31" class="edge">
<title>4_3_4_CLIENT_CREDENTIALS_DISCLOSURE_countermeasure2&#45;&gt;4_3_4_CLIENT_CREDENTIALS_DISCLOSURE</title>
<path fill="none" stroke="black" d="M1415.48,-5284.16C1346.95,-5287.92 1274.44,-5291.9 1207.39,-5295.58"/>
<polygon fill="black" stroke="black" points="1206.91,-5292.1 1197.11,-5296.14 1207.29,-5299.09 1206.91,-5292.1"/>
<text text-anchor="middle" x="1260.57" y="-5296.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_3_5_CLIENT_SECRET_BRUTE_FORCE -->
<g id="node31" class="node">
<title>4_3_5_CLIENT_SECRET_BRUTE_FORCE</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1126.57,-5034 760.57,-5034 760.57,-4992 1126.57,-4992 1126.57,-5034"/>
<text text-anchor="start" x="789.07" y="-5019.4" font-family="Arial" font-weight="bold" font-size="12.00">4_3_5_CLIENT_SECRET_BRUTE_FORCE ATTACK</text>
<text text-anchor="start" x="1094.07" y="-5019.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="770.57" y="-5001.4" font-family="Arial" font-size="12.00">An attacker may try to guess valid &quot;client_id&quot;/secret pairs.</text>
</g>
<!-- 4_3_5_CLIENT_SECRET_BRUTE_FORCE&#45;&gt;CONFIDENTIALITY -->
<g id="edge36" class="edge">
<title>4_3_5_CLIENT_SECRET_BRUTE_FORCE&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M927.67,-4991.99C883.91,-4929.45 754.31,-4737.88 681.07,-4562 458.22,-4026.86 327.97,-3326.18 299.15,-3160.98"/>
<polygon fill="black" stroke="black" points="302.56,-3160.13 297.4,-3150.88 295.66,-3161.33 302.56,-3160.13"/>
<text text-anchor="middle" x="632.57" y="-4490.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_3_5_CLIENT_SECRET_BRUTE_FORCE_countermeasure0 -->
<g id="node32" class="node">
<title>4_3_5_CLIENT_SECRET_BRUTE_FORCE_countermeasure0</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1958.07,-5214 1464.07,-5214 1464.07,-5118 1958.07,-5118 1958.07,-5214"/>
<text text-anchor="start" x="1479.57" y="-5199.4" font-family="Arial" font-weight="bold" font-size="12.00"> Use High Entropy for Secrets (5_1_4_2_2_HIGH_ENTROPY_SECRETS) </text>
<text text-anchor="start" x="1487.07" y="-5175.4" font-family="Arial" font-size="12.00"> When creating secrets not intended for usage by human users (e.g., client</text>
<text text-anchor="start" x="1474.07" y="-5163.4" font-family="Arial" font-size="12.00">secrets or token handles), the authorization server should include a reasonable</text>
<text text-anchor="start" x="1487.07" y="-5151.4" font-family="Arial" font-size="12.00">level of entropy in order to mitigate the risk of guessing attacks. The token</text>
<text text-anchor="start" x="1488.07" y="-5139.4" font-family="Arial" font-size="12.00">value should be &gt;=128 bits long and constructed from a cryptographically</text>
<text text-anchor="start" x="1691.07" y="-5127.4" font-family="Arial" font-size="12.00">str[...] </text>
</g>
<!-- 4_3_5_CLIENT_SECRET_BRUTE_FORCE_countermeasure0&#45;&gt;4_3_5_CLIENT_SECRET_BRUTE_FORCE -->
<g id="edge33" class="edge">
<title>4_3_5_CLIENT_SECRET_BRUTE_FORCE_countermeasure0&#45;&gt;4_3_5_CLIENT_SECRET_BRUTE_FORCE</title>
<path fill="none" stroke="black" d="M1463.87,-5134.76C1414.43,-5127.28 1362.96,-5118.63 1315.07,-5109 1214.54,-5088.79 1100.58,-5058.06 1025.91,-5036.84"/>
<polygon fill="black" stroke="black" points="1026.67,-5033.41 1016.09,-5034.04 1024.75,-5040.15 1026.67,-5033.41"/>
<text text-anchor="middle" x="1260.57" y="-5107.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_3_5_CLIENT_SECRET_BRUTE_FORCE_countermeasure1 -->
<g id="node33" class="node">
<title>4_3_5_CLIENT_SECRET_BRUTE_FORCE_countermeasure1</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1966.07,-5100 1456.07,-5100 1456.07,-5028 1966.07,-5028 1966.07,-5100"/>
<text text-anchor="start" x="1557.07" y="-5085.4" font-family="Arial" font-weight="bold" font-size="12.00"> Lock Accounts (5_1_4_2_3_LOCK_ACCOUNTS) </text>
<text text-anchor="start" x="1466.07" y="-5061.4" font-family="Arial" font-size="12.00"> Online attacks on passwords can be mitigated by locking the respective accounts</text>
<text text-anchor="start" x="1472.07" y="-5049.4" font-family="Arial" font-size="12.00">after a certain number of failed attempts. Note: This measure can be abused to</text>
<text text-anchor="start" x="1604.07" y="-5037.4" font-family="Arial" font-size="12.00">lock down legitimate service users. </text>
</g>
<!-- 4_3_5_CLIENT_SECRET_BRUTE_FORCE_countermeasure1&#45;&gt;4_3_5_CLIENT_SECRET_BRUTE_FORCE -->
<g id="edge34" class="edge">
<title>4_3_5_CLIENT_SECRET_BRUTE_FORCE_countermeasure1&#45;&gt;4_3_5_CLIENT_SECRET_BRUTE_FORCE</title>
<path fill="none" stroke="black" d="M1455.97,-5047.07C1351.95,-5040.14 1233.59,-5032.26 1136.95,-5025.82"/>
<polygon fill="black" stroke="black" points="1136.98,-5022.31 1126.77,-5025.14 1136.52,-5029.3 1136.98,-5022.31"/>
<text text-anchor="middle" x="1260.57" y="-5038.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_3_5_CLIENT_SECRET_BRUTE_FORCE_countermeasure2 -->
<g id="node34" class="node">
<title>4_3_5_CLIENT_SECRET_BRUTE_FORCE_countermeasure2</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1987.57,-5010 1434.57,-5010 1434.57,-4914 1987.57,-4914 1987.57,-5010"/>
<text text-anchor="start" x="1445.07" y="-4995.4" font-family="Arial" font-weight="bold" font-size="12.00"> Use strong client authentication (5_2_3_7_STRONG_CLIENT_AUTHENTICATION) </text>
<text text-anchor="start" x="1475.57" y="-4971.4" font-family="Arial" font-size="12.00"> By using an alternative form of authentication such as client assertion [OAuth&#45;</text>
<text text-anchor="start" x="1511.07" y="-4959.4" font-family="Arial" font-size="12.00">ASSERTIONS], the need to distribute a &quot;client_secret&quot; is eliminated.</text>
<text text-anchor="start" x="1481.57" y="-4947.4" font-family="Arial" font-size="12.00">This may require the use of a secure private key store or other supplemental</text>
<text text-anchor="start" x="1504.57" y="-4935.4" font-family="Arial" font-size="12.00">authentication system as specified by the client assertion issuer in its</text>
<text text-anchor="start" x="1667.57" y="-4923.4" font-family="Arial" font-size="12.00">authentica[...] </text>
</g>
<!-- 4_3_5_CLIENT_SECRET_BRUTE_FORCE_countermeasure2&#45;&gt;4_3_5_CLIENT_SECRET_BRUTE_FORCE -->
<g id="edge35" class="edge">
<title>4_3_5_CLIENT_SECRET_BRUTE_FORCE_countermeasure2&#45;&gt;4_3_5_CLIENT_SECRET_BRUTE_FORCE</title>
<path fill="none" stroke="black" d="M1434.52,-4980.36C1335.9,-4986.93 1226.96,-4994.19 1136.89,-5000.19"/>
<polygon fill="black" stroke="black" points="1136.59,-4996.7 1126.84,-5000.86 1137.05,-5003.68 1136.59,-4996.7"/>
<text text-anchor="middle" x="1260.57" y="-4996.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_1_AUTH_CODE_DISCLOSURE -->
<g id="node35" class="node">
<title>4_4_1_1_AUTH_CODE_DISCLOSURE</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1168.57,-4553 718.57,-4553 718.57,-4459 1168.57,-4459 1168.57,-4553"/>
<text text-anchor="start" x="798.57" y="-4538.4" font-family="Arial" font-weight="bold" font-size="12.00">4_4_1_1_AUTH_CODE_DISCLOSURE ATTACK</text>
<text text-anchor="start" x="1084.57" y="-4538.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="739.07" y="-4520.4" font-family="Arial" font-size="12.00">An attacker could try to eavesdrop transmission of the authorization</text>
<text text-anchor="start" x="748.07" y="-4507.4" font-family="Arial" font-size="12.00">&quot;code&quot; between the authorization server and client. Furthermore,</text>
<text text-anchor="start" x="760.57" y="-4494.4" font-family="Arial" font-size="12.00">authorization &quot;codes&quot; are passed via the browser, which may</text>
<text text-anchor="start" x="728.57" y="-4481.4" font-family="Arial" font-size="12.00">unintentionally leak those codes to untrusted web sites and attackers in</text>
<text text-anchor="start" x="809.57" y="-4468.4" font-family="Arial" font-size="12.00">different ways: &lt;br/&gt;o Referrer headers: [...]</text>
</g>
<!-- 4_4_1_1_AUTH_CODE_DISCLOSURE&#45;&gt;CONFIDENTIALITY -->
<g id="edge43" class="edge">
<title>4_4_1_1_AUTH_CODE_DISCLOSURE&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M901.26,-4458.89C845.47,-4393.46 745.63,-4269.68 681.07,-4151 481.95,-3784.98 339.75,-3295.14 302.62,-3160.51"/>
<polygon fill="black" stroke="black" points="305.96,-3159.44 299.93,-3150.72 299.21,-3161.29 305.96,-3159.44"/>
<text text-anchor="middle" x="632.57" y="-4101.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_4_1_1_AUTH_CODE_DISCLOSURE_countermeasure0 -->
<g id="node36" class="node">
<title>4_4_1_1_AUTH_CODE_DISCLOSURE_countermeasure0</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="1980.57,-4896 1441.57,-4896 1441.57,-4800 1980.57,-4800 1980.57,-4896"/>
<text text-anchor="start" x="1452.07" y="-4881.4" font-family="Arial" font-weight="bold" font-size="12.00"> Ensure Confidentiality of Requests (TLS) (5_1_1_CONFIDENTIAL_REQUESTS) </text>
<text text-anchor="start" x="1493.57" y="-4857.4" font-family="Arial" font-size="12.00"> This is applicable to all requests sent from the client to the authorization</text>
<text text-anchor="start" x="1476.57" y="-4845.4" font-family="Arial" font-size="12.00">server or resource server. While OAuth provides a mechanism for verifying the</text>
<text text-anchor="start" x="1497.07" y="-4833.4" font-family="Arial" font-size="12.00">integrity of requests, it provides no guarantee of request confidentiality.</text>
<text text-anchor="start" x="1485.07" y="-4821.4" font-family="Arial" font-size="12.00">Unless further precautions are taken, eavesdroppers will have full access to</text>
<text text-anchor="start" x="1699.07" y="-4809.4" font-family="Arial" font-size="12.00">[...] </text>
</g>
<!-- 4_4_1_1_AUTH_CODE_DISCLOSURE_countermeasure0&#45;&gt;4_4_1_1_AUTH_CODE_DISCLOSURE -->
<g id="edge37" class="edge">
<title>4_4_1_1_AUTH_CODE_DISCLOSURE_countermeasure0&#45;&gt;4_4_1_1_AUTH_CODE_DISCLOSURE</title>
<path fill="none" stroke="black" d="M1441.54,-4828.2C1398.22,-4819.67 1354.65,-4807.71 1315.07,-4791 1186.31,-4736.64 1063.11,-4626.43 996.27,-4560.12"/>
<polygon fill="black" stroke="black" points="998.74,-4557.64 989.19,-4553.05 993.79,-4562.6 998.74,-4557.64"/>
<text text-anchor="middle" x="1260.57" y="-4783.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_1_AUTH_CODE_DISCLOSURE_countermeasure1 -->
<g id="node37" class="node">
<title>4_4_1_1_AUTH_CODE_DISCLOSURE_countermeasure1</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="2001.57,-4782 1420.57,-4782 1420.57,-4686 2001.57,-4686 2001.57,-4782"/>
<text text-anchor="start" x="1431.07" y="-4767.4" font-family="Arial" font-weight="bold" font-size="12.00"> Binding of Authorization &quot;code&quot; to &quot;client_id&quot; (5_2_4_4_CLIENT_TO_CODE_BINDING) </text>
<text text-anchor="start" x="1498.57" y="-4743.4" font-family="Arial" font-size="12.00"> The authorization server should bind every authorization &quot;code&quot; to the</text>
<text text-anchor="start" x="1488.07" y="-4731.4" font-family="Arial" font-size="12.00">id of the respective client that initiated the end&#45;user authorization process.</text>
<text text-anchor="start" x="1488.07" y="-4719.4" font-family="Arial" font-size="12.00">This measure is a countermeasure against: &lt;br/&gt;o Replay of authorization</text>
<text text-anchor="start" x="1516.57" y="-4707.4" font-family="Arial" font-size="12.00">&quot;codes&quot; with different client credentials, since an attacker cannot</text>
<text text-anchor="start" x="1648.57" y="-4695.4" font-family="Arial" font-size="12.00">use another &quot;clie[...] </text>
</g>
<!-- 4_4_1_1_AUTH_CODE_DISCLOSURE_countermeasure1&#45;&gt;4_4_1_1_AUTH_CODE_DISCLOSURE -->
<g id="edge38" class="edge">
<title>4_4_1_1_AUTH_CODE_DISCLOSURE_countermeasure1&#45;&gt;4_4_1_1_AUTH_CODE_DISCLOSURE</title>
<path fill="none" stroke="black" d="M1420.51,-4702.08C1384.66,-4695.25 1348.79,-4686.98 1315.07,-4677 1216.54,-4647.83 1110.73,-4596.82 1037.51,-4558.08"/>
<polygon fill="black" stroke="black" points="1038.77,-4554.79 1028.3,-4553.18 1035.48,-4560.97 1038.77,-4554.79"/>
<text text-anchor="middle" x="1260.57" y="-4673.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_1_AUTH_CODE_DISCLOSURE_countermeasure2 -->
<g id="node38" class="node">
<title>4_4_1_1_AUTH_CODE_DISCLOSURE_countermeasure2</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1933.57,-4668 1488.57,-4668 1488.57,-4572 1933.57,-4572 1933.57,-4668"/>
<text text-anchor="start" x="1510.07" y="-4653.4" font-family="Arial" font-weight="bold" font-size="12.00"> Use Short Expiration Time (5_1_5_3_SHORT_EXPIRY_CODE) </text>
<text text-anchor="start" x="1499.07" y="-4629.4" font-family="Arial" font-size="12.00"> A short expiration time for tokens is a means of protection against the</text>
<text text-anchor="start" x="1534.07" y="-4617.4" font-family="Arial" font-size="12.00">following threats: &lt;br/&gt;o replay &lt;br/&gt;o token leak (a short</text>
<text text-anchor="start" x="1510.57" y="-4605.4" font-family="Arial" font-size="12.00">expiration time will reduce impact) &lt;br/&gt;o online guessing (a short</text>
<text text-anchor="start" x="1500.57" y="-4593.4" font-family="Arial" font-size="12.00">expiration time will reduce the likelihood of success) Note: Short token</text>
<text text-anchor="start" x="1593.57" y="-4581.4" font-family="Arial" font-size="12.00">duration requires more precise cloc[...] </text>
</g>
<!-- 4_4_1_1_AUTH_CODE_DISCLOSURE_countermeasure2&#45;&gt;4_4_1_1_AUTH_CODE_DISCLOSURE -->
<g id="edge39" class="edge">
<title>4_4_1_1_AUTH_CODE_DISCLOSURE_countermeasure2&#45;&gt;4_4_1_1_AUTH_CODE_DISCLOSURE</title>
<path fill="none" stroke="black" d="M1488.57,-4588.41C1431.99,-4580.24 1371.26,-4571.38 1315.07,-4563 1270.99,-4556.43 1223.99,-4549.3 1178.77,-4542.37"/>
<polygon fill="black" stroke="black" points="1179.27,-4538.9 1168.85,-4540.85 1178.21,-4545.82 1179.27,-4538.9"/>
<text text-anchor="middle" x="1260.57" y="-4563.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_1_AUTH_CODE_DISCLOSURE_countermeasure3 -->
<g id="node39" class="node">
<title>4_4_1_1_AUTH_CODE_DISCLOSURE_countermeasure3</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1986.07,-4554 1436.07,-4554 1436.07,-4458 1986.07,-4458 1986.07,-4554"/>
<text text-anchor="start" x="1446.07" y="-4539.4" font-family="Arial" font-weight="bold" font-size="12.00"> Limit Number of Usages or One&#45;Time Usage (5_1_5_4_ONE_TIME_USE_TOKEN) </text>
<text text-anchor="start" x="1469.07" y="-4515.4" font-family="Arial" font-size="12.00"> The authorization server may restrict the number of requests or operations that</text>
<text text-anchor="start" x="1470.07" y="-4503.4" font-family="Arial" font-size="12.00">can be performed with a certain token. This mechanism can be used to mitigate</text>
<text text-anchor="start" x="1511.07" y="-4491.4" font-family="Arial" font-size="12.00">the following threats: &lt;br/&gt;o replay of tokens &lt;br/&gt;o guessing For</text>
<text text-anchor="start" x="1462.57" y="-4479.4" font-family="Arial" font-size="12.00">example, if an authorization server observes more than one attempt to redeem an</text>
<text text-anchor="start" x="1689.07" y="-4467.4" font-family="Arial" font-size="12.00">aut[...] </text>
</g>
<!-- 4_4_1_1_AUTH_CODE_DISCLOSURE_countermeasure3&#45;&gt;4_4_1_1_AUTH_CODE_DISCLOSURE -->
<g id="edge40" class="edge">
<title>4_4_1_1_AUTH_CODE_DISCLOSURE_countermeasure3&#45;&gt;4_4_1_1_AUTH_CODE_DISCLOSURE</title>
<path fill="none" stroke="black" d="M1435.87,-4506C1351.84,-4506 1260.2,-4506 1179.07,-4506"/>
<polygon fill="black" stroke="black" points="1178.72,-4502.5 1168.72,-4506 1178.72,-4509.5 1178.72,-4502.5"/>
<text text-anchor="middle" x="1260.57" y="-4509.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_1_AUTH_CODE_DISCLOSURE_countermeasure4 -->
<g id="node40" class="node">
<title>4_4_1_1_AUTH_CODE_DISCLOSURE_countermeasure4</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="2059.07,-4440 1363.07,-4440 1363.07,-4368 2059.07,-4368 2059.07,-4440"/>
<text text-anchor="start" x="1373.07" y="-4425.4" font-family="Arial" font-weight="bold" font-size="12.00"> Automatic Revocation of Derived Tokens If Abuse Is Detected (5_2_1_1_TOKEN_ABUSE_DETECTION) </text>
<text text-anchor="start" x="1466.07" y="-4401.4" font-family="Arial" font-size="12.00"> If an authorization server observes multiple attempts to redeem an authorization</text>
<text text-anchor="start" x="1523.57" y="-4389.4" font-family="Arial" font-size="12.00">grant (e.g., such as an authorization &quot;code&quot;), the authorization</text>
<text text-anchor="start" x="1472.07" y="-4377.4" font-family="Arial" font-size="12.00">server may want to revoke all tokens granted based on the authorization grant </text>
</g>
<!-- 4_4_1_1_AUTH_CODE_DISCLOSURE_countermeasure4&#45;&gt;4_4_1_1_AUTH_CODE_DISCLOSURE -->
<g id="edge41" class="edge">
<title>4_4_1_1_AUTH_CODE_DISCLOSURE_countermeasure4&#45;&gt;4_4_1_1_AUTH_CODE_DISCLOSURE</title>
<path fill="none" stroke="black" d="M1384.99,-4440.01C1361.32,-4442.94 1337.82,-4445.96 1315.07,-4449 1270.9,-4454.91 1223.85,-4461.74 1178.62,-4468.57"/>
<polygon fill="black" stroke="black" points="1178.06,-4465.11 1168.7,-4470.07 1179.11,-4472.03 1178.06,-4465.11"/>
<text text-anchor="middle" x="1260.57" y="-4463.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_1_AUTH_CODE_DISCLOSURE_countermeasure5 -->
<g id="node41" class="node">
<title>4_4_1_1_AUTH_CODE_DISCLOSURE_countermeasure5</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1947.07,-4350 1475.07,-4350 1475.07,-4290 1947.07,-4290 1947.07,-4350"/>
<text text-anchor="start" x="1526.57" y="-4335.4" font-family="Arial" font-weight="bold" font-size="12.00"> Reload the target page (USER_AGENT_PAGE_RELOAD) </text>
<text text-anchor="start" x="1485.07" y="-4311.4" font-family="Arial" font-size="12.00"> The client server may reload the target page of the redirect URI in order to</text>
<text text-anchor="start" x="1581.57" y="-4299.4" font-family="Arial" font-size="12.00">automatically clean up the browser cache. </text>
</g>
<!-- 4_4_1_1_AUTH_CODE_DISCLOSURE_countermeasure5&#45;&gt;4_4_1_1_AUTH_CODE_DISCLOSURE -->
<g id="edge42" class="edge">
<title>4_4_1_1_AUTH_CODE_DISCLOSURE_countermeasure5&#45;&gt;4_4_1_1_AUTH_CODE_DISCLOSURE</title>
<path fill="none" stroke="black" d="M1474.85,-4332.35C1421.82,-4338.14 1366.13,-4346.61 1315.07,-4359 1223.01,-4381.34 1123.46,-4421.82 1050.76,-4454.66"/>
<polygon fill="black" stroke="black" points="1049.24,-4451.5 1041.58,-4458.83 1052.13,-4457.88 1049.24,-4451.5"/>
<text text-anchor="middle" x="1260.57" y="-4386.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_2_AUTH_CODE_DISCLOSURE_DB -->
<g id="node42" class="node">
<title>4_4_1_2_AUTH_CODE_DISCLOSURE_DB</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1167.07,-4141.5 720.07,-4141.5 720.07,-4060.5 1167.07,-4060.5 1167.07,-4141.5"/>
<text text-anchor="start" x="787.07" y="-4126.4" font-family="Arial" font-weight="bold" font-size="12.00">4_4_1_2_AUTH_CODE_DISCLOSURE_DB ATTACK</text>
<text text-anchor="start" x="1097.07" y="-4126.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="730.57" y="-4108.4" font-family="Arial" font-size="12.00">This threat is applicable if the authorization server stores &#160;authorization</text>
<text text-anchor="start" x="768.57" y="-4095.4" font-family="Arial" font-size="12.00">&quot;codes&quot; as handles in a database. An attacker may &#160;obtain</text>
<text text-anchor="start" x="744.07" y="-4082.4" font-family="Arial" font-size="12.00">authorization &quot;codes&quot; from the authorization server’s database &#160;by</text>
<text text-anchor="start" x="741.07" y="-4069.4" font-family="Arial" font-size="12.00">gaining access to the database or launching a SQL injection &#160;attack.</text>
</g>
<!-- 4_4_1_2_AUTH_CODE_DISCLOSURE_DB&#45;&gt;CONFIDENTIALITY -->
<g id="edge47" class="edge">
<title>4_4_1_2_AUTH_CODE_DISCLOSURE_DB&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M910.88,-4060.47C860.56,-3995.63 760,-3864.04 681.07,-3748 531.98,-3528.81 368.95,-3254.44 313.09,-3159.33"/>
<polygon fill="black" stroke="black" points="316.1,-3157.54 308.03,-3150.69 310.07,-3161.09 316.1,-3157.54"/>
<text text-anchor="middle" x="632.57" y="-3718.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_4_1_2_AUTH_CODE_DISCLOSURE_DB_countermeasure0 -->
<g id="node43" class="node">
<title>4_4_1_2_AUTH_CODE_DISCLOSURE_DB_countermeasure0</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1951.07,-4272 1471.07,-4272 1471.07,-4212 1951.07,-4212 1951.07,-4272"/>
<text text-anchor="start" x="1492.57" y="-4257.4" font-family="Arial" font-weight="bold" font-size="12.00"> Enforce Standard System Security Means (5_1_4_1_1_SYS_SEC) </text>
<text text-anchor="start" x="1481.07" y="-4233.4" font-family="Arial" font-size="12.00"> A server system may be locked down so that no attacker may get access to</text>
<text text-anchor="start" x="1580.07" y="-4221.4" font-family="Arial" font-size="12.00">sensitive configuration files and databases. </text>
</g>
<!-- 4_4_1_2_AUTH_CODE_DISCLOSURE_DB_countermeasure0&#45;&gt;4_4_1_2_AUTH_CODE_DISCLOSURE_DB -->
<g id="edge44" class="edge">
<title>4_4_1_2_AUTH_CODE_DISCLOSURE_DB_countermeasure0&#45;&gt;4_4_1_2_AUTH_CODE_DISCLOSURE_DB</title>
<path fill="none" stroke="black" d="M1471.03,-4225C1419.36,-4219.49 1365.21,-4212.31 1315.07,-4203 1236.45,-4188.41 1150.23,-4165.12 1080.76,-4144.48"/>
<polygon fill="black" stroke="black" points="1081.65,-4141.09 1071.07,-4141.58 1079.65,-4147.8 1081.65,-4141.09"/>
<text text-anchor="middle" x="1260.57" y="-4202.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_2_AUTH_CODE_DISCLOSURE_DB_countermeasure1 -->
<g id="node44" class="node">
<title>4_4_1_2_AUTH_CODE_DISCLOSURE_DB_countermeasure1</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1967.07,-4194 1455.07,-4194 1455.07,-4098 1967.07,-4098 1967.07,-4194"/>
<text text-anchor="start" x="1465.07" y="-4179.4" font-family="Arial" font-weight="bold" font-size="12.00"> Enforce Standard SQL Injection Countermeasures (5_1_4_1_2_SQL_SEC) </text>
<text text-anchor="start" x="1473.57" y="-4155.4" font-family="Arial" font-size="12.00"> If a client identifier or other authentication component is queried or compared</text>
<text text-anchor="start" x="1471.07" y="-4143.4" font-family="Arial" font-size="12.00">against a SQL database, it may become possible for an injection attack to occur</text>
<text text-anchor="start" x="1482.57" y="-4131.4" font-family="Arial" font-size="12.00">if parameters received are not validated before submission to the database.</text>
<text text-anchor="start" x="1489.57" y="-4119.4" font-family="Arial" font-size="12.00">&lt;br/&gt;o Ensure that server code is using the minimum database privileges</text>
<text text-anchor="start" x="1698.57" y="-4107.4" font-family="Arial" font-size="12.00">[...] </text>
</g>
<!-- 4_4_1_2_AUTH_CODE_DISCLOSURE_DB_countermeasure1&#45;&gt;4_4_1_2_AUTH_CODE_DISCLOSURE_DB -->
<g id="edge45" class="edge">
<title>4_4_1_2_AUTH_CODE_DISCLOSURE_DB_countermeasure1&#45;&gt;4_4_1_2_AUTH_CODE_DISCLOSURE_DB</title>
<path fill="none" stroke="black" d="M1454.9,-4131C1365.19,-4125.73 1264.92,-4119.83 1177.17,-4114.67"/>
<polygon fill="black" stroke="black" points="1177.27,-4111.17 1167.08,-4114.08 1176.86,-4118.16 1177.27,-4111.17"/>
<text text-anchor="middle" x="1260.57" y="-4123.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_2_AUTH_CODE_DISCLOSURE_DB_countermeasure2 -->
<g id="node45" class="node">
<title>4_4_1_2_AUTH_CODE_DISCLOSURE_DB_countermeasure2</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="2009.07,-4080 1413.07,-4080 1413.07,-4032 2009.07,-4032 2009.07,-4080"/>
<text text-anchor="start" x="1423.07" y="-4065.4" font-family="Arial" font-weight="bold" font-size="12.00"> Store access token hashes only (Section 5.1.4.1.3). (5_1_4_1_3_HASHED_TOKEN_DB) </text>
<text text-anchor="start" x="1554.57" y="-4041.4" font-family="Arial" font-size="12.00"> Store access token hashes only (Section 5.1.4.1.3). </text>
</g>
<!-- 4_4_1_2_AUTH_CODE_DISCLOSURE_DB_countermeasure2&#45;&gt;4_4_1_2_AUTH_CODE_DISCLOSURE_DB -->
<g id="edge46" class="edge">
<title>4_4_1_2_AUTH_CODE_DISCLOSURE_DB_countermeasure2&#45;&gt;4_4_1_2_AUTH_CODE_DISCLOSURE_DB</title>
<path fill="none" stroke="black" d="M1413.01,-4073.46C1334.94,-4078.05 1251.86,-4082.94 1177.68,-4087.3"/>
<polygon fill="black" stroke="black" points="1177.05,-4083.83 1167.27,-4087.91 1177.46,-4090.82 1177.05,-4083.83"/>
<text text-anchor="middle" x="1260.57" y="-4086.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_3_AUTH_CODE_BRUTE_FORCE -->
<g id="node46" class="node">
<title>4_4_1_3_AUTH_CODE_BRUTE_FORCE</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1158.07,-3739 729.07,-3739 729.07,-3671 1158.07,-3671 1158.07,-3739"/>
<text text-anchor="start" x="794.57" y="-3724.4" font-family="Arial" font-weight="bold" font-size="12.00">4_4_1_3_AUTH_CODE_BRUTE_FORCE ATTACK</text>
<text text-anchor="start" x="1089.57" y="-3724.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="744.07" y="-3706.4" font-family="Arial" font-size="12.00">An attacker may try to guess valid authorization &quot;code&quot; values and</text>
<text text-anchor="start" x="739.57" y="-3693.4" font-family="Arial" font-size="12.00">send the guessed code value using the grant type &quot;code&quot; in order to</text>
<text text-anchor="start" x="861.07" y="-3680.4" font-family="Arial" font-size="12.00">obtain a valid access token.</text>
</g>
<!-- 4_4_1_3_AUTH_CODE_BRUTE_FORCE&#45;&gt;CONFIDENTIALITY -->
<g id="edge53" class="edge">
<title>4_4_1_3_AUTH_CODE_BRUTE_FORCE&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M904.36,-3670.88C788.58,-3567.49 442.59,-3258.55 329.35,-3157.43"/>
<polygon fill="black" stroke="black" points="331.4,-3154.56 321.61,-3150.51 326.74,-3159.79 331.4,-3154.56"/>
<text text-anchor="middle" x="632.57" y="-3452.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_4_1_3_AUTH_CODE_BRUTE_FORCE_countermeasure0 -->
<g id="node47" class="node">
<title>4_4_1_3_AUTH_CODE_BRUTE_FORCE_countermeasure0</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1958.07,-4014 1464.07,-4014 1464.07,-3918 1958.07,-3918 1958.07,-4014"/>
<text text-anchor="start" x="1479.57" y="-3999.4" font-family="Arial" font-weight="bold" font-size="12.00"> Use High Entropy for Secrets (5_1_4_2_2_HIGH_ENTROPY_SECRETS) </text>
<text text-anchor="start" x="1487.07" y="-3975.4" font-family="Arial" font-size="12.00"> When creating secrets not intended for usage by human users (e.g., client</text>
<text text-anchor="start" x="1474.07" y="-3963.4" font-family="Arial" font-size="12.00">secrets or token handles), the authorization server should include a reasonable</text>
<text text-anchor="start" x="1487.07" y="-3951.4" font-family="Arial" font-size="12.00">level of entropy in order to mitigate the risk of guessing attacks. The token</text>
<text text-anchor="start" x="1488.07" y="-3939.4" font-family="Arial" font-size="12.00">value should be &gt;=128 bits long and constructed from a cryptographically</text>
<text text-anchor="start" x="1691.07" y="-3927.4" font-family="Arial" font-size="12.00">str[...] </text>
</g>
<!-- 4_4_1_3_AUTH_CODE_BRUTE_FORCE_countermeasure0&#45;&gt;4_4_1_3_AUTH_CODE_BRUTE_FORCE -->
<g id="edge48" class="edge">
<title>4_4_1_3_AUTH_CODE_BRUTE_FORCE_countermeasure0&#45;&gt;4_4_1_3_AUTH_CODE_BRUTE_FORCE</title>
<path fill="none" stroke="black" d="M1464.02,-3944.47C1413.95,-3936.21 1362.21,-3924.79 1315.07,-3909 1196.56,-3869.29 1071.84,-3792.2 1001.57,-3744.99"/>
<polygon fill="black" stroke="black" points="1003.1,-3741.8 992.86,-3739.1 999.18,-3747.6 1003.1,-3741.8"/>
<text text-anchor="middle" x="1260.57" y="-3904.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_3_AUTH_CODE_BRUTE_FORCE_countermeasure1 -->
<g id="node48" class="node">
<title>4_4_1_3_AUTH_CODE_BRUTE_FORCE_countermeasure1</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1967.57,-3900 1454.57,-3900 1454.57,-3828 1967.57,-3828 1967.57,-3900"/>
<text text-anchor="start" x="1527.07" y="-3885.4" font-family="Arial" font-weight="bold" font-size="12.00"> Sign Self&#45;Contained Tokens (5_1_5_9_SIGNED_TOKEN) </text>
<text text-anchor="start" x="1470.07" y="-3861.4" font-family="Arial" font-size="12.00"> Self&#45;contained tokens should be signed in order to detect any attempt to modify</text>
<text text-anchor="start" x="1465.07" y="-3849.4" font-family="Arial" font-size="12.00">or produce faked tokens (e.g., Hash&#45;based Message Authentication Code or digital</text>
<text text-anchor="start" x="1674.57" y="-3837.4" font-family="Arial" font-size="12.00">signatures). </text>
</g>
<!-- 4_4_1_3_AUTH_CODE_BRUTE_FORCE_countermeasure1&#45;&gt;4_4_1_3_AUTH_CODE_BRUTE_FORCE -->
<g id="edge49" class="edge">
<title>4_4_1_3_AUTH_CODE_BRUTE_FORCE_countermeasure1&#45;&gt;4_4_1_3_AUTH_CODE_BRUTE_FORCE</title>
<path fill="none" stroke="black" d="M1454.51,-3841.89C1407.88,-3835.88 1359.83,-3828.35 1315.07,-3819 1223.18,-3799.8 1121.43,-3767.68 1047.85,-3742.42"/>
<polygon fill="black" stroke="black" points="1048.7,-3739.01 1038.11,-3739.06 1046.42,-3745.63 1048.7,-3739.01"/>
<text text-anchor="middle" x="1260.57" y="-3817.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_3_AUTH_CODE_BRUTE_FORCE_countermeasure2 -->
<g id="node49" class="node">
<title>4_4_1_3_AUTH_CODE_BRUTE_FORCE_countermeasure2</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="1989.57,-3810 1432.57,-3810 1432.57,-3714 1989.57,-3714 1989.57,-3810"/>
<text text-anchor="start" x="1443.07" y="-3795.4" font-family="Arial" font-weight="bold" font-size="12.00"> Issue Installation&#45;Specific Client Secrets (5_2_3_4_SPECIFIC_CLIENT_SECRETS) </text>
<text text-anchor="start" x="1472.07" y="-3771.4" font-family="Arial" font-size="12.00"> An authorization server may issue separate client identifiers and corresponding</text>
<text text-anchor="start" x="1501.57" y="-3759.4" font-family="Arial" font-size="12.00">secrets to the different installations of a particular client (i.e., software</text>
<text text-anchor="start" x="1502.57" y="-3747.4" font-family="Arial" font-size="12.00">package). &#160;The effect of such an approach would be to turn otherwise</text>
<text text-anchor="start" x="1547.57" y="-3735.4" font-family="Arial" font-size="12.00">&quot;public&quot; clients back into &quot;confidential&quot; clients. For web</text>
<text text-anchor="start" x="1640.57" y="-3723.4" font-family="Arial" font-size="12.00">applications, this co[...] </text>
</g>
<!-- 4_4_1_3_AUTH_CODE_BRUTE_FORCE_countermeasure2&#45;&gt;4_4_1_3_AUTH_CODE_BRUTE_FORCE -->
<g id="edge50" class="edge">
<title>4_4_1_3_AUTH_CODE_BRUTE_FORCE_countermeasure2&#45;&gt;4_4_1_3_AUTH_CODE_BRUTE_FORCE</title>
<path fill="none" stroke="black" d="M1432.35,-3741.32C1345.52,-3734.85 1250.86,-3727.81 1168.23,-3721.65"/>
<polygon fill="black" stroke="black" points="1168.45,-3718.16 1158.22,-3720.91 1167.93,-3725.14 1168.45,-3718.16"/>
<text text-anchor="middle" x="1260.57" y="-3733.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_3_AUTH_CODE_BRUTE_FORCE_countermeasure3 -->
<g id="node50" class="node">
<title>4_4_1_3_AUTH_CODE_BRUTE_FORCE_countermeasure3</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="2009.57,-3696 1412.57,-3696 1412.57,-3600 2009.57,-3600 2009.57,-3696"/>
<text text-anchor="start" x="1423.07" y="-3681.4" font-family="Arial" font-weight="bold" font-size="12.00"> Binding of Authorization &quot;code&quot; to &quot;redirect_uri&quot; (5_2_4_5_REDIRECT_CODE_BINDING) </text>
<text text-anchor="start" x="1508.07" y="-3657.4" font-family="Arial" font-size="12.00"> The authorization server should be able to bind every authorization</text>
<text text-anchor="start" x="1514.07" y="-3645.4" font-family="Arial" font-size="12.00">&quot;code&quot; to the actual redirect URI used as the redirect target of the</text>
<text text-anchor="start" x="1482.57" y="-3633.4" font-family="Arial" font-size="12.00">client in the end&#45;user authorization process. This binding should be validated</text>
<text text-anchor="start" x="1512.07" y="-3621.4" font-family="Arial" font-size="12.00">when the client attempts to exchange the respective authorization</text>
<text text-anchor="start" x="1618.57" y="-3609.4" font-family="Arial" font-size="12.00">&quot;code&quot; for an access token[...] </text>
</g>
<!-- 4_4_1_3_AUTH_CODE_BRUTE_FORCE_countermeasure3&#45;&gt;4_4_1_3_AUTH_CODE_BRUTE_FORCE -->
<g id="edge51" class="edge">
<title>4_4_1_3_AUTH_CODE_BRUTE_FORCE_countermeasure3&#45;&gt;4_4_1_3_AUTH_CODE_BRUTE_FORCE</title>
<path fill="none" stroke="black" d="M1412.46,-3670.16C1331.26,-3676.21 1244.68,-3682.65 1168.35,-3688.34"/>
<polygon fill="black" stroke="black" points="1167.84,-3684.87 1158.13,-3689.1 1168.36,-3691.85 1167.84,-3684.87"/>
<text text-anchor="middle" x="1260.57" y="-3686.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_3_AUTH_CODE_BRUTE_FORCE_countermeasure4 -->
<g id="node51" class="node">
<title>4_4_1_3_AUTH_CODE_BRUTE_FORCE_countermeasure4</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1933.57,-3582 1488.57,-3582 1488.57,-3486 1933.57,-3486 1933.57,-3582"/>
<text text-anchor="start" x="1510.07" y="-3567.4" font-family="Arial" font-weight="bold" font-size="12.00"> Use Short Expiration Time (5_1_5_3_SHORT_EXPIRY_CODE) </text>
<text text-anchor="start" x="1499.07" y="-3543.4" font-family="Arial" font-size="12.00"> A short expiration time for tokens is a means of protection against the</text>
<text text-anchor="start" x="1534.07" y="-3531.4" font-family="Arial" font-size="12.00">following threats: &lt;br/&gt;o replay &lt;br/&gt;o token leak (a short</text>
<text text-anchor="start" x="1510.57" y="-3519.4" font-family="Arial" font-size="12.00">expiration time will reduce impact) &lt;br/&gt;o online guessing (a short</text>
<text text-anchor="start" x="1500.57" y="-3507.4" font-family="Arial" font-size="12.00">expiration time will reduce the likelihood of success) Note: Short token</text>
<text text-anchor="start" x="1593.57" y="-3495.4" font-family="Arial" font-size="12.00">duration requires more precise cloc[...] </text>
</g>
<!-- 4_4_1_3_AUTH_CODE_BRUTE_FORCE_countermeasure4&#45;&gt;4_4_1_3_AUTH_CODE_BRUTE_FORCE -->
<g id="edge52" class="edge">
<title>4_4_1_3_AUTH_CODE_BRUTE_FORCE_countermeasure4&#45;&gt;4_4_1_3_AUTH_CODE_BRUTE_FORCE</title>
<path fill="none" stroke="black" d="M1488.55,-3559.8C1431.69,-3568.1 1370.84,-3578.48 1315.07,-3591 1224.42,-3611.36 1123.8,-3642.91 1050.32,-3667.66"/>
<polygon fill="black" stroke="black" points="1048.94,-3664.44 1040.59,-3670.96 1051.18,-3671.07 1048.94,-3664.44"/>
<text text-anchor="middle" x="1260.57" y="-3614.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_4_CLIENT_SPOOFING1 -->
<g id="node52" class="node">
<title>4_4_1_4_CLIENT_SPOOFING1</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1185.07,-3165.5 702.07,-3165.5 702.07,-3084.5 1185.07,-3084.5 1185.07,-3165.5"/>
<text text-anchor="start" x="819.07" y="-3150.4" font-family="Arial" font-weight="bold" font-size="12.00">4_4_1_4_CLIENT_SPOOFING1 ATTACK</text>
<text text-anchor="start" x="1065.07" y="-3150.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="726.57" y="-3132.4" font-family="Arial" font-size="12.00">A malicious client could pretend to be a valid client and obtain an access</text>
<text text-anchor="start" x="731.07" y="-3119.4" font-family="Arial" font-size="12.00">authorization in this way. The malicious client could even utilize screen&#45;</text>
<text text-anchor="start" x="712.57" y="-3106.4" font-family="Arial" font-size="12.00">scraping techniques in order to simulate a user’s consent in the authorization</text>
<text text-anchor="start" x="930.07" y="-3093.4" font-family="Arial" font-size="12.00">flow.</text>
</g>
<!-- 4_4_1_4_CLIENT_SPOOFING1&#45;&gt;CONFIDENTIALITY -->
<g id="edge60" class="edge">
<title>4_4_1_4_CLIENT_SPOOFING1&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M701.63,-3125C666.65,-3125 630.28,-3125 594.29,-3125"/>
<polygon fill="black" stroke="black" points="594.15,-3121.5 584.15,-3125 594.15,-3128.5 594.15,-3121.5"/>
<text text-anchor="middle" x="632.57" y="-3128.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_4_1_4_CLIENT_SPOOFING1_countermeasure0 -->
<g id="node53" class="node">
<title>4_4_1_4_CLIENT_SPOOFING1_countermeasure0</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="1989.57,-3468 1432.57,-3468 1432.57,-3372 1989.57,-3372 1989.57,-3468"/>
<text text-anchor="start" x="1443.07" y="-3453.4" font-family="Arial" font-weight="bold" font-size="12.00"> Issue Installation&#45;Specific Client Secrets (5_2_3_4_SPECIFIC_CLIENT_SECRETS) </text>
<text text-anchor="start" x="1472.07" y="-3429.4" font-family="Arial" font-size="12.00"> An authorization server may issue separate client identifiers and corresponding</text>
<text text-anchor="start" x="1501.57" y="-3417.4" font-family="Arial" font-size="12.00">secrets to the different installations of a particular client (i.e., software</text>
<text text-anchor="start" x="1502.57" y="-3405.4" font-family="Arial" font-size="12.00">package). &#160;The effect of such an approach would be to turn otherwise</text>
<text text-anchor="start" x="1547.57" y="-3393.4" font-family="Arial" font-size="12.00">&quot;public&quot; clients back into &quot;confidential&quot; clients. For web</text>
<text text-anchor="start" x="1640.57" y="-3381.4" font-family="Arial" font-size="12.00">applications, this co[...] </text>
</g>
<!-- 4_4_1_4_CLIENT_SPOOFING1_countermeasure0&#45;&gt;4_4_1_4_CLIENT_SPOOFING1 -->
<g id="edge54" class="edge">
<title>4_4_1_4_CLIENT_SPOOFING1_countermeasure0&#45;&gt;4_4_1_4_CLIENT_SPOOFING1</title>
<path fill="none" stroke="black" d="M1432.44,-3395.3C1392.35,-3387.34 1352.15,-3376.84 1315.07,-3363 1193.42,-3317.6 1070.1,-3227.68 1000.88,-3172.3"/>
<polygon fill="black" stroke="black" points="1002.69,-3169.27 992.71,-3165.72 998.3,-3174.72 1002.69,-3169.27"/>
<text text-anchor="middle" x="1260.57" y="-3357.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_4_CLIENT_SPOOFING1_countermeasure1 -->
<g id="node54" class="node">
<title>4_4_1_4_CLIENT_SPOOFING1_countermeasure1</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1972.07,-3354 1450.07,-3354 1450.07,-3258 1972.07,-3258 1972.07,-3354"/>
<text text-anchor="start" x="1460.07" y="-3339.4" font-family="Arial" font-weight="bold" font-size="12.00"> Validate Pre&#45;Registered &quot;redirect_uri&quot; (5_2_3_5_VALIDATE_REDIRECT_URI) </text>
<text text-anchor="start" x="1516.57" y="-3315.4" font-family="Arial" font-size="12.00"> An authorization server should require all clients to register their</text>
<text text-anchor="start" x="1551.07" y="-3303.4" font-family="Arial" font-size="12.00">&quot;redirect_uri&quot;, and the &quot;redirect_uri&quot; should be the full</text>
<text text-anchor="start" x="1476.07" y="-3291.4" font-family="Arial" font-size="12.00">URI as defined in [RFC6749]. &#160;The way that this registration is performed is out</text>
<text text-anchor="start" x="1473.07" y="-3279.4" font-family="Arial" font-size="12.00">of scope of this document. &#160;As per the core spec, every actual redirect URI sent</text>
<text text-anchor="start" x="1642.07" y="-3267.4" font-family="Arial" font-size="12.00">with the respective[...] </text>
</g>
<!-- 4_4_1_4_CLIENT_SPOOFING1_countermeasure1&#45;&gt;4_4_1_4_CLIENT_SPOOFING1 -->
<g id="edge55" class="edge">
<title>4_4_1_4_CLIENT_SPOOFING1_countermeasure1&#45;&gt;4_4_1_4_CLIENT_SPOOFING1</title>
<path fill="none" stroke="black" d="M1449.86,-3275.24C1404.65,-3267.96 1358.3,-3259.26 1315.07,-3249 1227.44,-3228.19 1131.03,-3195.61 1058.53,-3169.06"/>
<polygon fill="black" stroke="black" points="1059.51,-3165.69 1048.91,-3165.52 1057.09,-3172.26 1059.51,-3165.69"/>
<text text-anchor="middle" x="1260.57" y="-3246.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_4_CLIENT_SPOOFING1_countermeasure2 -->
<g id="node55" class="node">
<title>4_4_1_4_CLIENT_SPOOFING1_countermeasure2</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="2035.57,-3240 1386.57,-3240 1386.57,-3156 2035.57,-3156 2035.57,-3240"/>
<text text-anchor="start" x="1397.07" y="-3225.4" font-family="Arial" font-weight="bold" font-size="12.00"> Validation of Client Properties by End User (5_2_4_3_VALIDATION_OF_CLIENT_BY_END_USER) </text>
<text text-anchor="start" x="1483.07" y="-3201.4" font-family="Arial" font-size="12.00"> In the authorization process, the user is typically asked to approve a client’s</text>
<text text-anchor="start" x="1486.57" y="-3189.4" font-family="Arial" font-size="12.00">request for authorization. This is an important security mechanism by itself</text>
<text text-anchor="start" x="1488.07" y="-3177.4" font-family="Arial" font-size="12.00">because the end user can be involved in the validation of client properties,</text>
<text text-anchor="start" x="1475.57" y="-3165.4" font-family="Arial" font-size="12.00">such as whether the client name known to the authorization server fits the[...] </text>
</g>
<!-- 4_4_1_4_CLIENT_SPOOFING1_countermeasure2&#45;&gt;4_4_1_4_CLIENT_SPOOFING1 -->
<g id="edge56" class="edge">
<title>4_4_1_4_CLIENT_SPOOFING1_countermeasure2&#45;&gt;4_4_1_4_CLIENT_SPOOFING1</title>
<path fill="none" stroke="black" d="M1386.54,-3167.15C1322.66,-3161.06 1256.53,-3154.75 1195.5,-3148.93"/>
<polygon fill="black" stroke="black" points="1195.64,-3145.43 1185.35,-3147.96 1194.98,-3152.4 1195.64,-3145.43"/>
<text text-anchor="middle" x="1260.57" y="-3160.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_4_CLIENT_SPOOFING1_countermeasure3 -->
<g id="node56" class="node">
<title>4_4_1_4_CLIENT_SPOOFING1_countermeasure3</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="2107.07,-3138 1315.07,-3138 1315.07,-3042 2107.07,-3042 2107.07,-3138"/>
<text text-anchor="start" x="1325.07" y="-3123.4" font-family="Arial" font-weight="bold" font-size="12.00"> Automatic Processing of Repeated Authorizations Requires Client Validation (5_2_4_1_REPEAT_VALIDATE_CLIENT) </text>
<text text-anchor="start" x="1476.07" y="-3099.4" font-family="Arial" font-size="12.00"> Authorization servers should NOT automatically process repeat authorizations</text>
<text text-anchor="start" x="1487.57" y="-3087.4" font-family="Arial" font-size="12.00">where the client is not authenticated through a client secret or some other</text>
<text text-anchor="start" x="1473.07" y="-3075.4" font-family="Arial" font-size="12.00">authentication mechanism such as a signed authentication assertion certificate</text>
<text text-anchor="start" x="1502.07" y="-3063.4" font-family="Arial" font-size="12.00">(Section 5.2.3.7) or validation of a pre&#45;registered redirect URI (Section</text>
<text text-anchor="start" x="1693.07" y="-3051.4" font-family="Arial" font-size="12.00">5.[...] </text>
</g>
<!-- 4_4_1_4_CLIENT_SPOOFING1_countermeasure3&#45;&gt;4_4_1_4_CLIENT_SPOOFING1 -->
<g id="edge57" class="edge">
<title>4_4_1_4_CLIENT_SPOOFING1_countermeasure3&#45;&gt;4_4_1_4_CLIENT_SPOOFING1</title>
<path fill="none" stroke="black" d="M1314.99,-3108.06C1274.38,-3109.92 1233.96,-3111.77 1195.55,-3113.52"/>
<polygon fill="black" stroke="black" points="1195.14,-3110.04 1185.31,-3113.99 1195.46,-3117.03 1195.14,-3110.04"/>
<text text-anchor="middle" x="1260.57" y="-3114.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_4_CLIENT_SPOOFING1_countermeasure4 -->
<g id="node57" class="node">
<title>4_4_1_4_CLIENT_SPOOFING1_countermeasure4</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="2093.57,-3024 1328.57,-3024 1328.57,-2928 2093.57,-2928 2093.57,-3024"/>
<text text-anchor="start" x="1339.07" y="-3009.4" font-family="Arial" font-weight="bold" font-size="12.00"> Automatic Processing of Repeated Authorizations Requires Client Validation (REQUIRE_USER_MANUAL_STEP) </text>
<text text-anchor="start" x="1484.07" y="-2985.4" font-family="Arial" font-size="12.00"> If the authorization server automatically authenticates the end user, it may</text>
<text text-anchor="start" x="1491.07" y="-2973.4" font-family="Arial" font-size="12.00">nevertheless require some user input in order to prevent screen scraping.</text>
<text text-anchor="start" x="1490.57" y="-2961.4" font-family="Arial" font-size="12.00">Examples are CAPTCHAs (Completely Automated Public Turing tests to tell</text>
<text text-anchor="start" x="1459.07" y="-2949.4" font-family="Arial" font-size="12.00">Computers and Humans Apart) or other multi&#45;factor authentication techniques such</text>
<text text-anchor="start" x="1688.07" y="-2937.4" font-family="Arial" font-size="12.00">as r[...] </text>
</g>
<!-- 4_4_1_4_CLIENT_SPOOFING1_countermeasure4&#45;&gt;4_4_1_4_CLIENT_SPOOFING1 -->
<g id="edge58" class="edge">
<title>4_4_1_4_CLIENT_SPOOFING1_countermeasure4&#45;&gt;4_4_1_4_CLIENT_SPOOFING1</title>
<path fill="none" stroke="black" d="M1363.19,-3024.05C1346.9,-3026.93 1330.79,-3029.92 1315.07,-3033 1245.16,-3046.69 1168.65,-3065.1 1103.39,-3081.86"/>
<polygon fill="black" stroke="black" points="1102.25,-3078.54 1093.44,-3084.42 1103.99,-3085.32 1102.25,-3078.54"/>
<text text-anchor="middle" x="1260.57" y="-3053.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_4_CLIENT_SPOOFING1_countermeasure5 -->
<g id="node58" class="node">
<title>4_4_1_4_CLIENT_SPOOFING1_countermeasure5</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1966.07,-2910 1456.07,-2910 1456.07,-2814 1966.07,-2814 1966.07,-2910"/>
<text text-anchor="start" x="1530.07" y="-2895.4" font-family="Arial" font-weight="bold" font-size="12.00"> Limit Token Scope (5_1_5_1_LIMITED_SCOPE_TOKEN) </text>
<text text-anchor="start" x="1466.07" y="-2871.4" font-family="Arial" font-size="12.00"> The authorization server may decide to reduce or limit the scope associated with</text>
<text text-anchor="start" x="1494.57" y="-2859.4" font-family="Arial" font-size="12.00">a token. The basis of this decision is out of scope; examples are: &lt;br/&gt;o</text>
<text text-anchor="start" x="1506.57" y="-2847.4" font-family="Arial" font-size="12.00">a client&#45;specific policy, e.g., issue only less powerful tokens to public</text>
<text text-anchor="start" x="1516.07" y="-2835.4" font-family="Arial" font-size="12.00">clients, &lt;br/&gt;o a service&#45;specific policy, e.g., it is a very sensitive</text>
<text text-anchor="start" x="1681.07" y="-2823.4" font-family="Arial" font-size="12.00">servic[...] </text>
</g>
<!-- 4_4_1_4_CLIENT_SPOOFING1_countermeasure5&#45;&gt;4_4_1_4_CLIENT_SPOOFING1 -->
<g id="edge59" class="edge">
<title>4_4_1_4_CLIENT_SPOOFING1_countermeasure5&#45;&gt;4_4_1_4_CLIENT_SPOOFING1</title>
<path fill="none" stroke="black" d="M1455.84,-2884.75C1408.33,-2892.9 1359.63,-2903.97 1315.07,-2919 1201.15,-2957.43 1081.75,-3030.7 1010.26,-3078.69"/>
<polygon fill="black" stroke="black" points="1008.11,-3075.92 1001.78,-3084.42 1012.02,-3081.72 1008.11,-3075.92"/>
<text text-anchor="middle" x="1260.57" y="-2956.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_5_CLIENT_SPOOFING2 -->
<g id="node59" class="node">
<title>4_4_1_5_CLIENT_SPOOFING2</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1167.57,-2788.5 719.57,-2788.5 719.57,-2707.5 1167.57,-2707.5 1167.57,-2788.5"/>
<text text-anchor="start" x="818.57" y="-2773.4" font-family="Arial" font-weight="bold" font-size="12.00">4_4_1_5_CLIENT_SPOOFING2 ATTACK</text>
<text text-anchor="start" x="1064.57" y="-2773.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="734.07" y="-2755.4" font-family="Arial" font-size="12.00">A hostile party could impersonate the client site and get access to the</text>
<text text-anchor="start" x="755.57" y="-2742.4" font-family="Arial" font-size="12.00">authorization &quot;code&quot;. This could be achieved using DNS or ARP</text>
<text text-anchor="start" x="736.07" y="-2729.4" font-family="Arial" font-size="12.00">spoofing. This applies to clients, which are web applications; thus, the</text>
<text text-anchor="start" x="729.57" y="-2716.4" font-family="Arial" font-size="12.00">redirect URI is not local to the host where the user’s browser is running.</text>
</g>
<!-- 4_4_1_5_CLIENT_SPOOFING2&#45;&gt;CONFIDENTIALITY -->
<g id="edge63" class="edge">
<title>4_4_1_5_CLIENT_SPOOFING2&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M872.75,-2788.52C741.66,-2864.61 461.47,-3027.24 345.24,-3094.7"/>
<polygon fill="black" stroke="black" points="343.38,-3091.73 336.49,-3099.78 346.9,-3097.78 343.38,-3091.73"/>
<text text-anchor="middle" x="632.57" y="-2939.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_4_1_5_CLIENT_SPOOFING2_countermeasure0 -->
<g id="node60" class="node">
<title>4_4_1_5_CLIENT_SPOOFING2_countermeasure0</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="1973.57,-2796 1448.57,-2796 1448.57,-2700 1973.57,-2700 1973.57,-2796"/>
<text text-anchor="start" x="1459.07" y="-2781.4" font-family="Arial" font-weight="bold" font-size="12.00"> TLS for the authorization server (5_1_2_AUTH_SERVER_AUTHENTICATION) </text>
<text text-anchor="start" x="1478.57" y="-2757.4" font-family="Arial" font-size="12.00"> Authorization servers should consider such attacks when developing services</text>
<text text-anchor="start" x="1477.07" y="-2745.4" font-family="Arial" font-size="12.00">based on OAuth and should require the use of transport&#45; layer security for any</text>
<text text-anchor="start" x="1494.57" y="-2733.4" font-family="Arial" font-size="12.00">requests where the authenticity of the authorization server or of request</text>
<text text-anchor="start" x="1493.57" y="-2721.4" font-family="Arial" font-size="12.00">responses is an issue (see Section 5.1.2). HTTPS server authentication or</text>
<text text-anchor="start" x="1687.07" y="-2709.4" font-family="Arial" font-size="12.00">simi[...] </text>
</g>
<!-- 4_4_1_5_CLIENT_SPOOFING2_countermeasure0&#45;&gt;4_4_1_5_CLIENT_SPOOFING2 -->
<g id="edge61" class="edge">
<title>4_4_1_5_CLIENT_SPOOFING2_countermeasure0&#45;&gt;4_4_1_5_CLIENT_SPOOFING2</title>
<path fill="none" stroke="black" d="M1448.5,-2748C1360.71,-2748 1263.44,-2748 1177.96,-2748"/>
<polygon fill="black" stroke="black" points="1177.86,-2744.5 1167.86,-2748 1177.86,-2751.5 1177.86,-2744.5"/>
<text text-anchor="middle" x="1260.57" y="-2751.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_5_CLIENT_SPOOFING2_countermeasure1 -->
<g id="node61" class="node">
<title>4_4_1_5_CLIENT_SPOOFING2_countermeasure1</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="2001.57,-2682 1420.57,-2682 1420.57,-2586 2001.57,-2586 2001.57,-2682"/>
<text text-anchor="start" x="1431.07" y="-2667.4" font-family="Arial" font-weight="bold" font-size="12.00"> Binding of Authorization &quot;code&quot; to &quot;client_id&quot; (5_2_4_4_CLIENT_TO_CODE_BINDING) </text>
<text text-anchor="start" x="1498.57" y="-2643.4" font-family="Arial" font-size="12.00"> The authorization server should bind every authorization &quot;code&quot; to the</text>
<text text-anchor="start" x="1488.07" y="-2631.4" font-family="Arial" font-size="12.00">id of the respective client that initiated the end&#45;user authorization process.</text>
<text text-anchor="start" x="1488.07" y="-2619.4" font-family="Arial" font-size="12.00">This measure is a countermeasure against: &lt;br/&gt;o Replay of authorization</text>
<text text-anchor="start" x="1516.57" y="-2607.4" font-family="Arial" font-size="12.00">&quot;codes&quot; with different client credentials, since an attacker cannot</text>
<text text-anchor="start" x="1648.57" y="-2595.4" font-family="Arial" font-size="12.00">use another &quot;clie[...] </text>
</g>
<!-- 4_4_1_5_CLIENT_SPOOFING2_countermeasure1&#45;&gt;4_4_1_5_CLIENT_SPOOFING2 -->
<g id="edge62" class="edge">
<title>4_4_1_5_CLIENT_SPOOFING2_countermeasure1&#45;&gt;4_4_1_5_CLIENT_SPOOFING2</title>
<path fill="none" stroke="black" d="M1420.41,-2675.48C1384.92,-2680.66 1349.16,-2685.92 1315.07,-2691 1270.69,-2697.62 1223.35,-2704.8 1177.85,-2711.77"/>
<polygon fill="black" stroke="black" points="1177.22,-2708.33 1167.87,-2713.3 1178.28,-2715.25 1177.22,-2708.33"/>
<text text-anchor="middle" x="1260.57" y="-2706.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_6_CLIENT_SPOOFING3 -->
<g id="node62" class="node">
<title>4_4_1_6_CLIENT_SPOOFING3</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1185.07,-2624.5 702.07,-2624.5 702.07,-2543.5 1185.07,-2543.5 1185.07,-2624.5"/>
<text text-anchor="start" x="819.07" y="-2609.4" font-family="Arial" font-weight="bold" font-size="12.00">4_4_1_6_CLIENT_SPOOFING3 ATTACK</text>
<text text-anchor="start" x="1065.07" y="-2609.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="716.57" y="-2591.4" font-family="Arial" font-size="12.00">A hostile party could impersonate the client site and impersonate the user’s</text>
<text text-anchor="start" x="712.57" y="-2578.4" font-family="Arial" font-size="12.00">session on this client. This could be achieved using DNS or ARP spoofing. This</text>
<text text-anchor="start" x="724.57" y="-2565.4" font-family="Arial" font-size="12.00">applies to clients, which are web applications; thus, the redirect URI is not</text>
<text text-anchor="start" x="785.07" y="-2552.4" font-family="Arial" font-size="12.00">local to the host where the user’s browser is running.</text>
</g>
<!-- 4_4_1_6_CLIENT_SPOOFING3&#45;&gt;CONFIDENTIALITY -->
<g id="edge65" class="edge">
<title>4_4_1_6_CLIENT_SPOOFING3&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M780.54,-2624.57C742.45,-2641.56 705.79,-2665.47 681.07,-2699 639.39,-2755.53 700.61,-2796.64 663.07,-2856 646,-2883 628.44,-2875.98 602.07,-2894 503.24,-2961.54 391.79,-3047.36 333.51,-3093.02"/>
<polygon fill="black" stroke="black" points="331.01,-3090.53 325.3,-3099.46 335.33,-3096.04 331.01,-3090.53"/>
<text text-anchor="middle" x="632.57" y="-2897.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_4_1_6_CLIENT_SPOOFING3_countermeasure0 -->
<g id="node63" class="node">
<title>4_4_1_6_CLIENT_SPOOFING3_countermeasure0</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="1973.57,-2568 1448.57,-2568 1448.57,-2472 1973.57,-2472 1973.57,-2568"/>
<text text-anchor="start" x="1459.07" y="-2553.4" font-family="Arial" font-weight="bold" font-size="12.00"> TLS for the authorization server (5_1_2_AUTH_SERVER_AUTHENTICATION) </text>
<text text-anchor="start" x="1478.57" y="-2529.4" font-family="Arial" font-size="12.00"> Authorization servers should consider such attacks when developing services</text>
<text text-anchor="start" x="1477.07" y="-2517.4" font-family="Arial" font-size="12.00">based on OAuth and should require the use of transport&#45; layer security for any</text>
<text text-anchor="start" x="1494.57" y="-2505.4" font-family="Arial" font-size="12.00">requests where the authenticity of the authorization server or of request</text>
<text text-anchor="start" x="1493.57" y="-2493.4" font-family="Arial" font-size="12.00">responses is an issue (see Section 5.1.2). HTTPS server authentication or</text>
<text text-anchor="start" x="1687.07" y="-2481.4" font-family="Arial" font-size="12.00">simi[...] </text>
</g>
<!-- 4_4_1_6_CLIENT_SPOOFING3_countermeasure0&#45;&gt;4_4_1_6_CLIENT_SPOOFING3 -->
<g id="edge64" class="edge">
<title>4_4_1_6_CLIENT_SPOOFING3_countermeasure0&#45;&gt;4_4_1_6_CLIENT_SPOOFING3</title>
<path fill="none" stroke="black" d="M1448.5,-2541.87C1366.69,-2548.71 1276.64,-2556.24 1195.58,-2563.01"/>
<polygon fill="black" stroke="black" points="1194.9,-2559.56 1185.23,-2563.88 1195.48,-2566.53 1194.9,-2559.56"/>
<text text-anchor="middle" x="1260.57" y="-2562.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_7_CLIENT_SPOOFING4 -->
<g id="node64" class="node">
<title>4_4_1_7_CLIENT_SPOOFING4</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1172.07,-2339 715.07,-2339 715.07,-2245 1172.07,-2245 1172.07,-2339"/>
<text text-anchor="start" x="819.07" y="-2324.4" font-family="Arial" font-weight="bold" font-size="12.00">4_4_1_7_CLIENT_SPOOFING4 ATTACK</text>
<text text-anchor="start" x="1065.07" y="-2324.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="750.07" y="-2306.4" font-family="Arial" font-size="12.00">The attacker leverages the authorization &quot;code&quot; grant type in an</text>
<text text-anchor="start" x="725.57" y="-2293.4" font-family="Arial" font-size="12.00">attempt to get another user (victim) to log in, authorize access to his/her</text>
<text text-anchor="start" x="732.07" y="-2280.4" font-family="Arial" font-size="12.00">resources, and subsequently obtain the authorization &quot;code&quot; and inject</text>
<text text-anchor="start" x="738.07" y="-2267.4" font-family="Arial" font-size="12.00">it into a client application using the attacker’s account. The goal is to</text>
<text text-anchor="start" x="864.57" y="-2254.4" font-family="Arial" font-size="12.00">associate an access au[...]</text>
</g>
<!-- 4_4_1_7_CLIENT_SPOOFING4&#45;&gt;CONFIDENTIALITY -->
<g id="edge70" class="edge">
<title>4_4_1_7_CLIENT_SPOOFING4&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M866,-2339.07C804.12,-2381.79 720.98,-2450.87 681.07,-2535 654.16,-2591.74 701.51,-2767.35 663.07,-2817 645.6,-2839.56 626.64,-2822.49 602.07,-2837 482.05,-2907.89 369.91,-3032.26 320.09,-3091.63"/>
<polygon fill="black" stroke="black" points="317.2,-3089.64 313.49,-3099.56 322.58,-3094.12 317.2,-3089.64"/>
<text text-anchor="middle" x="632.57" y="-2840.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_4_1_7_CLIENT_SPOOFING4_countermeasure0 -->
<g id="node65" class="node">
<title>4_4_1_7_CLIENT_SPOOFING4_countermeasure0</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="2009.57,-2454 1412.57,-2454 1412.57,-2358 2009.57,-2358 2009.57,-2454"/>
<text text-anchor="start" x="1423.07" y="-2439.4" font-family="Arial" font-weight="bold" font-size="12.00"> Binding of Authorization &quot;code&quot; to &quot;redirect_uri&quot; (5_2_4_5_REDIRECT_CODE_BINDING) </text>
<text text-anchor="start" x="1508.07" y="-2415.4" font-family="Arial" font-size="12.00"> The authorization server should be able to bind every authorization</text>
<text text-anchor="start" x="1514.07" y="-2403.4" font-family="Arial" font-size="12.00">&quot;code&quot; to the actual redirect URI used as the redirect target of the</text>
<text text-anchor="start" x="1482.57" y="-2391.4" font-family="Arial" font-size="12.00">client in the end&#45;user authorization process. This binding should be validated</text>
<text text-anchor="start" x="1512.07" y="-2379.4" font-family="Arial" font-size="12.00">when the client attempts to exchange the respective authorization</text>
<text text-anchor="start" x="1618.57" y="-2367.4" font-family="Arial" font-size="12.00">&quot;code&quot; for an access token[...] </text>
</g>
<!-- 4_4_1_7_CLIENT_SPOOFING4_countermeasure0&#45;&gt;4_4_1_7_CLIENT_SPOOFING4 -->
<g id="edge66" class="edge">
<title>4_4_1_7_CLIENT_SPOOFING4_countermeasure0&#45;&gt;4_4_1_7_CLIENT_SPOOFING4</title>
<path fill="none" stroke="black" d="M1412.39,-2363.35C1379.54,-2358.55 1346.59,-2353.7 1315.07,-2349 1272.13,-2342.6 1226.42,-2335.66 1182.29,-2328.91"/>
<polygon fill="black" stroke="black" points="1182.72,-2325.43 1172.3,-2327.38 1181.66,-2332.35 1182.72,-2325.43"/>
<text text-anchor="middle" x="1260.57" y="-2349.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_7_CLIENT_SPOOFING4_countermeasure1 -->
<g id="node66" class="node">
<title>4_4_1_7_CLIENT_SPOOFING4_countermeasure1</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="1989.57,-2340 1432.57,-2340 1432.57,-2244 1989.57,-2244 1989.57,-2340"/>
<text text-anchor="start" x="1443.07" y="-2325.4" font-family="Arial" font-weight="bold" font-size="12.00"> Issue Installation&#45;Specific Client Secrets (5_2_3_4_SPECIFIC_CLIENT_SECRETS) </text>
<text text-anchor="start" x="1472.07" y="-2301.4" font-family="Arial" font-size="12.00"> An authorization server may issue separate client identifiers and corresponding</text>
<text text-anchor="start" x="1501.57" y="-2289.4" font-family="Arial" font-size="12.00">secrets to the different installations of a particular client (i.e., software</text>
<text text-anchor="start" x="1502.57" y="-2277.4" font-family="Arial" font-size="12.00">package). &#160;The effect of such an approach would be to turn otherwise</text>
<text text-anchor="start" x="1547.57" y="-2265.4" font-family="Arial" font-size="12.00">&quot;public&quot; clients back into &quot;confidential&quot; clients. For web</text>
<text text-anchor="start" x="1640.57" y="-2253.4" font-family="Arial" font-size="12.00">applications, this co[...] </text>
</g>
<!-- 4_4_1_7_CLIENT_SPOOFING4_countermeasure1&#45;&gt;4_4_1_7_CLIENT_SPOOFING4 -->
<g id="edge67" class="edge">
<title>4_4_1_7_CLIENT_SPOOFING4_countermeasure1&#45;&gt;4_4_1_7_CLIENT_SPOOFING4</title>
<path fill="none" stroke="black" d="M1432.35,-2292C1350.41,-2292 1261.5,-2292 1182.31,-2292"/>
<polygon fill="black" stroke="black" points="1182.21,-2288.5 1172.21,-2292 1182.21,-2295.5 1182.21,-2288.5"/>
<text text-anchor="middle" x="1260.57" y="-2295.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_7_CLIENT_SPOOFING4_countermeasure2 -->
<g id="node67" class="node">
<title>4_4_1_7_CLIENT_SPOOFING4_countermeasure2</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="2001.57,-2226 1420.57,-2226 1420.57,-2130 2001.57,-2130 2001.57,-2226"/>
<text text-anchor="start" x="1431.07" y="-2211.4" font-family="Arial" font-weight="bold" font-size="12.00"> Binding of Authorization &quot;code&quot; to &quot;client_id&quot; (5_2_4_4_CLIENT_TO_CODE_BINDING) </text>
<text text-anchor="start" x="1498.57" y="-2187.4" font-family="Arial" font-size="12.00"> The authorization server should bind every authorization &quot;code&quot; to the</text>
<text text-anchor="start" x="1488.07" y="-2175.4" font-family="Arial" font-size="12.00">id of the respective client that initiated the end&#45;user authorization process.</text>
<text text-anchor="start" x="1488.07" y="-2163.4" font-family="Arial" font-size="12.00">This measure is a countermeasure against: &lt;br/&gt;o Replay of authorization</text>
<text text-anchor="start" x="1516.57" y="-2151.4" font-family="Arial" font-size="12.00">&quot;codes&quot; with different client credentials, since an attacker cannot</text>
<text text-anchor="start" x="1648.57" y="-2139.4" font-family="Arial" font-size="12.00">use another &quot;clie[...] </text>
</g>
<!-- 4_4_1_7_CLIENT_SPOOFING4_countermeasure2&#45;&gt;4_4_1_7_CLIENT_SPOOFING4 -->
<g id="edge68" class="edge">
<title>4_4_1_7_CLIENT_SPOOFING4_countermeasure2&#45;&gt;4_4_1_7_CLIENT_SPOOFING4</title>
<path fill="none" stroke="black" d="M1420.41,-2219.48C1384.92,-2224.66 1349.16,-2229.92 1315.07,-2235 1272.13,-2241.4 1226.42,-2248.34 1182.29,-2255.09"/>
<polygon fill="black" stroke="black" points="1181.66,-2251.65 1172.3,-2256.62 1182.72,-2258.57 1181.66,-2251.65"/>
<text text-anchor="middle" x="1260.57" y="-2250.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_7_CLIENT_SPOOFING4_countermeasure3 -->
<g id="node68" class="node">
<title>4_4_1_7_CLIENT_SPOOFING4_countermeasure3</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1956.57,-2112 1465.57,-2112 1465.57,-2040 1956.57,-2040 1956.57,-2112"/>
<text text-anchor="start" x="1559.07" y="-2097.4" font-family="Arial" font-weight="bold" font-size="12.00"> Implicit grant flow (IMPLICIT_GRANT_FLOW) </text>
<text text-anchor="start" x="1480.07" y="-2073.4" font-family="Arial" font-size="12.00"> The client may consider using other flows that are not vulnerable to this kind</text>
<text text-anchor="start" x="1476.07" y="-2061.4" font-family="Arial" font-size="12.00">of attack, such as the implicit grant type (see Section 4.4.2) or resource owner</text>
<text text-anchor="start" x="1587.07" y="-2049.4" font-family="Arial" font-size="12.00">password credentials (see Section 4.4.3). </text>
</g>
<!-- 4_4_1_7_CLIENT_SPOOFING4_countermeasure3&#45;&gt;4_4_1_7_CLIENT_SPOOFING4 -->
<g id="edge69" class="edge">
<title>4_4_1_7_CLIENT_SPOOFING4_countermeasure3&#45;&gt;4_4_1_7_CLIENT_SPOOFING4</title>
<path fill="none" stroke="black" d="M1465.4,-2091.56C1415.11,-2098.19 1362.93,-2107.61 1315.07,-2121 1215.46,-2148.88 1108.96,-2200.58 1035.82,-2239.86"/>
<polygon fill="black" stroke="black" points="1033.76,-2237 1026.63,-2244.83 1037.09,-2243.16 1033.76,-2237"/>
<text text-anchor="middle" x="1260.57" y="-2152.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_8_CSRF_ON_REDIRECT -->
<g id="node69" class="node">
<title>4_4_1_8_CSRF_ON_REDIRECT</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1198.57,-2014.5 688.57,-2014.5 688.57,-1933.5 1198.57,-1933.5 1198.57,-2014.5"/>
<text text-anchor="start" x="818.07" y="-1999.4" font-family="Arial" font-weight="bold" font-size="12.00">4_4_1_8_CSRF_ON_REDIRECT ATTACK</text>
<text text-anchor="start" x="1065.07" y="-1999.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="705.57" y="-1981.4" font-family="Arial" font-size="12.00">Cross&#45;site request forgery (CSRF) is a web&#45;based attack whereby HTTP requests</text>
<text text-anchor="start" x="707.57" y="-1968.4" font-family="Arial" font-size="12.00">are transmitted from a user that the web site trusts or has authenticated (e.g.,</text>
<text text-anchor="start" x="698.57" y="-1955.4" font-family="Arial" font-size="12.00">via HTTP redirects or HTML forms). CSRF attacks on OAuth approvals can allow an</text>
<text text-anchor="start" x="724.57" y="-1942.4" font-family="Arial" font-size="12.00">attacker to obtain authorization to OAuth protected resources without[...]</text>
</g>
<!-- 4_4_1_8_CSRF_ON_REDIRECT&#45;&gt;CONFIDENTIALITY -->
<g id="edge73" class="edge">
<title>4_4_1_8_CSRF_ON_REDIRECT&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M880.6,-2014.55C817.35,-2059.95 722.72,-2139.88 681.07,-2236 657.2,-2291.08 698.39,-2727.46 663.07,-2776 646.11,-2799.3 626.18,-2782.21 602.07,-2798 475.44,-2880.95 363.43,-3025.71 316.47,-3091.16"/>
<polygon fill="black" stroke="black" points="313.5,-3089.3 310.55,-3099.48 319.2,-3093.36 313.5,-3089.3"/>
<text text-anchor="middle" x="632.57" y="-2801.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_4_1_8_CSRF_ON_REDIRECT_countermeasure0 -->
<g id="node70" class="node">
<title>4_4_1_8_CSRF_ON_REDIRECT_countermeasure0</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="2045.57,-2022 1376.57,-2022 1376.57,-1926 2045.57,-1926 2045.57,-2022"/>
<text text-anchor="start" x="1387.07" y="-2007.4" font-family="Arial" font-weight="bold" font-size="12.00"> Link the state Parameter to User Agent Session (anti CSRF) (5_3_5_ANTI_CSRF_STATE_PARAM) </text>
<text text-anchor="start" x="1499.07" y="-1983.4" font-family="Arial" font-size="12.00"> The &quot;state&quot; parameter is used to link client requests and prevent CSRF</text>
<text text-anchor="start" x="1477.07" y="-1971.4" font-family="Arial" font-size="12.00">attacks, for example, attacks against the redirect URI. An attacker could inject</text>
<text text-anchor="start" x="1511.57" y="-1959.4" font-family="Arial" font-size="12.00">their own authorization &quot;code&quot; or access token, which can result in</text>
<text text-anchor="start" x="1493.57" y="-1947.4" font-family="Arial" font-size="12.00">the client using an access token associated with the attacker’s protected</text>
<text text-anchor="start" x="1656.07" y="-1935.4" font-family="Arial" font-size="12.00">resources rath[...] </text>
</g>
<!-- 4_4_1_8_CSRF_ON_REDIRECT_countermeasure0&#45;&gt;4_4_1_8_CSRF_ON_REDIRECT -->
<g id="edge71" class="edge">
<title>4_4_1_8_CSRF_ON_REDIRECT_countermeasure0&#45;&gt;4_4_1_8_CSRF_ON_REDIRECT</title>
<path fill="none" stroke="black" d="M1376.54,-1974C1320.4,-1974 1262.83,-1974 1208.76,-1974"/>
<polygon fill="black" stroke="black" points="1208.71,-1970.5 1198.71,-1974 1208.71,-1977.5 1208.71,-1970.5"/>
<text text-anchor="middle" x="1260.57" y="-1977.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_8_CSRF_ON_REDIRECT_countermeasure1 -->
<g id="node71" class="node">
<title>4_4_1_8_CSRF_ON_REDIRECT_countermeasure1</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1970.57,-1908 1451.57,-1908 1451.57,-1860 1970.57,-1860 1970.57,-1908"/>
<text text-anchor="start" x="1462.07" y="-1893.4" font-family="Arial" font-weight="bold" font-size="12.00"> Users can be educated to not follow untrusted URLs (USER_EDUCATION) </text>
<text text-anchor="start" x="1471.07" y="-1869.4" font-family="Arial" font-size="12.00"> Client developers and end users can be educated to not follow untrusted URLs. </text>
</g>
<!-- 4_4_1_8_CSRF_ON_REDIRECT_countermeasure1&#45;&gt;4_4_1_8_CSRF_ON_REDIRECT -->
<g id="edge72" class="edge">
<title>4_4_1_8_CSRF_ON_REDIRECT_countermeasure1&#45;&gt;4_4_1_8_CSRF_ON_REDIRECT</title>
<path fill="none" stroke="black" d="M1451.39,-1903.02C1405.91,-1907.11 1359.06,-1911.78 1315.07,-1917 1278.58,-1921.33 1240.17,-1926.52 1202.46,-1931.98"/>
<polygon fill="black" stroke="black" points="1201.76,-1928.54 1192.37,-1933.45 1202.77,-1935.47 1201.76,-1928.54"/>
<text text-anchor="middle" x="1260.57" y="-1930.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_9_CLICKJACKING -->
<g id="node72" class="node">
<title>4_4_1_9_CLICKJACKING</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1176.07,-1841 711.07,-1841 711.07,-1747 1176.07,-1747 1176.07,-1841"/>
<text text-anchor="start" x="838.07" y="-1826.4" font-family="Arial" font-weight="bold" font-size="12.00">4_4_1_9_CLICKJACKING ATTACK</text>
<text text-anchor="start" x="1046.07" y="-1826.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="733.57" y="-1808.4" font-family="Arial" font-size="12.00">With clickjacking, a malicious site loads the target site in a transparent</text>
<text text-anchor="start" x="725.57" y="-1795.4" font-family="Arial" font-size="12.00">iFrame (see [iFrame]) overlaid on top of a set of dummy buttons that are</text>
<text text-anchor="start" x="721.57" y="-1782.4" font-family="Arial" font-size="12.00">carefully constructed to be placed directly under important buttons on the</text>
<text text-anchor="start" x="723.07" y="-1769.4" font-family="Arial" font-size="12.00">target site. When a user clicks a visible button, they are actually clicking a</text>
<text text-anchor="start" x="914.07" y="-1756.4" font-family="Arial" font-size="12.00">button[...]</text>
</g>
<!-- 4_4_1_9_CLICKJACKING&#45;&gt;CONFIDENTIALITY -->
<g id="edge76" class="edge">
<title>4_4_1_9_CLICKJACKING&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M782.04,-1841.09C742.47,-1860.59 704.7,-1887.67 681.07,-1925 633.27,-2000.5 712.15,-2654.33 663.07,-2729 646.69,-2753.93 625.79,-2738.92 602.07,-2757 471.63,-2856.43 359.28,-3020.17 314.16,-3090.81"/>
<polygon fill="black" stroke="black" points="311.15,-3089.03 308.75,-3099.35 317.06,-3092.78 311.15,-3089.03"/>
<text text-anchor="middle" x="632.57" y="-2760.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_4_1_9_CLICKJACKING_countermeasure0 -->
<g id="node73" class="node">
<title>4_4_1_9_CLICKJACKING_countermeasure0</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="2026.07,-1842 1396.07,-1842 1396.07,-1746 2026.07,-1746 2026.07,-1842"/>
<text text-anchor="start" x="1406.07" y="-1827.4" font-family="Arial" font-weight="bold" font-size="12.00"> Link the state Parameter to User Agent Session (anti CSRF) (5_2_2_6_X_FRAME_OPTION) </text>
<text text-anchor="start" x="1462.57" y="-1803.4" font-family="Arial" font-size="12.00"> For newer browsers, avoidance of iFrames can be enforced on the &#160;&#160;server side by</text>
<text text-anchor="start" x="1457.07" y="-1791.4" font-family="Arial" font-size="12.00">using the X&#45;FRAME&#45;OPTIONS header (see &#160;&#160;[X&#45;Frame&#45;Options]). This header can have</text>
<text text-anchor="start" x="1528.07" y="-1779.4" font-family="Arial" font-size="12.00">two values, &quot;DENY&quot; and &#160;&#160;&quot;SAMEORIGIN&quot;, which will block any</text>
<text text-anchor="start" x="1493.07" y="-1767.4" font-family="Arial" font-size="12.00">framing or any framing by sites &#160;&#160;with a different origin, respectively. The</text>
<text text-anchor="start" x="1670.57" y="-1755.4" font-family="Arial" font-size="12.00">value &quot;AL[...] </text>
</g>
<!-- 4_4_1_9_CLICKJACKING_countermeasure0&#45;&gt;4_4_1_9_CLICKJACKING -->
<g id="edge74" class="edge">
<title>4_4_1_9_CLICKJACKING_countermeasure0&#45;&gt;4_4_1_9_CLICKJACKING</title>
<path fill="none" stroke="black" d="M1395.95,-1794C1325.99,-1794 1252.87,-1794 1186.35,-1794"/>
<polygon fill="black" stroke="black" points="1186.16,-1790.5 1176.16,-1794 1186.16,-1797.5 1186.16,-1790.5"/>
<text text-anchor="middle" x="1260.57" y="-1797.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_9_CLICKJACKING_countermeasure1 -->
<g id="node74" class="node">
<title>4_4_1_9_CLICKJACKING_countermeasure1</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1968.57,-1728 1453.57,-1728 1453.57,-1668 1968.57,-1668 1968.57,-1728"/>
<text text-anchor="start" x="1561.57" y="-1713.4" font-family="Arial" font-weight="bold" font-size="12.00"> JavaScript frame&#45;busting (FRAMEBUSTING) </text>
<text text-anchor="start" x="1464.07" y="-1689.4" font-family="Arial" font-size="12.00"> For older browsers, JavaScript frame&#45;busting (see [Framebusting]) techniques can</text>
<text text-anchor="start" x="1564.07" y="-1677.4" font-family="Arial" font-size="12.00">be used but may not be effective in all browsers. </text>
</g>
<!-- 4_4_1_9_CLICKJACKING_countermeasure1&#45;&gt;4_4_1_9_CLICKJACKING -->
<g id="edge75" class="edge">
<title>4_4_1_9_CLICKJACKING_countermeasure1&#45;&gt;4_4_1_9_CLICKJACKING</title>
<path fill="none" stroke="black" d="M1453.54,-1721.29C1407.39,-1726.06 1359.77,-1731.36 1315.07,-1737 1273.44,-1742.25 1229.28,-1748.48 1186.5,-1754.85"/>
<polygon fill="black" stroke="black" points="1185.9,-1751.4 1176.53,-1756.34 1186.93,-1758.32 1185.9,-1751.4"/>
<text text-anchor="middle" x="1260.57" y="-1750.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_10_RESOURCE_OWNER_SPOOFING1 -->
<g id="node75" class="node">
<title>4_4_1_10_RESOURCE_OWNER_SPOOFING1</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1191.07,-1648.5 696.07,-1648.5 696.07,-1567.5 1191.07,-1567.5 1191.07,-1648.5"/>
<text text-anchor="start" x="773.57" y="-1633.4" font-family="Arial" font-weight="bold" font-size="12.00">4_4_1_10_RESOURCE_OWNER_SPOOFING1 ATTACK</text>
<text text-anchor="start" x="1110.57" y="-1633.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="715.07" y="-1615.4" font-family="Arial" font-size="12.00">When a client requests access to protected resources, the authorization flow</text>
<text text-anchor="start" x="707.57" y="-1602.4" font-family="Arial" font-size="12.00">normally involves the resource owner’s explicit response to the access request,</text>
<text text-anchor="start" x="706.57" y="-1589.4" font-family="Arial" font-size="12.00">either granting or denying access to the protected resources. A malicious client</text>
<text text-anchor="start" x="730.57" y="-1576.4" font-family="Arial" font-size="12.00">can exploit knowledge of the structure of this flow in order to gain a[...]</text>
</g>
<!-- 4_4_1_10_RESOURCE_OWNER_SPOOFING1&#45;&gt;CONFIDENTIALITY -->
<g id="edge79" class="edge">
<title>4_4_1_10_RESOURCE_OWNER_SPOOFING1&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M794.66,-1648.52C750.61,-1668.16 707.17,-1696.77 681.07,-1738 653.25,-1781.95 689.29,-2629.08 663.07,-2674 647.2,-2701.19 625.49,-2688.96 602.07,-2710 468.83,-2829.71 355.67,-3014.7 312.14,-3090.66"/>
<polygon fill="black" stroke="black" points="309.08,-3088.95 307.18,-3099.37 315.17,-3092.41 309.08,-3088.95"/>
<text text-anchor="middle" x="632.57" y="-2713.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_4_1_10_RESOURCE_OWNER_SPOOFING1_countermeasure0 -->
<g id="node76" class="node">
<title>4_4_1_10_RESOURCE_OWNER_SPOOFING1_countermeasure0</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1961.57,-1650 1460.57,-1650 1460.57,-1566 1961.57,-1566 1961.57,-1650"/>
<text text-anchor="start" x="1475.57" y="-1635.4" font-family="Arial" font-weight="bold" font-size="12.00"> Interactive (non automatic) user approval (INTERACTIVE_APPROVAL) </text>
<text text-anchor="start" x="1471.07" y="-1611.4" font-family="Arial" font-size="12.00"> Authorization servers should decide, based on an analysis of the risk associated</text>
<text text-anchor="start" x="1479.07" y="-1599.4" font-family="Arial" font-size="12.00">with this threat, whether to detect and prevent this threat. In order to prevent</text>
<text text-anchor="start" x="1475.57" y="-1587.4" font-family="Arial" font-size="12.00">such an attack, the authorization server may force a user interaction based on</text>
<text text-anchor="start" x="1500.07" y="-1575.4" font-family="Arial" font-size="12.00">non&#45;predictable input values as part of the user consent approval. [...] </text>
</g>
<!-- 4_4_1_10_RESOURCE_OWNER_SPOOFING1_countermeasure0&#45;&gt;4_4_1_10_RESOURCE_OWNER_SPOOFING1 -->
<g id="edge77" class="edge">
<title>4_4_1_10_RESOURCE_OWNER_SPOOFING1_countermeasure0&#45;&gt;4_4_1_10_RESOURCE_OWNER_SPOOFING1</title>
<path fill="none" stroke="black" d="M1460.48,-1608C1377.46,-1608 1284.9,-1608 1201.35,-1608"/>
<polygon fill="black" stroke="black" points="1201.21,-1604.5 1191.21,-1608 1201.21,-1611.5 1201.21,-1604.5"/>
<text text-anchor="middle" x="1260.57" y="-1611.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_10_RESOURCE_OWNER_SPOOFING1_countermeasure1 -->
<g id="node77" class="node">
<title>4_4_1_10_RESOURCE_OWNER_SPOOFING1_countermeasure1</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1962.57,-1548 1459.57,-1548 1459.57,-1476 1962.57,-1476 1962.57,-1548"/>
<text text-anchor="start" x="1560.57" y="-1533.4" font-family="Arial" font-weight="bold" font-size="12.00"> Notify User&#39;s approval (NOTIFY_APPROVAL) </text>
<text text-anchor="start" x="1476.07" y="-1509.4" font-family="Arial" font-size="12.00"> In order to allow the resource owner to detect abuse, the authorization server</text>
<text text-anchor="start" x="1470.07" y="-1497.4" font-family="Arial" font-size="12.00">could notify the resource owner of any approval by appropriate means, e.g., text</text>
<text text-anchor="start" x="1621.57" y="-1485.4" font-family="Arial" font-size="12.00">or instant message, or email. </text>
</g>
<!-- 4_4_1_10_RESOURCE_OWNER_SPOOFING1_countermeasure1&#45;&gt;4_4_1_10_RESOURCE_OWNER_SPOOFING1 -->
<g id="edge78" class="edge">
<title>4_4_1_10_RESOURCE_OWNER_SPOOFING1_countermeasure1&#45;&gt;4_4_1_10_RESOURCE_OWNER_SPOOFING1</title>
<path fill="none" stroke="black" d="M1459.48,-1539.66C1411.52,-1545.2 1361.72,-1551.13 1315.07,-1557 1278.26,-1561.63 1239.42,-1566.73 1201.29,-1571.87"/>
<polygon fill="black" stroke="black" points="1200.53,-1568.44 1191.09,-1573.25 1201.47,-1575.38 1200.53,-1568.44"/>
<text text-anchor="middle" x="1260.57" y="-1570.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_13_CODE_SUBSTITUTION -->
<g id="node78" class="node">
<title>4_4_1_13_CODE_SUBSTITUTION</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1178.57,-1457 708.57,-1457 708.57,-1363 1178.57,-1363 1178.57,-1457"/>
<text text-anchor="start" x="809.07" y="-1442.4" font-family="Arial" font-weight="bold" font-size="12.00">4_4_1_13_CODE_SUBSTITUTION ATTACK</text>
<text text-anchor="start" x="1074.07" y="-1442.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="728.57" y="-1424.4" font-family="Arial" font-size="12.00">An attacker could attempt to log into an application or web site &#160;using a</text>
<text text-anchor="start" x="718.57" y="-1411.4" font-family="Arial" font-size="12.00">victim’s identity. Applications relying on identity data &#160;provided by an OAuth</text>
<text text-anchor="start" x="734.57" y="-1398.4" font-family="Arial" font-size="12.00">protected service API to login users are &#160;vulnerable to this threat. This</text>
<text text-anchor="start" x="754.07" y="-1385.4" font-family="Arial" font-size="12.00">pattern can be found in so&#45;called &#160;&quot;social login&quot; scenarios. &#160;As a</text>
<text text-anchor="start" x="894.07" y="-1372.4" font-family="Arial" font-size="12.00">prerequisite, [...]</text>
</g>
<!-- 4_4_1_13_CODE_SUBSTITUTION&#45;&gt;CONFIDENTIALITY -->
<g id="edge82" class="edge">
<title>4_4_1_13_CODE_SUBSTITUTION&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M802.03,-1457.11C755.28,-1480.19 708.25,-1513.15 681.07,-1559 651.52,-1608.85 687.56,-2549.48 663.07,-2602 647.89,-2634.55 625.71,-2627.96 602.07,-2655 472.65,-2802.99 355.67,-3008.88 311.6,-3090.08"/>
<polygon fill="black" stroke="black" points="308.26,-3088.89 306.59,-3099.36 314.42,-3092.22 308.26,-3088.89"/>
<text text-anchor="middle" x="632.57" y="-2658.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_4_1_13_CODE_SUBSTITUTION_countermeasure0 -->
<g id="node79" class="node">
<title>4_4_1_13_CODE_SUBSTITUTION_countermeasure0</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1943.57,-1458 1478.57,-1458 1478.57,-1362 1943.57,-1362 1943.57,-1458"/>
<text text-anchor="start" x="1501.07" y="-1443.4" font-family="Arial" font-weight="bold" font-size="12.00"> Clients indicate their ids in requests (IN_REQUEST_CLIENTID) </text>
<text text-anchor="start" x="1489.07" y="-1419.4" font-family="Arial" font-size="12.00"> All clients must indicate their client ids with every request to exchange an</text>
<text text-anchor="start" x="1512.07" y="-1407.4" font-family="Arial" font-size="12.00">authorization &quot;code&quot; for an access token. The authorization server</text>
<text text-anchor="start" x="1509.57" y="-1395.4" font-family="Arial" font-size="12.00">must validate whether the particular authorization &quot;code&quot; has been</text>
<text text-anchor="start" x="1490.57" y="-1383.4" font-family="Arial" font-size="12.00">issued to the particular client. If possible, the client shall be authenticated</text>
<text text-anchor="start" x="1673.07" y="-1371.4" font-family="Arial" font-size="12.00">beforehand. </text>
</g>
<!-- 4_4_1_13_CODE_SUBSTITUTION_countermeasure0&#45;&gt;4_4_1_13_CODE_SUBSTITUTION -->
<g id="edge80" class="edge">
<title>4_4_1_13_CODE_SUBSTITUTION_countermeasure0&#45;&gt;4_4_1_13_CODE_SUBSTITUTION</title>
<path fill="none" stroke="black" d="M1478.32,-1410C1386.82,-1410 1281.61,-1410 1188.92,-1410"/>
<polygon fill="black" stroke="black" points="1188.84,-1406.5 1178.84,-1410 1188.84,-1413.5 1188.84,-1406.5"/>
<text text-anchor="middle" x="1260.57" y="-1413.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_13_CODE_SUBSTITUTION_countermeasure1 -->
<g id="node80" class="node">
<title>4_4_1_13_CODE_SUBSTITUTION_countermeasure1</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1959.57,-1344 1462.57,-1344 1462.57,-1272 1959.57,-1272 1959.57,-1344"/>
<text text-anchor="start" x="1495.57" y="-1329.4" font-family="Arial" font-weight="bold" font-size="12.00"> Secure User Login Protocol (SECURE_USER_LOGIN_PROTOCOL) </text>
<text text-anchor="start" x="1481.57" y="-1305.4" font-family="Arial" font-size="12.00"> Clients should use an appropriate protocol, such as OpenID (cf. [OPENID]) or</text>
<text text-anchor="start" x="1473.07" y="-1293.4" font-family="Arial" font-size="12.00">SAML (cf. [OASIS.sstc&#45;saml&#45;bindings&#45;1.1]) to implement user login. Both support</text>
<text text-anchor="start" x="1615.07" y="-1281.4" font-family="Arial" font-size="12.00">audience restrictions on clients. </text>
</g>
<!-- 4_4_1_13_CODE_SUBSTITUTION_countermeasure1&#45;&gt;4_4_1_13_CODE_SUBSTITUTION -->
<g id="edge81" class="edge">
<title>4_4_1_13_CODE_SUBSTITUTION_countermeasure1&#45;&gt;4_4_1_13_CODE_SUBSTITUTION</title>
<path fill="none" stroke="black" d="M1462.57,-1334.69C1413.64,-1340.39 1362.7,-1346.63 1315.07,-1353 1274.16,-1358.47 1230.79,-1364.73 1188.68,-1371.06"/>
<polygon fill="black" stroke="black" points="1187.94,-1367.63 1178.58,-1372.58 1188.99,-1374.55 1187.94,-1367.63"/>
<text text-anchor="middle" x="1260.57" y="-1367.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_2_1_TOKEN_LEAK1_NETWORK -->
<g id="node81" class="node">
<title>4_4_2_1_TOKEN_LEAK1_NETWORK</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1195.07,-1295.5 692.07,-1295.5 692.07,-1214.5 1195.07,-1214.5 1195.07,-1295.5"/>
<text text-anchor="start" x="801.57" y="-1280.4" font-family="Arial" font-weight="bold" font-size="12.00">4_4_2_1_TOKEN_LEAK1_NETWORK ATTACK</text>
<text text-anchor="start" x="1082.57" y="-1280.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="713.07" y="-1262.4" font-family="Arial" font-size="12.00">This token might be eavesdropped by an attacker. The token is sent from the</text>
<text text-anchor="start" x="752.57" y="-1249.4" font-family="Arial" font-size="12.00">server to the client via a URI fragment of the redirect URI. If the</text>
<text text-anchor="start" x="702.57" y="-1236.4" font-family="Arial" font-size="12.00">communication is not secured or the endpoint is not secured, the token could be</text>
<text text-anchor="start" x="837.57" y="-1223.4" font-family="Arial" font-size="12.00">leaked by parsing the returned URI.</text>
</g>
<!-- 4_4_2_1_TOKEN_LEAK1_NETWORK&#45;&gt;CONFIDENTIALITY -->
<g id="edge84" class="edge">
<title>4_4_2_1_TOKEN_LEAK1_NETWORK&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M752.06,-1295.63C724.2,-1309.68 698.93,-1328.58 681.07,-1354 644.63,-1405.88 682.47,-2434.64 663.07,-2495 648.51,-2540.31 627.44,-2542.74 602.07,-2583 484.11,-2770.24 357.6,-3003.83 311.32,-3090.53"/>
<polygon fill="black" stroke="black" points="308.2,-3088.94 306.58,-3099.41 314.38,-3092.23 308.2,-3088.94"/>
<text text-anchor="middle" x="632.57" y="-2586.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_4_2_1_TOKEN_LEAK1_NETWORK_countermeasure0 -->
<g id="node82" class="node">
<title>4_4_2_1_TOKEN_LEAK1_NETWORK_countermeasure0</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="1980.57,-1254 1441.57,-1254 1441.57,-1158 1980.57,-1158 1980.57,-1254"/>
<text text-anchor="start" x="1452.07" y="-1239.4" font-family="Arial" font-weight="bold" font-size="12.00"> Ensure Confidentiality of Requests (TLS) (5_1_1_CONFIDENTIAL_REQUESTS) </text>
<text text-anchor="start" x="1493.57" y="-1215.4" font-family="Arial" font-size="12.00"> This is applicable to all requests sent from the client to the authorization</text>
<text text-anchor="start" x="1476.57" y="-1203.4" font-family="Arial" font-size="12.00">server or resource server. While OAuth provides a mechanism for verifying the</text>
<text text-anchor="start" x="1497.07" y="-1191.4" font-family="Arial" font-size="12.00">integrity of requests, it provides no guarantee of request confidentiality.</text>
<text text-anchor="start" x="1485.07" y="-1179.4" font-family="Arial" font-size="12.00">Unless further precautions are taken, eavesdroppers will have full access to</text>
<text text-anchor="start" x="1699.07" y="-1167.4" font-family="Arial" font-size="12.00">[...] </text>
</g>
<!-- 4_4_2_1_TOKEN_LEAK1_NETWORK_countermeasure0&#45;&gt;4_4_2_1_TOKEN_LEAK1_NETWORK -->
<g id="edge83" class="edge">
<title>4_4_2_1_TOKEN_LEAK1_NETWORK_countermeasure0&#45;&gt;4_4_2_1_TOKEN_LEAK1_NETWORK</title>
<path fill="none" stroke="black" d="M1441.53,-1223.19C1364.93,-1228.09 1281.61,-1233.43 1205.48,-1238.3"/>
<polygon fill="black" stroke="black" points="1205.02,-1234.82 1195.27,-1238.95 1205.47,-1241.81 1205.02,-1234.82"/>
<text text-anchor="middle" x="1260.57" y="-1239.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY -->
<g id="node83" class="node">
<title>4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1131.57,-1037 755.57,-1037 755.57,-995 1131.57,-995 1131.57,-1037"/>
<text text-anchor="start" x="768.57" y="-1022.4" font-family="Arial" font-weight="bold" font-size="12.00">4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY ATTACK</text>
<text text-anchor="start" x="1114.57" y="-1022.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="765.57" y="-1004.4" font-family="Arial" font-size="12.00">A malicious client could attempt to obtain a token by fraud.</text>
</g>
<!-- 4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY&#45;&gt;CONFIDENTIALITY -->
<g id="edge87" class="edge">
<title>4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M889.31,-1037.01C826.54,-1065.01 725.19,-1121.1 681.07,-1206 652.53,-1260.92 676.79,-2259.64 663.07,-2320 644.18,-2403.12 380.59,-2945.8 310.21,-3089.91"/>
<polygon fill="black" stroke="black" points="306.91,-3088.68 305.67,-3099.2 313.2,-3091.76 306.91,-3088.68"/>
<text text-anchor="middle" x="632.57" y="-2461.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY&#45;&gt;CONFIDENTIALITY -->
<g id="edge93" class="edge">
<title>4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M889.4,-1037.06C826.72,-1065.1 725.46,-1121.24 681.07,-1206 660.39,-1245.48 670.66,-1964.08 663.07,-2008 586.77,-2449.38 369.72,-2954.09 309,-3089.86"/>
<polygon fill="black" stroke="black" points="305.64,-3088.8 304.73,-3099.35 312.02,-3091.66 305.64,-3088.8"/>
<text text-anchor="middle" x="632.57" y="-2262.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY_countermeasure0 -->
<g id="node84" class="node">
<title>4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY_countermeasure0</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1972.07,-1140 1450.07,-1140 1450.07,-1044 1972.07,-1044 1972.07,-1140"/>
<text text-anchor="start" x="1460.07" y="-1125.4" font-family="Arial" font-weight="bold" font-size="12.00"> Validate Pre&#45;Registered &quot;redirect_uri&quot; (5_2_3_5_VALIDATE_REDIRECT_URI) </text>
<text text-anchor="start" x="1516.57" y="-1101.4" font-family="Arial" font-size="12.00"> An authorization server should require all clients to register their</text>
<text text-anchor="start" x="1551.07" y="-1089.4" font-family="Arial" font-size="12.00">&quot;redirect_uri&quot;, and the &quot;redirect_uri&quot; should be the full</text>
<text text-anchor="start" x="1476.07" y="-1077.4" font-family="Arial" font-size="12.00">URI as defined in [RFC6749]. &#160;The way that this registration is performed is out</text>
<text text-anchor="start" x="1473.07" y="-1065.4" font-family="Arial" font-size="12.00">of scope of this document. &#160;As per the core spec, every actual redirect URI sent</text>
<text text-anchor="start" x="1642.07" y="-1053.4" font-family="Arial" font-size="12.00">with the respective[...] </text>
</g>
<!-- 4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY_countermeasure0&#45;&gt;4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY -->
<g id="edge85" class="edge">
<title>4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY_countermeasure0&#45;&gt;4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY</title>
<path fill="none" stroke="black" d="M1450.03,-1087.22C1376.77,-1083.98 1297.15,-1078.67 1224.07,-1070 1164.36,-1062.92 1098.28,-1050.37 1045.37,-1039.15"/>
<polygon fill="black" stroke="black" points="1045.82,-1035.67 1035.31,-1037 1044.36,-1042.52 1045.82,-1035.67"/>
<text text-anchor="middle" x="1260.57" y="-1079.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY_countermeasure0&#45;&gt;4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY -->
<g id="edge88" class="edge">
<title>4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY_countermeasure0&#45;&gt;4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY</title>
<path fill="none" stroke="black" d="M1449.84,-1066.16C1349.05,-1056.16 1235.6,-1044.89 1141.77,-1035.58"/>
<polygon fill="black" stroke="black" points="1141.89,-1032.07 1131.59,-1034.57 1141.19,-1039.04 1141.89,-1032.07"/>
<text text-anchor="middle" x="1260.57" y="-1052.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY_countermeasure1 -->
<g id="node85" class="node">
<title>4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY_countermeasure1</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="2035.57,-1026 1386.57,-1026 1386.57,-942 2035.57,-942 2035.57,-1026"/>
<text text-anchor="start" x="1397.07" y="-1011.4" font-family="Arial" font-weight="bold" font-size="12.00"> Validation of Client Properties by End User (5_2_4_3_VALIDATION_OF_CLIENT_BY_END_USER) </text>
<text text-anchor="start" x="1483.07" y="-987.4" font-family="Arial" font-size="12.00"> In the authorization process, the user is typically asked to approve a client’s</text>
<text text-anchor="start" x="1486.57" y="-975.4" font-family="Arial" font-size="12.00">request for authorization. This is an important security mechanism by itself</text>
<text text-anchor="start" x="1488.07" y="-963.4" font-family="Arial" font-size="12.00">because the end user can be involved in the validation of client properties,</text>
<text text-anchor="start" x="1475.57" y="-951.4" font-family="Arial" font-size="12.00">such as whether the client name known to the authorization server fits the[...] </text>
</g>
<!-- 4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY_countermeasure1&#45;&gt;4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY -->
<g id="edge86" class="edge">
<title>4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY_countermeasure1&#45;&gt;4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY</title>
<path fill="none" stroke="black" d="M1386.54,-997.52C1303.53,-1000.99 1216.71,-1004.62 1142.21,-1007.74"/>
<polygon fill="black" stroke="black" points="1141.63,-1004.26 1131.78,-1008.17 1141.92,-1011.25 1141.63,-1004.26"/>
<text text-anchor="middle" x="1260.57" y="-1006.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY_countermeasure1&#45;&gt;4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY -->
<g id="edge89" class="edge">
<title>4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY_countermeasure1&#45;&gt;4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY</title>
<path fill="none" stroke="black" d="M1386.4,-976.84C1332.17,-977.31 1276.5,-978.82 1224.07,-982 1183.61,-984.45 1140.05,-988.88 1099.62,-993.75"/>
<polygon fill="black" stroke="black" points="1099.19,-990.28 1089.69,-994.96 1100.04,-997.23 1099.19,-990.28"/>
<text text-anchor="middle" x="1260.57" y="-985.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY_countermeasure2 -->
<g id="node86" class="node">
<title>4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY_countermeasure2</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="2107.07,-924 1315.07,-924 1315.07,-828 2107.07,-828 2107.07,-924"/>
<text text-anchor="start" x="1325.07" y="-909.4" font-family="Arial" font-weight="bold" font-size="12.00"> Automatic Processing of Repeated Authorizations Requires Client Validation (5_2_4_1_REPEAT_VALIDATE_CLIENT) </text>
<text text-anchor="start" x="1476.07" y="-885.4" font-family="Arial" font-size="12.00"> Authorization servers should NOT automatically process repeat authorizations</text>
<text text-anchor="start" x="1487.57" y="-873.4" font-family="Arial" font-size="12.00">where the client is not authenticated through a client secret or some other</text>
<text text-anchor="start" x="1473.07" y="-861.4" font-family="Arial" font-size="12.00">authentication mechanism such as a signed authentication assertion certificate</text>
<text text-anchor="start" x="1502.07" y="-849.4" font-family="Arial" font-size="12.00">(Section 5.2.3.7) or validation of a pre&#45;registered redirect URI (Section</text>
<text text-anchor="start" x="1693.07" y="-837.4" font-family="Arial" font-size="12.00">5.[...] </text>
</g>
<!-- 4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY_countermeasure2&#45;&gt;4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY -->
<g id="edge90" class="edge">
<title>4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY_countermeasure2&#45;&gt;4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY</title>
<path fill="none" stroke="black" d="M1366.19,-924C1348.88,-926.93 1331.77,-929.93 1315.07,-933 1220.92,-950.31 1114.35,-974.69 1039.76,-992.55"/>
<polygon fill="black" stroke="black" points="1038.82,-989.18 1029.91,-994.92 1040.45,-995.99 1038.82,-989.18"/>
<text text-anchor="middle" x="1260.57" y="-952.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY_countermeasure3 -->
<g id="node87" class="node">
<title>4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY_countermeasure3</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="2093.57,-810 1328.57,-810 1328.57,-714 2093.57,-714 2093.57,-810"/>
<text text-anchor="start" x="1339.07" y="-795.4" font-family="Arial" font-weight="bold" font-size="12.00"> Automatic Processing of Repeated Authorizations Requires Client Validation (REQUIRE_USER_MANUAL_STEP) </text>
<text text-anchor="start" x="1484.07" y="-771.4" font-family="Arial" font-size="12.00"> If the authorization server automatically authenticates the end user, it may</text>
<text text-anchor="start" x="1491.07" y="-759.4" font-family="Arial" font-size="12.00">nevertheless require some user input in order to prevent screen scraping.</text>
<text text-anchor="start" x="1490.57" y="-747.4" font-family="Arial" font-size="12.00">Examples are CAPTCHAs (Completely Automated Public Turing tests to tell</text>
<text text-anchor="start" x="1459.07" y="-735.4" font-family="Arial" font-size="12.00">Computers and Humans Apart) or other multi&#45;factor authentication techniques such</text>
<text text-anchor="start" x="1688.07" y="-723.4" font-family="Arial" font-size="12.00">as r[...] </text>
</g>
<!-- 4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY_countermeasure3&#45;&gt;4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY -->
<g id="edge91" class="edge">
<title>4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY_countermeasure3&#45;&gt;4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY</title>
<path fill="none" stroke="black" d="M1344.48,-810.06C1334.52,-812.88 1324.7,-815.85 1315.07,-819 1186.18,-861.14 1048.84,-946.15 983.49,-989.41"/>
<polygon fill="black" stroke="black" points="981.51,-986.52 975.13,-994.98 985.39,-992.35 981.51,-986.52"/>
<text text-anchor="middle" x="1260.57" y="-855.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY_countermeasure4 -->
<g id="node88" class="node">
<title>4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY_countermeasure4</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1966.07,-696 1456.07,-696 1456.07,-600 1966.07,-600 1966.07,-696"/>
<text text-anchor="start" x="1530.07" y="-681.4" font-family="Arial" font-weight="bold" font-size="12.00"> Limit Token Scope (5_1_5_1_LIMITED_SCOPE_TOKEN) </text>
<text text-anchor="start" x="1466.07" y="-657.4" font-family="Arial" font-size="12.00"> The authorization server may decide to reduce or limit the scope associated with</text>
<text text-anchor="start" x="1494.57" y="-645.4" font-family="Arial" font-size="12.00">a token. The basis of this decision is out of scope; examples are: &lt;br/&gt;o</text>
<text text-anchor="start" x="1506.57" y="-633.4" font-family="Arial" font-size="12.00">a client&#45;specific policy, e.g., issue only less powerful tokens to public</text>
<text text-anchor="start" x="1516.07" y="-621.4" font-family="Arial" font-size="12.00">clients, &lt;br/&gt;o a service&#45;specific policy, e.g., it is a very sensitive</text>
<text text-anchor="start" x="1681.07" y="-609.4" font-family="Arial" font-size="12.00">servic[...] </text>
</g>
<!-- 4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY_countermeasure4&#45;&gt;4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY -->
<g id="edge92" class="edge">
<title>4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY_countermeasure4&#45;&gt;4_4_2_2_TOKEN_LEAK2_BROWSER_HISTORY</title>
<path fill="none" stroke="black" d="M1456.06,-663.45C1407.87,-672.23 1358.87,-685.4 1315.07,-705 1162.48,-773.29 1023.17,-923.42 968.76,-986.82"/>
<polygon fill="black" stroke="black" points="965.76,-984.94 961.95,-994.83 971.09,-989.48 965.76,-984.94"/>
<text text-anchor="middle" x="1260.57" y="-751.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_2_4_MANIPULATION_SCRIPTS -->
<g id="node89" class="node">
<title>4_4_2_4_MANIPULATION_SCRIPTS</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1194.57,-517.5 692.57,-517.5 692.57,-436.5 1194.57,-436.5 1194.57,-517.5"/>
<text text-anchor="start" x="801.57" y="-502.4" font-family="Arial" font-weight="bold" font-size="12.00">4_4_2_4_MANIPULATION_SCRIPTS ATTACK</text>
<text text-anchor="start" x="1081.57" y="-502.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="718.07" y="-484.4" font-family="Arial" font-size="12.00">A hostile party could act as the client web server and replace or modify the</text>
<text text-anchor="start" x="711.07" y="-471.4" font-family="Arial" font-size="12.00">actual implementation of the client (script). This could be achieved using DNS</text>
<text text-anchor="start" x="702.57" y="-458.4" font-family="Arial" font-size="12.00">or ARP spoofing. This applies to clients implemented within the web browser in a</text>
<text text-anchor="start" x="886.07" y="-445.4" font-family="Arial" font-size="12.00">scripting language.</text>
</g>
<!-- 4_4_2_4_MANIPULATION_SCRIPTS&#45;&gt;CONFIDENTIALITY -->
<g id="edge97" class="edge">
<title>4_4_2_4_MANIPULATION_SCRIPTS&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M913.74,-517.7C856.67,-600.89 730.55,-798.44 681.07,-986 656.34,-1079.76 675.41,-1325.82 663.07,-1422 575.86,-2101.69 353.33,-2911.7 303.18,-3089.42"/>
<polygon fill="black" stroke="black" points="299.74,-3088.71 300.39,-3099.28 306.48,-3090.61 299.74,-3088.71"/>
<text text-anchor="middle" x="632.57" y="-1802.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_4_2_4_MANIPULATION_SCRIPTS_countermeasure0 -->
<g id="node90" class="node">
<title>4_4_2_4_MANIPULATION_SCRIPTS_countermeasure0</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="1973.57,-582 1448.57,-582 1448.57,-486 1973.57,-486 1973.57,-582"/>
<text text-anchor="start" x="1459.07" y="-567.4" font-family="Arial" font-weight="bold" font-size="12.00"> TLS for the authorization server (5_1_2_AUTH_SERVER_AUTHENTICATION) </text>
<text text-anchor="start" x="1478.57" y="-543.4" font-family="Arial" font-size="12.00"> Authorization servers should consider such attacks when developing services</text>
<text text-anchor="start" x="1477.07" y="-531.4" font-family="Arial" font-size="12.00">based on OAuth and should require the use of transport&#45; layer security for any</text>
<text text-anchor="start" x="1494.57" y="-519.4" font-family="Arial" font-size="12.00">requests where the authenticity of the authorization server or of request</text>
<text text-anchor="start" x="1493.57" y="-507.4" font-family="Arial" font-size="12.00">responses is an issue (see Section 5.1.2). HTTPS server authentication or</text>
<text text-anchor="start" x="1687.07" y="-495.4" font-family="Arial" font-size="12.00">simi[...] </text>
</g>
<!-- 4_4_2_4_MANIPULATION_SCRIPTS_countermeasure0&#45;&gt;4_4_2_4_MANIPULATION_SCRIPTS -->
<g id="edge94" class="edge">
<title>4_4_2_4_MANIPULATION_SCRIPTS_countermeasure0&#45;&gt;4_4_2_4_MANIPULATION_SCRIPTS</title>
<path fill="none" stroke="black" d="M1448.5,-514.52C1369.81,-508.66 1283.49,-502.24 1204.87,-496.38"/>
<polygon fill="black" stroke="black" points="1205.06,-492.89 1194.83,-495.63 1204.54,-499.87 1205.06,-492.89"/>
<text text-anchor="middle" x="1260.57" y="-505.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_2_4_MANIPULATION_SCRIPTS_countermeasure1 -->
<g id="node91" class="node">
<title>4_4_2_4_MANIPULATION_SCRIPTS_countermeasure1</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="1980.57,-468 1441.57,-468 1441.57,-372 1980.57,-372 1980.57,-468"/>
<text text-anchor="start" x="1452.07" y="-453.4" font-family="Arial" font-weight="bold" font-size="12.00"> Ensure Confidentiality of Requests (TLS) (5_1_1_CONFIDENTIAL_REQUESTS) </text>
<text text-anchor="start" x="1493.57" y="-429.4" font-family="Arial" font-size="12.00"> This is applicable to all requests sent from the client to the authorization</text>
<text text-anchor="start" x="1476.57" y="-417.4" font-family="Arial" font-size="12.00">server or resource server. While OAuth provides a mechanism for verifying the</text>
<text text-anchor="start" x="1497.07" y="-405.4" font-family="Arial" font-size="12.00">integrity of requests, it provides no guarantee of request confidentiality.</text>
<text text-anchor="start" x="1485.07" y="-393.4" font-family="Arial" font-size="12.00">Unless further precautions are taken, eavesdroppers will have full access to</text>
<text text-anchor="start" x="1699.07" y="-381.4" font-family="Arial" font-size="12.00">[...] </text>
</g>
<!-- 4_4_2_4_MANIPULATION_SCRIPTS_countermeasure1&#45;&gt;4_4_2_4_MANIPULATION_SCRIPTS -->
<g id="edge95" class="edge">
<title>4_4_2_4_MANIPULATION_SCRIPTS_countermeasure1&#45;&gt;4_4_2_4_MANIPULATION_SCRIPTS</title>
<path fill="none" stroke="black" d="M1441.53,-440C1364.72,-445.71 1281.16,-451.94 1204.86,-457.62"/>
<polygon fill="black" stroke="black" points="1204.34,-454.15 1194.63,-458.38 1204.86,-461.13 1204.34,-454.15"/>
<text text-anchor="middle" x="1260.57" y="-458.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_2_4_MANIPULATION_SCRIPTS_countermeasure2 -->
<g id="node92" class="node">
<title>4_4_2_4_MANIPULATION_SCRIPTS_countermeasure2</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1991.57,-354 1430.57,-354 1430.57,-270 1991.57,-270 1991.57,-354"/>
<text text-anchor="start" x="1441.07" y="-339.4" font-family="Arial" font-weight="bold" font-size="12.00"> One&#45;time, per&#45;use secrets (e.g., &quot;client_secret&quot;) (ONE_TIME_PER_USE_SECRET) </text>
<text text-anchor="start" x="1517.57" y="-315.4" font-family="Arial" font-size="12.00"> Introduce one&#45;time, per&#45;use secrets (e.g., &quot;client_secret&quot;) values</text>
<text text-anchor="start" x="1486.07" y="-303.4" font-family="Arial" font-size="12.00">that can only be used by scripts in a small time window once loaded from a</text>
<text text-anchor="start" x="1484.57" y="-291.4" font-family="Arial" font-size="12.00">server. The intention would be to reduce the effectiveness of copying client&#45;</text>
<text text-anchor="start" x="1550.07" y="-279.4" font-family="Arial" font-size="12.00">side scripts for re&#45;use in an attacker’s modified code. </text>
</g>
<!-- 4_4_2_4_MANIPULATION_SCRIPTS_countermeasure2&#45;&gt;4_4_2_4_MANIPULATION_SCRIPTS -->
<g id="edge96" class="edge">
<title>4_4_2_4_MANIPULATION_SCRIPTS_countermeasure2&#45;&gt;4_4_2_4_MANIPULATION_SCRIPTS</title>
<path fill="none" stroke="black" d="M1430.4,-342.09C1391.49,-348.03 1352.15,-354.96 1315.07,-363 1231.35,-381.15 1139.29,-409.43 1067.88,-433.28"/>
<polygon fill="black" stroke="black" points="1066.76,-429.97 1058.39,-436.47 1068.98,-436.61 1066.76,-429.97"/>
<text text-anchor="middle" x="1260.57" y="-386.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_2_5_CSRF_IMPLICIT -->
<g id="node93" class="node">
<title>4_4_2_5_CSRF_IMPLICIT</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1187.57,-244.5 699.57,-244.5 699.57,-163.5 1187.57,-163.5 1187.57,-244.5"/>
<text text-anchor="start" x="834.57" y="-229.4" font-family="Arial" font-weight="bold" font-size="12.00">4_4_2_5_CSRF_IMPLICIT ATTACK</text>
<text text-anchor="start" x="1048.57" y="-229.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="715.07" y="-211.4" font-family="Arial" font-size="12.00">CSRF attacks (see Section 4.4.1.8) also work against the redirect URI used in</text>
<text text-anchor="start" x="709.57" y="-198.4" font-family="Arial" font-size="12.00">the implicit grant flow. An attacker could acquire an access token to their own</text>
<text text-anchor="start" x="713.57" y="-185.4" font-family="Arial" font-size="12.00">protected resources. He could then construct a redirect URI and embed their</text>
<text text-anchor="start" x="722.57" y="-172.4" font-family="Arial" font-size="12.00">access token in that URI. If he can trick the user into following the redi[...]</text>
</g>
<!-- 4_4_2_5_CSRF_IMPLICIT&#45;&gt;CONFIDENTIALITY -->
<g id="edge100" class="edge">
<title>4_4_2_5_CSRF_IMPLICIT&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M871.04,-244.68C809.93,-283.5 725.13,-347.85 681.07,-428 411.47,-918.35 308.77,-2805.78 294.74,-3089.27"/>
<polygon fill="black" stroke="black" points="291.24,-3089.24 294.24,-3099.4 298.23,-3089.59 291.24,-3089.24"/>
<text text-anchor="middle" x="632.57" y="-587.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_4_2_5_CSRF_IMPLICIT_countermeasure0 -->
<g id="node94" class="node">
<title>4_4_2_5_CSRF_IMPLICIT_countermeasure0</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="2049.07,-252 1373.07,-252 1373.07,-156 2049.07,-156 2049.07,-252"/>
<text text-anchor="start" x="1383.07" y="-237.4" font-family="Arial" font-weight="bold" font-size="12.00"> Link the authorization request with the redirect URI (state param) (STATE_PARAM_VALIDATION) </text>
<text text-anchor="start" x="1497.57" y="-213.4" font-family="Arial" font-size="12.00"> The &quot;state&quot; parameter should be used to link the authorization request</text>
<text text-anchor="start" x="1488.07" y="-201.4" font-family="Arial" font-size="12.00">with the redirect URI used to deliver the access token. This will ensure that</text>
<text text-anchor="start" x="1497.57" y="-189.4" font-family="Arial" font-size="12.00">the client is not tricked into completing any redirect callback unless it is</text>
<text text-anchor="start" x="1530.57" y="-177.4" font-family="Arial" font-size="12.00">linked to an authorization request initiated by the client. The</text>
<text text-anchor="start" x="1642.57" y="-165.4" font-family="Arial" font-size="12.00">&quot;state&quot; parameter [...] </text>
</g>
<!-- 4_4_2_5_CSRF_IMPLICIT_countermeasure0&#45;&gt;4_4_2_5_CSRF_IMPLICIT -->
<g id="edge98" class="edge">
<title>4_4_2_5_CSRF_IMPLICIT_countermeasure0&#45;&gt;4_4_2_5_CSRF_IMPLICIT</title>
<path fill="none" stroke="black" d="M1372.92,-204C1314.1,-204 1253.82,-204 1197.75,-204"/>
<polygon fill="black" stroke="black" points="1197.7,-200.5 1187.7,-204 1197.7,-207.5 1197.7,-200.5"/>
<text text-anchor="middle" x="1260.57" y="-207.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_2_5_CSRF_IMPLICIT_countermeasure1 -->
<g id="node95" class="node">
<title>4_4_2_5_CSRF_IMPLICIT_countermeasure1</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1970.57,-138 1451.57,-138 1451.57,-90 1970.57,-90 1970.57,-138"/>
<text text-anchor="start" x="1462.07" y="-123.4" font-family="Arial" font-weight="bold" font-size="12.00"> Users can be educated to not follow untrusted URLs (USER_EDUCATION) </text>
<text text-anchor="start" x="1471.07" y="-99.4" font-family="Arial" font-size="12.00"> Client developers and end users can be educated to not follow untrusted URLs. </text>
</g>
<!-- 4_4_2_5_CSRF_IMPLICIT_countermeasure1&#45;&gt;4_4_2_5_CSRF_IMPLICIT -->
<g id="edge99" class="edge">
<title>4_4_2_5_CSRF_IMPLICIT_countermeasure1&#45;&gt;4_4_2_5_CSRF_IMPLICIT</title>
<path fill="none" stroke="black" d="M1451.39,-133.02C1405.91,-137.11 1359.06,-141.78 1315.07,-147 1277.09,-151.5 1237.02,-156.94 1197.82,-162.65"/>
<polygon fill="black" stroke="black" points="1197.27,-159.19 1187.88,-164.11 1198.28,-166.12 1197.27,-159.19"/>
<text text-anchor="middle" x="1260.57" y="-160.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_2_6_TOKEN_SUBSTITUTION -->
<g id="node96" class="node">
<title>4_4_2_6_TOKEN_SUBSTITUTION</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1184.07,-114 703.07,-114 703.07,-20 1184.07,-20 1184.07,-114"/>
<text text-anchor="start" x="809.57" y="-99.4" font-family="Arial" font-weight="bold" font-size="12.00">4_4_2_6_TOKEN_SUBSTITUTION ATTACK</text>
<text text-anchor="start" x="1074.57" y="-99.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="731.07" y="-81.4" font-family="Arial" font-size="12.00">An attacker could attempt to log into an application or web site using a</text>
<text text-anchor="start" x="721.07" y="-68.4" font-family="Arial" font-size="12.00">victim’s identity. Applications relying on identity data provided by an OAuth</text>
<text text-anchor="start" x="713.57" y="-55.4" font-family="Arial" font-size="12.00">protected service API to login users are vulnerable to this threat. This pattern</text>
<text text-anchor="start" x="742.57" y="-42.4" font-family="Arial" font-size="12.00">can be found in so&#45;called &quot;social login&quot; scenarios. As a prerequisite,</text>
<text text-anchor="start" x="919.07" y="-29.4" font-family="Arial" font-size="12.00">a res[...]</text>
</g>
<!-- 4_4_2_6_TOKEN_SUBSTITUTION&#45;&gt;CONFIDENTIALITY -->
<g id="edge102" class="edge">
<title>4_4_2_6_TOKEN_SUBSTITUTION&#45;&gt;CONFIDENTIALITY</title>
<path fill="none" stroke="black" d="M734.71,-114.02C714.73,-124.94 696.29,-138.41 681.07,-155 580.58,-264.54 628.3,-333.68 602.07,-480 412.35,-1538.31 312.3,-2856.6 295.56,-3089.15"/>
<polygon fill="black" stroke="black" points="292.05,-3089.17 294.83,-3099.4 299.03,-3089.67 292.05,-3089.17"/>
<text text-anchor="middle" x="632.57" y="-483.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_4_2_6_TOKEN_SUBSTITUTION_countermeasure0 -->
<g id="node97" class="node">
<title>4_4_2_6_TOKEN_SUBSTITUTION_countermeasure0</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1959.57,-72 1462.57,-72 1462.57,0 1959.57,0 1959.57,-72"/>
<text text-anchor="start" x="1495.57" y="-57.4" font-family="Arial" font-weight="bold" font-size="12.00"> Secure User Login Protocol (SECURE_USER_LOGIN_PROTOCOL) </text>
<text text-anchor="start" x="1481.57" y="-33.4" font-family="Arial" font-size="12.00"> Clients should use an appropriate protocol, such as OpenID (cf. [OPENID]) or</text>
<text text-anchor="start" x="1473.07" y="-21.4" font-family="Arial" font-size="12.00">SAML (cf. [OASIS.sstc&#45;saml&#45;bindings&#45;1.1]) to implement user login. Both support</text>
<text text-anchor="start" x="1615.07" y="-9.4" font-family="Arial" font-size="12.00">audience restrictions on clients. </text>
</g>
<!-- 4_4_2_6_TOKEN_SUBSTITUTION_countermeasure0&#45;&gt;4_4_2_6_TOKEN_SUBSTITUTION -->
<g id="edge101" class="edge">
<title>4_4_2_6_TOKEN_SUBSTITUTION_countermeasure0&#45;&gt;4_4_2_6_TOKEN_SUBSTITUTION</title>
<path fill="none" stroke="black" d="M1462.33,-46.03C1376.52,-49.51 1280.32,-53.4 1194.35,-56.88"/>
<polygon fill="black" stroke="black" points="1194.04,-53.39 1184.19,-57.3 1194.32,-60.39 1194.04,-53.39"/>
<text text-anchor="middle" x="1260.57" y="-59.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
</g>
</svg>
