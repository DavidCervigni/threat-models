<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="1882pt" height="452pt"
 viewBox="0.00 0.00 1881.53 452.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 448)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-448 1877.53,-448 1877.53,4 -4,4"/>
<!-- AVAILABILITY -->
<g id="node1" class="node">
<title>AVAILABILITY</title>
<ellipse fill="#bae9ff" stroke="#2bbcff" cx="255.27" cy="-234" rx="255.03" ry="25.41"/>
<text text-anchor="start" x="210.77" y="-237.4" font-family="Arial" font-weight="bold" font-size="12.00">AVAILABILITY</text>
<text text-anchor="start" x="85.27" y="-225.4" font-family="Arial" font-size="12.00">Ability to maintain fundamental availability of the system</text>
</g>
<!-- 4_4_1_11_DOS_TOKEN_ENTROPY -->
<g id="node2" class="node">
<title>4_4_1_11_DOS_TOKEN_ENTROPY</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1095.53,-383 607.53,-383 607.53,-289 1095.53,-289 1095.53,-383"/>
<text text-anchor="start" x="713.53" y="-368.4" font-family="Arial" font-weight="bold" font-size="12.00">4_4_1_11_DOS_TOKEN_ENTROPY ATTACK</text>
<text text-anchor="start" x="985.53" y="-368.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="649.03" y="-350.4" font-family="Arial" font-size="12.00">If an authorization server includes a nontrivial amount of entropy in</text>
<text text-anchor="start" x="664.03" y="-337.4" font-family="Arial" font-size="12.00">authorization &quot;codes&quot; or access tokens (limiting the number of</text>
<text text-anchor="start" x="648.53" y="-324.4" font-family="Arial" font-size="12.00">possible codes/tokens) and automatically grants either without user</text>
<text text-anchor="start" x="617.53" y="-311.4" font-family="Arial" font-size="12.00">intervention and has no limit on codes or access tokens per user, an &#160;attacker</text>
<text text-anchor="start" x="765.53" y="-298.4" font-family="Arial" font-size="12.00">could exhaust the pool of[...]</text>
</g>
<!-- 4_4_1_11_DOS_TOKEN_ENTROPY&#45;&gt;AVAILABILITY -->
<g id="edge3" class="edge">
<title>4_4_1_11_DOS_TOKEN_ENTROPY&#45;&gt;AVAILABILITY</title>
<path fill="none" stroke="black" d="M607.11,-294.22C534.69,-281.79 457.88,-268.6 394.64,-257.75"/>
<polygon fill="black" stroke="black" points="395.06,-254.27 384.61,-256.03 393.88,-261.17 395.06,-254.27"/>
<text text-anchor="middle" x="559.03" y="-294.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_4_1_11_DOS_TOKEN_ENTROPY_countermeasure0 -->
<g id="node3" class="node">
<title>4_4_1_11_DOS_TOKEN_ENTROPY_countermeasure0</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1794.03,-444 1284.03,-444 1284.03,-384 1794.03,-384 1794.03,-444"/>
<text text-anchor="start" x="1294.03" y="-429.4" font-family="Arial" font-weight="bold" font-size="12.00"> Limit access tokens granted per user (AUTH_SERVER_PER_USER_LIMIT) </text>
<text text-anchor="start" x="1302.03" y="-405.4" font-family="Arial" font-size="12.00"> The authorization server should consider limiting the number of access tokens</text>
<text text-anchor="start" x="1485.03" y="-393.4" font-family="Arial" font-size="12.00">granted per user. </text>
</g>
<!-- 4_4_1_11_DOS_TOKEN_ENTROPY_countermeasure0&#45;&gt;4_4_1_11_DOS_TOKEN_ENTROPY -->
<g id="edge1" class="edge">
<title>4_4_1_11_DOS_TOKEN_ENTROPY_countermeasure0&#45;&gt;4_4_1_11_DOS_TOKEN_ENTROPY</title>
<path fill="none" stroke="black" d="M1283.75,-385.07C1225.58,-378.45 1163.76,-371.41 1105.64,-364.8"/>
<polygon fill="black" stroke="black" points="1105.92,-361.31 1095.59,-363.66 1105.13,-368.26 1105.92,-361.31"/>
<text text-anchor="middle" x="1150.03" y="-376.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_11_DOS_TOKEN_ENTROPY_countermeasure1 -->
<g id="node4" class="node">
<title>4_4_1_11_DOS_TOKEN_ENTROPY_countermeasure1</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1769.53,-366 1308.53,-366 1308.53,-306 1769.53,-306 1769.53,-366"/>
<text text-anchor="start" x="1367.03" y="-351.4" font-family="Arial" font-weight="bold" font-size="12.00"> High entropy codes (AUTH_CODE_HIGH_ENTROPY) </text>
<text text-anchor="start" x="1319.03" y="-327.4" font-family="Arial" font-size="12.00"> The authorization server should include a nontrivial amount of entropy in</text>
<text text-anchor="start" x="1471.53" y="-315.4" font-family="Arial" font-size="12.00">authorization &quot;codes&quot;. </text>
</g>
<!-- 4_4_1_11_DOS_TOKEN_ENTROPY_countermeasure1&#45;&gt;4_4_1_11_DOS_TOKEN_ENTROPY -->
<g id="edge2" class="edge">
<title>4_4_1_11_DOS_TOKEN_ENTROPY_countermeasure1&#45;&gt;4_4_1_11_DOS_TOKEN_ENTROPY</title>
<path fill="none" stroke="black" d="M1308.34,-336C1243.3,-336 1172.14,-336 1105.79,-336"/>
<polygon fill="black" stroke="black" points="1105.61,-332.5 1095.61,-336 1105.61,-339.5 1105.61,-332.5"/>
<text text-anchor="middle" x="1150.03" y="-339.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_12_DOS2 -->
<g id="node5" class="node">
<title>4_4_1_12_DOS2</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1084.53,-225 618.53,-225 618.53,-131 1084.53,-131 1084.53,-225"/>
<text text-anchor="start" x="770.03" y="-210.4" font-family="Arial" font-weight="bold" font-size="12.00">4_4_1_12_DOS2 ATTACK</text>
<text text-anchor="start" x="929.03" y="-210.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="628.53" y="-192.4" font-family="Arial" font-size="12.00">An attacker who owns a botnet can locate the redirect URIs of clients &#160;that</text>
<text text-anchor="start" x="644.53" y="-179.4" font-family="Arial" font-size="12.00">listen on HTTP, access them with random authorization &quot;codes&quot;, &#160;and</text>
<text text-anchor="start" x="630.53" y="-166.4" font-family="Arial" font-size="12.00">cause a large number of HTTPS connections to be concentrated onto &#160;the</text>
<text text-anchor="start" x="630.53" y="-153.4" font-family="Arial" font-size="12.00">authorization server. This can result in a denial&#45;of&#45;service &#160;(DoS) attack on</text>
<text text-anchor="start" x="797.53" y="-140.4" font-family="Arial" font-size="12.00">the authorizati[...]</text>
</g>
<!-- 4_4_1_12_DOS2&#45;&gt;AVAILABILITY -->
<g id="edge7" class="edge">
<title>4_4_1_12_DOS2&#45;&gt;AVAILABILITY</title>
<path fill="none" stroke="black" d="M618.22,-199.89C563.17,-205.08 505,-210.56 451.78,-215.58"/>
<polygon fill="black" stroke="black" points="451.18,-212.12 441.55,-216.54 451.84,-219.09 451.18,-212.12"/>
<text text-anchor="middle" x="559.03" y="-210.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_4_1_12_DOS2_countermeasure0 -->
<g id="node6" class="node">
<title>4_4_1_12_DOS2_countermeasure0</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1873.53,-288 1204.53,-288 1204.53,-192 1873.53,-192 1873.53,-288"/>
<text text-anchor="start" x="1215.03" y="-273.4" font-family="Arial" font-weight="bold" font-size="12.00"> Link the state Parameter to User Agent Session (anti CSRF) (5_3_5_ANTI_CSRF_STATE_PARAM) </text>
<text text-anchor="start" x="1327.03" y="-249.4" font-family="Arial" font-size="12.00"> The &quot;state&quot; parameter is used to link client requests and prevent CSRF</text>
<text text-anchor="start" x="1305.03" y="-237.4" font-family="Arial" font-size="12.00">attacks, for example, attacks against the redirect URI. An attacker could inject</text>
<text text-anchor="start" x="1339.53" y="-225.4" font-family="Arial" font-size="12.00">their own authorization &quot;code&quot; or access token, which can result in</text>
<text text-anchor="start" x="1321.53" y="-213.4" font-family="Arial" font-size="12.00">the client using an access token associated with the attackerâ€™s protected</text>
<text text-anchor="start" x="1484.03" y="-201.4" font-family="Arial" font-size="12.00">resources rath[...] </text>
</g>
<!-- 4_4_1_12_DOS2_countermeasure0&#45;&gt;4_4_1_12_DOS2 -->
<g id="edge4" class="edge">
<title>4_4_1_12_DOS2_countermeasure0&#45;&gt;4_4_1_12_DOS2</title>
<path fill="none" stroke="black" d="M1204.32,-209.82C1167.59,-206.5 1130.73,-203.16 1095.42,-199.97"/>
<polygon fill="black" stroke="black" points="1095.28,-196.44 1085.01,-199.03 1094.65,-203.41 1095.28,-196.44"/>
<text text-anchor="middle" x="1150.03" y="-211.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_12_DOS2_countermeasure1 -->
<g id="node7" class="node">
<title>4_4_1_12_DOS2_countermeasure1</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1784.53,-174 1293.53,-174 1293.53,-90 1784.53,-90 1784.53,-174"/>
<text text-anchor="start" x="1308.03" y="-159.4" font-family="Arial" font-weight="bold" font-size="12.00"> Client limits authenticated users codes (CLIENT_LIMITS_PER_USER) </text>
<text text-anchor="start" x="1311.03" y="-135.4" font-family="Arial" font-size="12.00"> If the client authenticates the user, either through a single&#45; sign&#45;on protocol</text>
<text text-anchor="start" x="1304.03" y="-123.4" font-family="Arial" font-size="12.00">or through local authentication, the client should suspend the access by a user</text>
<text text-anchor="start" x="1336.53" y="-111.4" font-family="Arial" font-size="12.00">account if the number of invalid authorization &quot;codes&quot; submitted by</text>
<text text-anchor="start" x="1425.03" y="-99.4" font-family="Arial" font-size="12.00">this user exceeds a certain threshold. </text>
</g>
<!-- 4_4_1_12_DOS2_countermeasure1&#45;&gt;4_4_1_12_DOS2 -->
<g id="edge5" class="edge">
<title>4_4_1_12_DOS2_countermeasure1&#45;&gt;4_4_1_12_DOS2</title>
<path fill="none" stroke="black" d="M1293.45,-148.41C1228.94,-152.74 1159.37,-157.41 1094.97,-161.73"/>
<polygon fill="black" stroke="black" points="1094.42,-158.26 1084.68,-162.42 1094.89,-165.24 1094.42,-158.26"/>
<text text-anchor="middle" x="1150.03" y="-163.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_12_DOS2_countermeasure2 -->
<g id="node8" class="node">
<title>4_4_1_12_DOS2_countermeasure2</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1783.53,-72 1294.53,-72 1294.53,0 1783.53,0 1783.53,-72"/>
<text text-anchor="start" x="1335.03" y="-57.4" font-family="Arial" font-weight="bold" font-size="12.00"> Client limits authenticated users codes (AUTH_RATE_LIMIT) </text>
<text text-anchor="start" x="1305.03" y="-33.4" font-family="Arial" font-size="12.00"> The authorization server should send an error response to the client reporting</text>
<text text-anchor="start" x="1333.53" y="-21.4" font-family="Arial" font-size="12.00">an invalid authorization &quot;code&quot; and rate&#45;limit or disallow connections</text>
<text text-anchor="start" x="1335.53" y="-9.4" font-family="Arial" font-size="12.00">from clients whose number of invalid requests exceeds a threshold. </text>
</g>
<!-- 4_4_1_12_DOS2_countermeasure2&#45;&gt;4_4_1_12_DOS2 -->
<g id="edge6" class="edge">
<title>4_4_1_12_DOS2_countermeasure2&#45;&gt;4_4_1_12_DOS2</title>
<path fill="none" stroke="black" d="M1294.23,-65.02C1263.92,-69.77 1233.44,-75.09 1204.53,-81 1142.17,-93.74 1074.58,-111.41 1015.45,-128.18"/>
<polygon fill="black" stroke="black" points="1014.31,-124.86 1005.65,-130.97 1016.23,-131.6 1014.31,-124.86"/>
<text text-anchor="middle" x="1150.03" y="-104.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
</g>
</svg>
