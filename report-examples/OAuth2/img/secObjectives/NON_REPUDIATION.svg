<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="2053pt" height="1190pt"
 viewBox="0.00 0.00 2053.44 1190.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1186)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1186 2049.44,-1186 2049.44,4 -4,4"/>
<!-- NON_REPUDIATION -->
<g id="node1" class="node">
<title>NON_REPUDIATION</title>
<ellipse fill="#bae9ff" stroke="#2bbcff" cx="330.22" cy="-474" rx="330.44" ry="42.35"/>
<text text-anchor="start" x="266.72" y="-489.4" font-family="Arial" font-weight="bold" font-size="12.00">NON_REPUDIATION</text>
<text text-anchor="start" x="117.22" y="-477.4" font-family="Arial" font-size="12.00">Ability to have available evidence of the users and actor mains actions,</text>
<text text-anchor="start" x="107.22" y="-465.4" font-family="Arial" font-size="12.00">including: &#160;&#160;&#45; Trackign of CLIENT access to RESOURCE_OWNER&#39;s assets and</text>
<text text-anchor="start" x="316.72" y="-453.4" font-family="Arial" font-size="12.00">data</text>
</g>
<!-- 4_4_1_7_CLIENT_SPOOFING4 -->
<g id="node2" class="node">
<title>4_4_1_7_CLIENT_SPOOFING4</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1240.94,-953 783.94,-953 783.94,-859 1240.94,-859 1240.94,-953"/>
<text text-anchor="start" x="887.94" y="-938.4" font-family="Arial" font-weight="bold" font-size="12.00">4_4_1_7_CLIENT_SPOOFING4 ATTACK</text>
<text text-anchor="start" x="1133.94" y="-938.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="818.94" y="-920.4" font-family="Arial" font-size="12.00">The attacker leverages the authorization &quot;code&quot; grant type in an</text>
<text text-anchor="start" x="794.44" y="-907.4" font-family="Arial" font-size="12.00">attempt to get another user (victim) to log in, authorize access to his/her</text>
<text text-anchor="start" x="800.94" y="-894.4" font-family="Arial" font-size="12.00">resources, and subsequently obtain the authorization &quot;code&quot; and inject</text>
<text text-anchor="start" x="806.94" y="-881.4" font-family="Arial" font-size="12.00">it into a client application using the attackerâ€™s account. The goal is to</text>
<text text-anchor="start" x="933.44" y="-868.4" font-family="Arial" font-size="12.00">associate an access au[...]</text>
</g>
<!-- 4_4_1_7_CLIENT_SPOOFING4&#45;&gt;NON_REPUDIATION -->
<g id="edge5" class="edge">
<title>4_4_1_7_CLIENT_SPOOFING4&#45;&gt;NON_REPUDIATION</title>
<path fill="none" stroke="black" d="M937.35,-858.95C806.75,-776 537.02,-604.7 405.96,-521.47"/>
<polygon fill="black" stroke="black" points="407.46,-518.28 397.15,-515.87 403.71,-524.19 407.46,-518.28"/>
<text text-anchor="middle" x="708.94" y="-731.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_4_1_7_CLIENT_SPOOFING4_countermeasure0 -->
<g id="node3" class="node">
<title>4_4_1_7_CLIENT_SPOOFING4_countermeasure0</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="2009.44,-1182 1412.44,-1182 1412.44,-1086 2009.44,-1086 2009.44,-1182"/>
<text text-anchor="start" x="1422.94" y="-1167.4" font-family="Arial" font-weight="bold" font-size="12.00"> Binding of Authorization &quot;code&quot; to &quot;redirect_uri&quot; (5_2_4_5_REDIRECT_CODE_BINDING) </text>
<text text-anchor="start" x="1507.94" y="-1143.4" font-family="Arial" font-size="12.00"> The authorization server should be able to bind every authorization</text>
<text text-anchor="start" x="1513.94" y="-1131.4" font-family="Arial" font-size="12.00">&quot;code&quot; to the actual redirect URI used as the redirect target of the</text>
<text text-anchor="start" x="1482.44" y="-1119.4" font-family="Arial" font-size="12.00">client in the end&#45;user authorization process. This binding should be validated</text>
<text text-anchor="start" x="1511.94" y="-1107.4" font-family="Arial" font-size="12.00">when the client attempts to exchange the respective authorization</text>
<text text-anchor="start" x="1618.44" y="-1095.4" font-family="Arial" font-size="12.00">&quot;code&quot; for an access token[...] </text>
</g>
<!-- 4_4_1_7_CLIENT_SPOOFING4_countermeasure0&#45;&gt;4_4_1_7_CLIENT_SPOOFING4 -->
<g id="edge1" class="edge">
<title>4_4_1_7_CLIENT_SPOOFING4_countermeasure0&#45;&gt;4_4_1_7_CLIENT_SPOOFING4</title>
<path fill="none" stroke="black" d="M1412.11,-1087.33C1400,-1084.1 1388.06,-1080.66 1376.44,-1077 1280.53,-1046.83 1177.38,-996.33 1105.65,-958.01"/>
<polygon fill="black" stroke="black" points="1107.08,-954.81 1096.62,-953.16 1103.77,-960.97 1107.08,-954.81"/>
<text text-anchor="middle" x="1321.94" y="-1073.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_7_CLIENT_SPOOFING4_countermeasure1 -->
<g id="node4" class="node">
<title>4_4_1_7_CLIENT_SPOOFING4_countermeasure1</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="1989.44,-1068 1432.44,-1068 1432.44,-972 1989.44,-972 1989.44,-1068"/>
<text text-anchor="start" x="1442.94" y="-1053.4" font-family="Arial" font-weight="bold" font-size="12.00"> Issue Installation&#45;Specific Client Secrets (5_2_3_4_SPECIFIC_CLIENT_SECRETS) </text>
<text text-anchor="start" x="1471.94" y="-1029.4" font-family="Arial" font-size="12.00"> An authorization server may issue separate client identifiers and corresponding</text>
<text text-anchor="start" x="1501.44" y="-1017.4" font-family="Arial" font-size="12.00">secrets to the different installations of a particular client (i.e., software</text>
<text text-anchor="start" x="1502.44" y="-1005.4" font-family="Arial" font-size="12.00">package). &#160;The effect of such an approach would be to turn otherwise</text>
<text text-anchor="start" x="1547.44" y="-993.4" font-family="Arial" font-size="12.00">&quot;public&quot; clients back into &quot;confidential&quot; clients. For web</text>
<text text-anchor="start" x="1640.44" y="-981.4" font-family="Arial" font-size="12.00">applications, this co[...] </text>
</g>
<!-- 4_4_1_7_CLIENT_SPOOFING4_countermeasure1&#45;&gt;4_4_1_7_CLIENT_SPOOFING4 -->
<g id="edge2" class="edge">
<title>4_4_1_7_CLIENT_SPOOFING4_countermeasure1&#45;&gt;4_4_1_7_CLIENT_SPOOFING4</title>
<path fill="none" stroke="black" d="M1432.41,-974.58C1372.36,-964.75 1309.38,-954.44 1251.03,-944.89"/>
<polygon fill="black" stroke="black" points="1251.38,-941.4 1240.95,-943.24 1250.25,-948.31 1251.38,-941.4"/>
<text text-anchor="middle" x="1321.94" y="-962.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_7_CLIENT_SPOOFING4_countermeasure2 -->
<g id="node5" class="node">
<title>4_4_1_7_CLIENT_SPOOFING4_countermeasure2</title>
<polygon fill="#d5e8d4" stroke="#82b366" points="2001.44,-954 1420.44,-954 1420.44,-858 2001.44,-858 2001.44,-954"/>
<text text-anchor="start" x="1430.94" y="-939.4" font-family="Arial" font-weight="bold" font-size="12.00"> Binding of Authorization &quot;code&quot; to &quot;client_id&quot; (5_2_4_4_CLIENT_TO_CODE_BINDING) </text>
<text text-anchor="start" x="1498.44" y="-915.4" font-family="Arial" font-size="12.00"> The authorization server should bind every authorization &quot;code&quot; to the</text>
<text text-anchor="start" x="1487.94" y="-903.4" font-family="Arial" font-size="12.00">id of the respective client that initiated the end&#45;user authorization process.</text>
<text text-anchor="start" x="1487.94" y="-891.4" font-family="Arial" font-size="12.00">This measure is a countermeasure against: &lt;br/&gt;o Replay of authorization</text>
<text text-anchor="start" x="1516.44" y="-879.4" font-family="Arial" font-size="12.00">&quot;codes&quot; with different client credentials, since an attacker cannot</text>
<text text-anchor="start" x="1648.44" y="-867.4" font-family="Arial" font-size="12.00">use another &quot;clie[...] </text>
</g>
<!-- 4_4_1_7_CLIENT_SPOOFING4_countermeasure2&#45;&gt;4_4_1_7_CLIENT_SPOOFING4 -->
<g id="edge3" class="edge">
<title>4_4_1_7_CLIENT_SPOOFING4_countermeasure2&#45;&gt;4_4_1_7_CLIENT_SPOOFING4</title>
<path fill="none" stroke="black" d="M1420.36,-906C1363.99,-906 1305.51,-906 1251.06,-906"/>
<polygon fill="black" stroke="black" points="1250.94,-902.5 1240.94,-906 1250.94,-909.5 1250.94,-902.5"/>
<text text-anchor="middle" x="1321.94" y="-909.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_7_CLIENT_SPOOFING4_countermeasure3 -->
<g id="node6" class="node">
<title>4_4_1_7_CLIENT_SPOOFING4_countermeasure3</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1956.44,-840 1465.44,-840 1465.44,-768 1956.44,-768 1956.44,-840"/>
<text text-anchor="start" x="1558.94" y="-825.4" font-family="Arial" font-weight="bold" font-size="12.00"> Implicit grant flow (IMPLICIT_GRANT_FLOW) </text>
<text text-anchor="start" x="1479.94" y="-801.4" font-family="Arial" font-size="12.00"> The client may consider using other flows that are not vulnerable to this kind</text>
<text text-anchor="start" x="1475.94" y="-789.4" font-family="Arial" font-size="12.00">of attack, such as the implicit grant type (see Section 4.4.2) or resource owner</text>
<text text-anchor="start" x="1586.94" y="-777.4" font-family="Arial" font-size="12.00">password credentials (see Section 4.4.3). </text>
</g>
<!-- 4_4_1_7_CLIENT_SPOOFING4_countermeasure3&#45;&gt;4_4_1_7_CLIENT_SPOOFING4 -->
<g id="edge4" class="edge">
<title>4_4_1_7_CLIENT_SPOOFING4_countermeasure3&#45;&gt;4_4_1_7_CLIENT_SPOOFING4</title>
<path fill="none" stroke="black" d="M1465.33,-836.39C1435.38,-840.54 1405.2,-844.8 1376.44,-849 1335.97,-854.91 1293,-861.43 1251.33,-867.89"/>
<polygon fill="black" stroke="black" points="1250.68,-864.45 1241.33,-869.44 1251.75,-871.37 1250.68,-864.45"/>
<text text-anchor="middle" x="1321.94" y="-865.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_8_CSRF_ON_REDIRECT -->
<g id="node7" class="node">
<title>4_4_1_8_CSRF_ON_REDIRECT</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1267.44,-652.5 757.44,-652.5 757.44,-571.5 1267.44,-571.5 1267.44,-652.5"/>
<text text-anchor="start" x="886.94" y="-637.4" font-family="Arial" font-weight="bold" font-size="12.00">4_4_1_8_CSRF_ON_REDIRECT ATTACK</text>
<text text-anchor="start" x="1133.94" y="-637.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="774.44" y="-619.4" font-family="Arial" font-size="12.00">Cross&#45;site request forgery (CSRF) is a web&#45;based attack whereby HTTP requests</text>
<text text-anchor="start" x="776.44" y="-606.4" font-family="Arial" font-size="12.00">are transmitted from a user that the web site trusts or has authenticated (e.g.,</text>
<text text-anchor="start" x="767.44" y="-593.4" font-family="Arial" font-size="12.00">via HTTP redirects or HTML forms). CSRF attacks on OAuth approvals can allow an</text>
<text text-anchor="start" x="793.44" y="-580.4" font-family="Arial" font-size="12.00">attacker to obtain authorization to OAuth protected resources without[...]</text>
</g>
<!-- 4_4_1_8_CSRF_ON_REDIRECT&#45;&gt;NON_REPUDIATION -->
<g id="edge8" class="edge">
<title>4_4_1_8_CSRF_ON_REDIRECT&#45;&gt;NON_REPUDIATION</title>
<path fill="none" stroke="black" d="M811.49,-571.43C718.55,-552.58 608.69,-530.29 517.52,-511.8"/>
<polygon fill="black" stroke="black" points="518.12,-508.35 507.62,-509.79 516.73,-515.21 518.12,-508.35"/>
<text text-anchor="middle" x="708.94" y="-558.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_4_1_8_CSRF_ON_REDIRECT_countermeasure0 -->
<g id="node8" class="node">
<title>4_4_1_8_CSRF_ON_REDIRECT_countermeasure0</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="2045.44,-750 1376.44,-750 1376.44,-654 2045.44,-654 2045.44,-750"/>
<text text-anchor="start" x="1386.94" y="-735.4" font-family="Arial" font-weight="bold" font-size="12.00"> Link the state Parameter to User Agent Session (anti CSRF) (5_3_5_ANTI_CSRF_STATE_PARAM) </text>
<text text-anchor="start" x="1498.94" y="-711.4" font-family="Arial" font-size="12.00"> The &quot;state&quot; parameter is used to link client requests and prevent CSRF</text>
<text text-anchor="start" x="1476.94" y="-699.4" font-family="Arial" font-size="12.00">attacks, for example, attacks against the redirect URI. An attacker could inject</text>
<text text-anchor="start" x="1511.44" y="-687.4" font-family="Arial" font-size="12.00">their own authorization &quot;code&quot; or access token, which can result in</text>
<text text-anchor="start" x="1493.44" y="-675.4" font-family="Arial" font-size="12.00">the client using an access token associated with the attackerâ€™s protected</text>
<text text-anchor="start" x="1655.94" y="-663.4" font-family="Arial" font-size="12.00">resources rath[...] </text>
</g>
<!-- 4_4_1_8_CSRF_ON_REDIRECT_countermeasure0&#45;&gt;4_4_1_8_CSRF_ON_REDIRECT -->
<g id="edge6" class="edge">
<title>4_4_1_8_CSRF_ON_REDIRECT_countermeasure0&#45;&gt;4_4_1_8_CSRF_ON_REDIRECT</title>
<path fill="none" stroke="black" d="M1376.22,-658.88C1343.14,-654.6 1309.89,-650.31 1277.66,-646.14"/>
<polygon fill="black" stroke="black" points="1278.06,-642.66 1267.69,-644.85 1277.16,-649.61 1278.06,-642.66"/>
<text text-anchor="middle" x="1321.94" y="-657.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_8_CSRF_ON_REDIRECT_countermeasure1 -->
<g id="node9" class="node">
<title>4_4_1_8_CSRF_ON_REDIRECT_countermeasure1</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1970.44,-636 1451.44,-636 1451.44,-588 1970.44,-588 1970.44,-636"/>
<text text-anchor="start" x="1461.94" y="-621.4" font-family="Arial" font-weight="bold" font-size="12.00"> Users can be educated to not follow untrusted URLs (USER_EDUCATION) </text>
<text text-anchor="start" x="1470.94" y="-597.4" font-family="Arial" font-size="12.00"> Client developers and end users can be educated to not follow untrusted URLs. </text>
</g>
<!-- 4_4_1_8_CSRF_ON_REDIRECT_countermeasure1&#45;&gt;4_4_1_8_CSRF_ON_REDIRECT -->
<g id="edge7" class="edge">
<title>4_4_1_8_CSRF_ON_REDIRECT_countermeasure1&#45;&gt;4_4_1_8_CSRF_ON_REDIRECT</title>
<path fill="none" stroke="black" d="M1451.08,-612C1394.5,-612 1334.54,-612 1277.75,-612"/>
<polygon fill="black" stroke="black" points="1277.56,-608.5 1267.56,-612 1277.56,-615.5 1277.56,-608.5"/>
<text text-anchor="middle" x="1321.94" y="-615.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_9_CLICKJACKING -->
<g id="node10" class="node">
<title>4_4_1_9_CLICKJACKING</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1244.94,-521 779.94,-521 779.94,-427 1244.94,-427 1244.94,-521"/>
<text text-anchor="start" x="906.94" y="-506.4" font-family="Arial" font-weight="bold" font-size="12.00">4_4_1_9_CLICKJACKING ATTACK</text>
<text text-anchor="start" x="1114.94" y="-506.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="802.44" y="-488.4" font-family="Arial" font-size="12.00">With clickjacking, a malicious site loads the target site in a transparent</text>
<text text-anchor="start" x="794.44" y="-475.4" font-family="Arial" font-size="12.00">iFrame (see [iFrame]) overlaid on top of a set of dummy buttons that are</text>
<text text-anchor="start" x="790.44" y="-462.4" font-family="Arial" font-size="12.00">carefully constructed to be placed directly under important buttons on the</text>
<text text-anchor="start" x="791.94" y="-449.4" font-family="Arial" font-size="12.00">target site. When a user clicks a visible button, they are actually clicking a</text>
<text text-anchor="start" x="982.94" y="-436.4" font-family="Arial" font-size="12.00">button[...]</text>
</g>
<!-- 4_4_1_9_CLICKJACKING&#45;&gt;NON_REPUDIATION -->
<g id="edge11" class="edge">
<title>4_4_1_9_CLICKJACKING&#45;&gt;NON_REPUDIATION</title>
<path fill="none" stroke="black" d="M779.72,-474C744.62,-474 707.79,-474 670.97,-474"/>
<polygon fill="black" stroke="black" points="670.59,-470.5 660.59,-474 670.59,-477.5 670.59,-470.5"/>
<text text-anchor="middle" x="708.94" y="-477.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_4_1_9_CLICKJACKING_countermeasure0 -->
<g id="node11" class="node">
<title>4_4_1_9_CLICKJACKING_countermeasure0</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="2025.94,-570 1395.94,-570 1395.94,-474 2025.94,-474 2025.94,-570"/>
<text text-anchor="start" x="1405.94" y="-555.4" font-family="Arial" font-weight="bold" font-size="12.00"> Link the state Parameter to User Agent Session (anti CSRF) (5_2_2_6_X_FRAME_OPTION) </text>
<text text-anchor="start" x="1462.44" y="-531.4" font-family="Arial" font-size="12.00"> For newer browsers, avoidance of iFrames can be enforced on the &#160;&#160;server side by</text>
<text text-anchor="start" x="1456.94" y="-519.4" font-family="Arial" font-size="12.00">using the X&#45;FRAME&#45;OPTIONS header (see &#160;&#160;[X&#45;Frame&#45;Options]). This header can have</text>
<text text-anchor="start" x="1527.94" y="-507.4" font-family="Arial" font-size="12.00">two values, &quot;DENY&quot; and &#160;&#160;&quot;SAMEORIGIN&quot;, which will block any</text>
<text text-anchor="start" x="1492.94" y="-495.4" font-family="Arial" font-size="12.00">framing or any framing by sites &#160;&#160;with a different origin, respectively. The</text>
<text text-anchor="start" x="1670.44" y="-483.4" font-family="Arial" font-size="12.00">value &quot;AL[...] </text>
</g>
<!-- 4_4_1_9_CLICKJACKING_countermeasure0&#45;&gt;4_4_1_9_CLICKJACKING -->
<g id="edge9" class="edge">
<title>4_4_1_9_CLICKJACKING_countermeasure0&#45;&gt;4_4_1_9_CLICKJACKING</title>
<path fill="none" stroke="black" d="M1395.82,-500.35C1348.69,-497.1 1300.72,-493.8 1255.41,-490.68"/>
<polygon fill="black" stroke="black" points="1255.39,-487.17 1245.18,-489.97 1254.91,-494.15 1255.39,-487.17"/>
<text text-anchor="middle" x="1321.94" y="-499.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_9_CLICKJACKING_countermeasure1 -->
<g id="node12" class="node">
<title>4_4_1_9_CLICKJACKING_countermeasure1</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1968.44,-456 1453.44,-456 1453.44,-396 1968.44,-396 1968.44,-456"/>
<text text-anchor="start" x="1561.44" y="-441.4" font-family="Arial" font-weight="bold" font-size="12.00"> JavaScript frame&#45;busting (FRAMEBUSTING) </text>
<text text-anchor="start" x="1463.94" y="-417.4" font-family="Arial" font-size="12.00"> For older browsers, JavaScript frame&#45;busting (see [Framebusting]) techniques can</text>
<text text-anchor="start" x="1563.94" y="-405.4" font-family="Arial" font-size="12.00">be used but may not be effective in all browsers. </text>
</g>
<!-- 4_4_1_9_CLICKJACKING_countermeasure1&#45;&gt;4_4_1_9_CLICKJACKING -->
<g id="edge10" class="edge">
<title>4_4_1_9_CLICKJACKING_countermeasure1&#45;&gt;4_4_1_9_CLICKJACKING</title>
<path fill="none" stroke="black" d="M1453.06,-443.7C1388.38,-448.16 1319.18,-452.93 1255.27,-457.33"/>
<polygon fill="black" stroke="black" points="1254.79,-453.86 1245.06,-458.04 1255.27,-460.84 1254.79,-453.86"/>
<text text-anchor="middle" x="1321.94" y="-457.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_10_RESOURCE_OWNER_SPOOFING1 -->
<g id="node13" class="node">
<title>4_4_1_10_RESOURCE_OWNER_SPOOFING1</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1259.94,-376.5 764.94,-376.5 764.94,-295.5 1259.94,-295.5 1259.94,-376.5"/>
<text text-anchor="start" x="842.44" y="-361.4" font-family="Arial" font-weight="bold" font-size="12.00">4_4_1_10_RESOURCE_OWNER_SPOOFING1 ATTACK</text>
<text text-anchor="start" x="1179.44" y="-361.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="783.94" y="-343.4" font-family="Arial" font-size="12.00">When a client requests access to protected resources, the authorization flow</text>
<text text-anchor="start" x="776.44" y="-330.4" font-family="Arial" font-size="12.00">normally involves the resource ownerâ€™s explicit response to the access request,</text>
<text text-anchor="start" x="775.44" y="-317.4" font-family="Arial" font-size="12.00">either granting or denying access to the protected resources. A malicious client</text>
<text text-anchor="start" x="799.44" y="-304.4" font-family="Arial" font-size="12.00">can exploit knowledge of the structure of this flow in order to gain a[...]</text>
</g>
<!-- 4_4_1_10_RESOURCE_OWNER_SPOOFING1&#45;&gt;NON_REPUDIATION -->
<g id="edge14" class="edge">
<title>4_4_1_10_RESOURCE_OWNER_SPOOFING1&#45;&gt;NON_REPUDIATION</title>
<path fill="none" stroke="black" d="M811.49,-376.57C718.55,-395.42 608.69,-417.71 517.52,-436.2"/>
<polygon fill="black" stroke="black" points="516.73,-432.79 507.62,-438.21 518.12,-439.65 516.73,-432.79"/>
<text text-anchor="middle" x="708.94" y="-403.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_4_1_10_RESOURCE_OWNER_SPOOFING1_countermeasure0 -->
<g id="node14" class="node">
<title>4_4_1_10_RESOURCE_OWNER_SPOOFING1_countermeasure0</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1961.44,-378 1460.44,-378 1460.44,-294 1961.44,-294 1961.44,-378"/>
<text text-anchor="start" x="1475.44" y="-363.4" font-family="Arial" font-weight="bold" font-size="12.00"> Interactive (non automatic) user approval (INTERACTIVE_APPROVAL) </text>
<text text-anchor="start" x="1470.94" y="-339.4" font-family="Arial" font-size="12.00"> Authorization servers should decide, based on an analysis of the risk associated</text>
<text text-anchor="start" x="1478.94" y="-327.4" font-family="Arial" font-size="12.00">with this threat, whether to detect and prevent this threat. In order to prevent</text>
<text text-anchor="start" x="1475.44" y="-315.4" font-family="Arial" font-size="12.00">such an attack, the authorization server may force a user interaction based on</text>
<text text-anchor="start" x="1499.94" y="-303.4" font-family="Arial" font-size="12.00">non&#45;predictable input values as part of the user consent approval. [...] </text>
</g>
<!-- 4_4_1_10_RESOURCE_OWNER_SPOOFING1_countermeasure0&#45;&gt;4_4_1_10_RESOURCE_OWNER_SPOOFING1 -->
<g id="edge12" class="edge">
<title>4_4_1_10_RESOURCE_OWNER_SPOOFING1_countermeasure0&#45;&gt;4_4_1_10_RESOURCE_OWNER_SPOOFING1</title>
<path fill="none" stroke="black" d="M1459.96,-336C1398.33,-336 1332.23,-336 1270.28,-336"/>
<polygon fill="black" stroke="black" points="1269.97,-332.5 1259.97,-336 1269.97,-339.5 1269.97,-332.5"/>
<text text-anchor="middle" x="1321.94" y="-339.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_10_RESOURCE_OWNER_SPOOFING1_countermeasure1 -->
<g id="node15" class="node">
<title>4_4_1_10_RESOURCE_OWNER_SPOOFING1_countermeasure1</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1962.44,-276 1459.44,-276 1459.44,-204 1962.44,-204 1962.44,-276"/>
<text text-anchor="start" x="1560.44" y="-261.4" font-family="Arial" font-weight="bold" font-size="12.00"> Notify User&#39;s approval (NOTIFY_APPROVAL) </text>
<text text-anchor="start" x="1475.94" y="-237.4" font-family="Arial" font-size="12.00"> In order to allow the resource owner to detect abuse, the authorization server</text>
<text text-anchor="start" x="1469.94" y="-225.4" font-family="Arial" font-size="12.00">could notify the resource owner of any approval by appropriate means, e.g., text</text>
<text text-anchor="start" x="1621.44" y="-213.4" font-family="Arial" font-size="12.00">or instant message, or email. </text>
</g>
<!-- 4_4_1_10_RESOURCE_OWNER_SPOOFING1_countermeasure1&#45;&gt;4_4_1_10_RESOURCE_OWNER_SPOOFING1 -->
<g id="edge13" class="edge">
<title>4_4_1_10_RESOURCE_OWNER_SPOOFING1_countermeasure1&#45;&gt;4_4_1_10_RESOURCE_OWNER_SPOOFING1</title>
<path fill="none" stroke="black" d="M1459.07,-273.7C1431.19,-277.49 1403.21,-281.31 1376.44,-285 1342.15,-289.72 1306.05,-294.74 1270.45,-299.71"/>
<polygon fill="black" stroke="black" points="1269.84,-296.26 1260.42,-301.12 1270.81,-303.2 1269.84,-296.26"/>
<text text-anchor="middle" x="1321.94" y="-300.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_13_CODE_SUBSTITUTION -->
<g id="node16" class="node">
<title>4_4_1_13_CODE_SUBSTITUTION</title>
<polygon fill="#f8cecc" stroke="#b85450" points="1247.44,-185 777.44,-185 777.44,-91 1247.44,-91 1247.44,-185"/>
<text text-anchor="start" x="877.94" y="-170.4" font-family="Arial" font-weight="bold" font-size="12.00">4_4_1_13_CODE_SUBSTITUTION ATTACK</text>
<text text-anchor="start" x="1142.94" y="-170.4" font-family="Arial" font-size="12.00"> </text>
<text text-anchor="start" x="797.44" y="-152.4" font-family="Arial" font-size="12.00">An attacker could attempt to log into an application or web site &#160;using a</text>
<text text-anchor="start" x="787.44" y="-139.4" font-family="Arial" font-size="12.00">victimâ€™s identity. Applications relying on identity data &#160;provided by an OAuth</text>
<text text-anchor="start" x="803.44" y="-126.4" font-family="Arial" font-size="12.00">protected service API to login users are &#160;vulnerable to this threat. This</text>
<text text-anchor="start" x="822.94" y="-113.4" font-family="Arial" font-size="12.00">pattern can be found in so&#45;called &#160;&quot;social login&quot; scenarios. &#160;As a</text>
<text text-anchor="start" x="962.94" y="-100.4" font-family="Arial" font-size="12.00">prerequisite, [...]</text>
</g>
<!-- 4_4_1_13_CODE_SUBSTITUTION&#45;&gt;NON_REPUDIATION -->
<g id="edge17" class="edge">
<title>4_4_1_13_CODE_SUBSTITUTION&#45;&gt;NON_REPUDIATION</title>
<path fill="none" stroke="black" d="M916.14,-185.07C785.54,-249.58 552.5,-364.7 423.5,-428.42"/>
<polygon fill="black" stroke="black" points="421.81,-425.35 414.4,-432.91 424.91,-431.62 421.81,-425.35"/>
<text text-anchor="middle" x="708.94" y="-298.8" font-family="Times,serif" font-size="14.00"> impacts</text>
</g>
<!-- 4_4_1_13_CODE_SUBSTITUTION_countermeasure0 -->
<g id="node17" class="node">
<title>4_4_1_13_CODE_SUBSTITUTION_countermeasure0</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1943.44,-186 1478.44,-186 1478.44,-90 1943.44,-90 1943.44,-186"/>
<text text-anchor="start" x="1500.94" y="-171.4" font-family="Arial" font-weight="bold" font-size="12.00"> Clients indicate their ids in requests (IN_REQUEST_CLIENTID) </text>
<text text-anchor="start" x="1488.94" y="-147.4" font-family="Arial" font-size="12.00"> All clients must indicate their client ids with every request to exchange an</text>
<text text-anchor="start" x="1511.94" y="-135.4" font-family="Arial" font-size="12.00">authorization &quot;code&quot; for an access token. The authorization server</text>
<text text-anchor="start" x="1509.44" y="-123.4" font-family="Arial" font-size="12.00">must validate whether the particular authorization &quot;code&quot; has been</text>
<text text-anchor="start" x="1490.44" y="-111.4" font-family="Arial" font-size="12.00">issued to the particular client. If possible, the client shall be authenticated</text>
<text text-anchor="start" x="1672.94" y="-99.4" font-family="Arial" font-size="12.00">beforehand. </text>
</g>
<!-- 4_4_1_13_CODE_SUBSTITUTION_countermeasure0&#45;&gt;4_4_1_13_CODE_SUBSTITUTION -->
<g id="edge15" class="edge">
<title>4_4_1_13_CODE_SUBSTITUTION_countermeasure0&#45;&gt;4_4_1_13_CODE_SUBSTITUTION</title>
<path fill="none" stroke="black" d="M1478.01,-138C1407.24,-138 1329.23,-138 1257.67,-138"/>
<polygon fill="black" stroke="black" points="1257.62,-134.5 1247.62,-138 1257.62,-141.5 1257.62,-134.5"/>
<text text-anchor="middle" x="1321.94" y="-141.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
<!-- 4_4_1_13_CODE_SUBSTITUTION_countermeasure1 -->
<g id="node18" class="node">
<title>4_4_1_13_CODE_SUBSTITUTION_countermeasure1</title>
<polygon fill="#fff2cc" stroke="#d6b656" points="1959.44,-72 1462.44,-72 1462.44,0 1959.44,0 1959.44,-72"/>
<text text-anchor="start" x="1495.44" y="-57.4" font-family="Arial" font-weight="bold" font-size="12.00"> Secure User Login Protocol (SECURE_USER_LOGIN_PROTOCOL) </text>
<text text-anchor="start" x="1481.44" y="-33.4" font-family="Arial" font-size="12.00"> Clients should use an appropriate protocol, such as OpenID (cf. [OPENID]) or</text>
<text text-anchor="start" x="1472.94" y="-21.4" font-family="Arial" font-size="12.00">SAML (cf. [OASIS.sstc&#45;saml&#45;bindings&#45;1.1]) to implement user login. Both support</text>
<text text-anchor="start" x="1614.94" y="-9.4" font-family="Arial" font-size="12.00">audience restrictions on clients. </text>
</g>
<!-- 4_4_1_13_CODE_SUBSTITUTION_countermeasure1&#45;&gt;4_4_1_13_CODE_SUBSTITUTION -->
<g id="edge16" class="edge">
<title>4_4_1_13_CODE_SUBSTITUTION_countermeasure1&#45;&gt;4_4_1_13_CODE_SUBSTITUTION</title>
<path fill="none" stroke="black" d="M1462.17,-68.83C1433.26,-72.84 1404.19,-76.95 1376.44,-81 1338.03,-86.61 1297.38,-92.77 1257.71,-98.9"/>
<polygon fill="black" stroke="black" points="1256.99,-95.47 1247.65,-100.46 1258.07,-102.39 1256.99,-95.47"/>
<text text-anchor="middle" x="1321.94" y="-97.8" font-family="Times,serif" font-size="14.00"> mitigates</text>
</g>
</g>
</svg>
